<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>CppNoddy: CppNoddy::ODE_BVP&lt; _Type, _Xtype &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-52977984-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">CppNoddy
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceCppNoddy.html">CppNoddy</a></li><li class="navelem"><a class="el" href="classCppNoddy_1_1ODE__BVP.html">ODE_BVP</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classCppNoddy_1_1ODE__BVP-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CppNoddy::ODE_BVP&lt; _Type, _Xtype &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A templated object for real/complex vector system of first-order ordinary differential equations.  
 <a href="classCppNoddy_1_1ODE__BVP.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for CppNoddy::ODE_BVP&lt; _Type, _Xtype &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classCppNoddy_1_1ODE__BVP.png" usemap="#CppNoddy::ODE_5FBVP_3C_20_5FType_2C_20_5FXtype_20_3E_map" alt=""/>
  <map id="CppNoddy::ODE_5FBVP_3C_20_5FType_2C_20_5FXtype_20_3E_map" name="CppNoddy::ODE_5FBVP_3C_20_5FType_2C_20_5FXtype_20_3E_map">
<area href="classCppNoddy_1_1ArcLength__base.html" alt="CppNoddy::ArcLength_base&lt; _Type &gt;" shape="rect" coords="0,56,245,80"/>
<area href="classCppNoddy_1_1Uncopyable.html" title="An object to block copying." alt="CppNoddy::Uncopyable" shape="rect" coords="0,0,245,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac0b6f7a075ce464b246b9350f359f598"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#ac0b6f7a075ce464b246b9350f359f598">ODE_BVP</a> (<a class="el" href="classCppNoddy_1_1Equation__1matrix.html">Equation_1matrix</a>&lt; _Type, _Xtype &gt; *ptr_to_equation, const <a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Xtype &gt; &amp;nodes, <a class="el" href="classCppNoddy_1_1Residual.html">Residual</a>&lt; _Type &gt; *ptr_to_left_residual, <a class="el" href="classCppNoddy_1_1Residual.html">Residual</a>&lt; _Type &gt; *ptr_to_right_residual)</td></tr>
<tr class="memdesc:ac0b6f7a075ce464b246b9350f359f598"><td class="mdescLeft">&#160;</td><td class="mdescRight">The class is defined by a vector function for the system.  <a href="classCppNoddy_1_1ODE__BVP.html#ac0b6f7a075ce464b246b9350f359f598">More...</a><br /></td></tr>
<tr class="separator:ac0b6f7a075ce464b246b9350f359f598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa189ca7f4c5dc1021532c8eef57952b8"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#aa189ca7f4c5dc1021532c8eef57952b8">~ODE_BVP</a> ()</td></tr>
<tr class="memdesc:aa189ca7f4c5dc1021532c8eef57952b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="classCppNoddy_1_1ODE__BVP.html#aa189ca7f4c5dc1021532c8eef57952b8">More...</a><br /></td></tr>
<tr class="separator:aa189ca7f4c5dc1021532c8eef57952b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e64aa28d03056b71b421619405375b6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a9e64aa28d03056b71b421619405375b6">actions_before_linear_solve</a> (<a class="el" href="classCppNoddy_1_1BandedMatrix.html">BandedMatrix</a>&lt; _Type &gt; &amp;a, <a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt; &amp;b)</td></tr>
<tr class="memdesc:a9e64aa28d03056b71b421619405375b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">A virtual method that is called prior to the linear solve stage of the <a class="el" href="classCppNoddy_1_1ODE__BVP.html#ae73d37efde211f342a3b611a49a47b6b" title="Formulate and solve the ODE using Newton iteration and a second-order finite difference scheme.">solve2()</a> method.  <a href="classCppNoddy_1_1ODE__BVP.html#a9e64aa28d03056b71b421619405375b6">More...</a><br /></td></tr>
<tr class="separator:a9e64aa28d03056b71b421619405375b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae73d37efde211f342a3b611a49a47b6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#ae73d37efde211f342a3b611a49a47b6b">solve2</a> ()</td></tr>
<tr class="memdesc:ae73d37efde211f342a3b611a49a47b6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formulate and solve the ODE using <a class="el" href="classCppNoddy_1_1Newton.html" title="A vector NEWTON iteration class.">Newton</a> iteration and a second-order finite difference scheme.  <a href="classCppNoddy_1_1ODE__BVP.html#ae73d37efde211f342a3b611a49a47b6b">More...</a><br /></td></tr>
<tr class="separator:ae73d37efde211f342a3b611a49a47b6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5ef5d7dfc131a1b09fe231c11a89803"><td class="memItemLeft" align="right" valign="top">std::pair&lt; unsigned, unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#ad5ef5d7dfc131a1b09fe231c11a89803">adapt</a> (const double &amp;adapt_tol)</td></tr>
<tr class="memdesc:ad5ef5d7dfc131a1b09fe231c11a89803"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adapt the computational mesh ONCE.  <a href="classCppNoddy_1_1ODE__BVP.html#ad5ef5d7dfc131a1b09fe231c11a89803">More...</a><br /></td></tr>
<tr class="separator:ad5ef5d7dfc131a1b09fe231c11a89803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53a7879084708c7685b17b48e6feee73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a53a7879084708c7685b17b48e6feee73">adapt_until</a> (const double &amp;adapt_tol)</td></tr>
<tr class="memdesc:a53a7879084708c7685b17b48e6feee73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adaptively solve the system until no refinements or unrefinements are applied.  <a href="classCppNoddy_1_1ODE__BVP.html#a53a7879084708c7685b17b48e6feee73">More...</a><br /></td></tr>
<tr class="separator:a53a7879084708c7685b17b48e6feee73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6de55a04541b156a3f7bbdbb2eaf5420"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a6de55a04541b156a3f7bbdbb2eaf5420">set_monitor_det</a> (bool flag)</td></tr>
<tr class="memdesc:a6de55a04541b156a3f7bbdbb2eaf5420"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the flag that determines if the determinant will be monitored The default is to monitor.  <a href="classCppNoddy_1_1ODE__BVP.html#a6de55a04541b156a3f7bbdbb2eaf5420">More...</a><br /></td></tr>
<tr class="separator:a6de55a04541b156a3f7bbdbb2eaf5420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8cd2a68518675ba206575436dc1fbe1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#ae8cd2a68518675ba206575436dc1fbe1">init_arc</a> (_Type *<a class="el" href="HYPAcousticReflection_8cpp.html#a6b7b47dd702d9e331586d485013fd1eaa188032b3e6837794e08d485d4426f1bb">p</a>, const double &amp;length, const double &amp;max_length)</td></tr>
<tr class="memdesc:ae8cd2a68518675ba206575436dc1fbe1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the class ready for arc length continuation.  <a href="classCppNoddy_1_1ODE__BVP.html#ae8cd2a68518675ba206575436dc1fbe1">More...</a><br /></td></tr>
<tr class="separator:ae8cd2a68518675ba206575436dc1fbe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5215f2492cd9c10c5ef753e41f5299fd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a5215f2492cd9c10c5ef753e41f5299fd">arclength_solve</a> (const double &amp;step)</td></tr>
<tr class="memdesc:a5215f2492cd9c10c5ef753e41f5299fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arc-length solve the system.  <a href="classCppNoddy_1_1ODE__BVP.html#a5215f2492cd9c10c5ef753e41f5299fd">More...</a><br /></td></tr>
<tr class="separator:a5215f2492cd9c10c5ef753e41f5299fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a32cb096c7fbf1b70b43de0d6e8807"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCppNoddy_1_1OneD__Node__Mesh.html">OneD_Node_Mesh</a>&lt; _Type, _Xtype &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#aa4a32cb096c7fbf1b70b43de0d6e8807">solution</a> ()</td></tr>
<tr class="separator:aa4a32cb096c7fbf1b70b43de0d6e8807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10abc65b31bdc85a98e275635b5dc27d"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a10abc65b31bdc85a98e275635b5dc27d">tolerance</a> ()</td></tr>
<tr class="memdesc:a10abc65b31bdc85a98e275635b5dc27d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access method to the tolerance.  <a href="classCppNoddy_1_1ODE__BVP.html#a10abc65b31bdc85a98e275635b5dc27d">More...</a><br /></td></tr>
<tr class="separator:a10abc65b31bdc85a98e275635b5dc27d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acebdc0ea3fade2e901ba5219e3d493c8"><td class="memItemLeft" align="right" valign="top">int &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#acebdc0ea3fade2e901ba5219e3d493c8">max_itns</a> ()</td></tr>
<tr class="memdesc:acebdc0ea3fade2e901ba5219e3d493c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access method to the maximum number of iterations.  <a href="classCppNoddy_1_1ODE__BVP.html#acebdc0ea3fade2e901ba5219e3d493c8">More...</a><br /></td></tr>
<tr class="separator:acebdc0ea3fade2e901ba5219e3d493c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f7ec75c1314441e722b45527a3c296"><td class="memItemLeft" align="right" valign="top">std::pair&lt; unsigned, unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a22f7ec75c1314441e722b45527a3c296">adapt</a> (const double &amp;adapt_tol)</td></tr>
<tr class="separator:a22f7ec75c1314441e722b45527a3c296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c5090867f757aa3f6220c044d5b345f"><td class="memItemLeft" align="right" valign="top">std::pair&lt; unsigned, unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a0c5090867f757aa3f6220c044d5b345f">adapt</a> (const double &amp;adapt_tol)</td></tr>
<tr class="separator:a0c5090867f757aa3f6220c044d5b345f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bceb2baefcf99e9e6327c90052534d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a5bceb2baefcf99e9e6327c90052534d9">adapt_until</a> (const double &amp;adapt_tol)</td></tr>
<tr class="separator:a5bceb2baefcf99e9e6327c90052534d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a646d61d434c1d7ad1b4b70909e07f241"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ODE__BVP.html#a646d61d434c1d7ad1b4b70909e07f241">adapt_until</a> (const double &amp;adapt_tol)</td></tr>
<tr class="separator:a646d61d434c1d7ad1b4b70909e07f241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classCppNoddy_1_1ArcLength__base"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classCppNoddy_1_1ArcLength__base')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classCppNoddy_1_1ArcLength__base.html">CppNoddy::ArcLength_base&lt; _Type &gt;</a></td></tr>
<tr class="memitem:a7332ba86e572f6c3e5920607f83542ad inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a7332ba86e572f6c3e5920607f83542ad">ArcLength_base</a> ()</td></tr>
<tr class="separator:a7332ba86e572f6c3e5920607f83542ad inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e356ca3e0afda266b53bdf3899c7496 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a9e356ca3e0afda266b53bdf3899c7496">~ArcLength_base</a> ()</td></tr>
<tr class="separator:a9e356ca3e0afda266b53bdf3899c7496 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3956ab4b3131ab8fcd00ca9b3e8316de inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a3956ab4b3131ab8fcd00ca9b3e8316de">init_arc</a> (<a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt; x, _Type *<a class="el" href="HYPAcousticReflection_8cpp.html#a6b7b47dd702d9e331586d485013fd1eaa188032b3e6837794e08d485d4426f1bb">p</a>, const double &amp;length, const double &amp;max_length)</td></tr>
<tr class="memdesc:a3956ab4b3131ab8fcd00ca9b3e8316de inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the class ready for arc-length continuation.  <a href="classCppNoddy_1_1ArcLength__base.html#a3956ab4b3131ab8fcd00ca9b3e8316de">More...</a><br /></td></tr>
<tr class="separator:a3956ab4b3131ab8fcd00ca9b3e8316de inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7547b7619a71f311dfc33892c8860173 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a7547b7619a71f311dfc33892c8860173">ds</a> ()</td></tr>
<tr class="memdesc:a7547b7619a71f311dfc33892c8860173 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a handle to the arclength step.  <a href="classCppNoddy_1_1ArcLength__base.html#a7547b7619a71f311dfc33892c8860173">More...</a><br /></td></tr>
<tr class="separator:a7547b7619a71f311dfc33892c8860173 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08cf7c6b859025976649eb244cb36f8 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#af08cf7c6b859025976649eb244cb36f8">arcstep_multiplier</a> ()</td></tr>
<tr class="memdesc:af08cf7c6b859025976649eb244cb36f8 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to set the multiplication constant used when increasing or decreasing the arclength step.  <a href="classCppNoddy_1_1ArcLength__base.html#af08cf7c6b859025976649eb244cb36f8">More...</a><br /></td></tr>
<tr class="separator:af08cf7c6b859025976649eb244cb36f8 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53de8c81f476ebd22ed733f9fe6e11ac inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">bool &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a53de8c81f476ebd22ed733f9fe6e11ac">rescale_theta</a> ()</td></tr>
<tr class="memdesc:a53de8c81f476ebd22ed733f9fe6e11ac inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle to the RESCALE_THETA flag.  <a href="classCppNoddy_1_1ArcLength__base.html#a53de8c81f476ebd22ed733f9fe6e11ac">More...</a><br /></td></tr>
<tr class="separator:a53de8c81f476ebd22ed733f9fe6e11ac inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bce92cad8948a3d9ee988e17879b56c inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a8bce92cad8948a3d9ee988e17879b56c">theta</a> ()</td></tr>
<tr class="memdesc:a8bce92cad8948a3d9ee988e17879b56c inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the arclength theta parameter.  <a href="classCppNoddy_1_1ArcLength__base.html#a8bce92cad8948a3d9ee988e17879b56c">More...</a><br /></td></tr>
<tr class="separator:a8bce92cad8948a3d9ee988e17879b56c inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fdb33a812543c7ab564c6dafb9f525 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#af2fdb33a812543c7ab564c6dafb9f525">desired_arc_proportion</a> ()</td></tr>
<tr class="memdesc:af2fdb33a812543c7ab564c6dafb9f525 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle to the desired proportion of the parameter to be used in the arc length solver.  <a href="classCppNoddy_1_1ArcLength__base.html#af2fdb33a812543c7ab564c6dafb9f525">More...</a><br /></td></tr>
<tr class="separator:af2fdb33a812543c7ab564c6dafb9f525 inherit pub_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classCppNoddy_1_1ArcLength__base"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classCppNoddy_1_1ArcLength__base')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classCppNoddy_1_1ArcLength__base.html">CppNoddy::ArcLength_base&lt; _Type &gt;</a></td></tr>
<tr class="memitem:a2affcbe4047df976fb13091d235a3355 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a2affcbe4047df976fb13091d235a3355">update</a> (const <a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt; &amp;x)</td></tr>
<tr class="memdesc:a2affcbe4047df976fb13091d235a3355 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">A method called by arclength_solve and init_arc which stores the current converged state and parameter and hence computes the derivatives w.r.t the arc-length.  <a href="classCppNoddy_1_1ArcLength__base.html#a2affcbe4047df976fb13091d235a3355">More...</a><br /></td></tr>
<tr class="separator:a2affcbe4047df976fb13091d235a3355 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5e559b7566c5d715387e55a68748e87 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#ac5e559b7566c5d715387e55a68748e87">arclength_residual</a> (const <a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt; &amp;x) const</td></tr>
<tr class="memdesc:ac5e559b7566c5d715387e55a68748e87 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">The extra constraint that is to be used to replace the unknown arc length.  <a href="classCppNoddy_1_1ArcLength__base.html#ac5e559b7566c5d715387e55a68748e87">More...</a><br /></td></tr>
<tr class="separator:ac5e559b7566c5d715387e55a68748e87 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9bca19cb6b7ce3e4d064f4d030ad918 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#aa9bca19cb6b7ce3e4d064f4d030ad918">Jac_arclength_residual</a> (<a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt; &amp;x) const</td></tr>
<tr class="memdesc:aa9bca19cb6b7ce3e4d064f4d030ad918 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">The derivative of the arclength_residual function with respect to each of the state variables.  <a href="classCppNoddy_1_1ArcLength__base.html#aa9bca19cb6b7ce3e4d064f4d030ad918">More...</a><br /></td></tr>
<tr class="separator:aa9bca19cb6b7ce3e4d064f4d030ad918 inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc7cddc28c16af949fdd38e69b0a5be inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a0cc7cddc28c16af949fdd38e69b0a5be">update_theta</a> (const <a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt; &amp;x)</td></tr>
<tr class="memdesc:a0cc7cddc28c16af949fdd38e69b0a5be inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Automatically update the Keller THETA such that the proportion of the arclength obtained from the parameter is the desired value.  <a href="classCppNoddy_1_1ArcLength__base.html#a0cc7cddc28c16af949fdd38e69b0a5be">More...</a><br /></td></tr>
<tr class="separator:a0cc7cddc28c16af949fdd38e69b0a5be inherit pro_methods_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classCppNoddy_1_1ArcLength__base"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classCppNoddy_1_1ArcLength__base')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classCppNoddy_1_1ArcLength__base.html">CppNoddy::ArcLength_base&lt; _Type &gt;</a></td></tr>
<tr class="memitem:a217bb0b41062e867c0bb70789a7ba85d inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">_Type *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a></td></tr>
<tr class="memdesc:a217bb0b41062e867c0bb70789a7ba85d inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to the parameter in arclength solves  <a href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">More...</a><br /></td></tr>
<tr class="separator:a217bb0b41062e867c0bb70789a7ba85d inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a605dae6d835a8efb41398a03c17e2 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#ad9a605dae6d835a8efb41398a03c17e2">LAST_X</a></td></tr>
<tr class="memdesc:ad9a605dae6d835a8efb41398a03c17e2 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">state variable at the last computed solution  <a href="classCppNoddy_1_1ArcLength__base.html#ad9a605dae6d835a8efb41398a03c17e2">More...</a><br /></td></tr>
<tr class="separator:ad9a605dae6d835a8efb41398a03c17e2 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f3c342760bbe758a5496dcec8c8aaf2 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a6f3c342760bbe758a5496dcec8c8aaf2">X_DERIV_S</a></td></tr>
<tr class="memdesc:a6f3c342760bbe758a5496dcec8c8aaf2 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">derivative of the state variable w.r.t. arc length  <a href="classCppNoddy_1_1ArcLength__base.html#a6f3c342760bbe758a5496dcec8c8aaf2">More...</a><br /></td></tr>
<tr class="separator:a6f3c342760bbe758a5496dcec8c8aaf2 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0d420c80f1e189c269be28de67d270c inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">_Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#ad0d420c80f1e189c269be28de67d270c">LAST_PARAM</a></td></tr>
<tr class="memdesc:ad0d420c80f1e189c269be28de67d270c inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameter value at the last computed solution  <a href="classCppNoddy_1_1ArcLength__base.html#ad0d420c80f1e189c269be28de67d270c">More...</a><br /></td></tr>
<tr class="separator:ad0d420c80f1e189c269be28de67d270c inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a025175a08a7e585109b9c766dfef41 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">_Type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a4a025175a08a7e585109b9c766dfef41">PARAM_DERIV_S</a></td></tr>
<tr class="memdesc:a4a025175a08a7e585109b9c766dfef41 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">derivative of the parameter w.r.t arc length  <a href="classCppNoddy_1_1ArcLength__base.html#a4a025175a08a7e585109b9c766dfef41">More...</a><br /></td></tr>
<tr class="separator:a4a025175a08a7e585109b9c766dfef41 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95be3e4d21420742796c867c029a0b7e inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a></td></tr>
<tr class="memdesc:a95be3e4d21420742796c867c029a0b7e inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">size of the arc length step  <a href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">More...</a><br /></td></tr>
<tr class="separator:a95be3e4d21420742796c867c029a0b7e inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2d270f145e35c6f1e737ed47e3fe16 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#aca2d270f145e35c6f1e737ed47e3fe16">MAX_DS</a></td></tr>
<tr class="memdesc:aca2d270f145e35c6f1e737ed47e3fe16 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum arc length step to be taken  <a href="classCppNoddy_1_1ArcLength__base.html#aca2d270f145e35c6f1e737ed47e3fe16">More...</a><br /></td></tr>
<tr class="separator:aca2d270f145e35c6f1e737ed47e3fe16 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cc4ecca81091e3ebb9bd228c37dbb6e inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a9cc4ecca81091e3ebb9bd228c37dbb6e">ARCSTEP_MULTIPLIER</a></td></tr>
<tr class="memdesc:a9cc4ecca81091e3ebb9bd228c37dbb6e inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">step change multiplier  <a href="classCppNoddy_1_1ArcLength__base.html#a9cc4ecca81091e3ebb9bd228c37dbb6e">More...</a><br /></td></tr>
<tr class="separator:a9cc4ecca81091e3ebb9bd228c37dbb6e inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53508c2e9ef71f425035e15dff43f2c7 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#a53508c2e9ef71f425035e15dff43f2c7">INITIALISED</a></td></tr>
<tr class="memdesc:a53508c2e9ef71f425035e15dff43f2c7 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">for the arc-length solver - to show it has been initialised  <a href="classCppNoddy_1_1ArcLength__base.html#a53508c2e9ef71f425035e15dff43f2c7">More...</a><br /></td></tr>
<tr class="separator:a53508c2e9ef71f425035e15dff43f2c7 inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4c9b75e76744e81b648c1c5a5c93a8f inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCppNoddy_1_1ArcLength__base.html#ac4c9b75e76744e81b648c1c5a5c93a8f">THETA</a></td></tr>
<tr class="memdesc:ac4c9b75e76744e81b648c1c5a5c93a8f inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="mdescLeft">&#160;</td><td class="mdescRight">the arclength theta  <a href="classCppNoddy_1_1ArcLength__base.html#ac4c9b75e76744e81b648c1c5a5c93a8f">More...</a><br /></td></tr>
<tr class="separator:ac4c9b75e76744e81b648c1c5a5c93a8f inherit pro_attribs_classCppNoddy_1_1ArcLength__base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename _Type, typename _Xtype = double&gt;<br />
class CppNoddy::ODE_BVP&lt; _Type, _Xtype &gt;</h3>

<p>A templated object for real/complex vector system of first-order ordinary differential equations. </p>
<p>The class is double templated, with the first type associated with real/complex data, and second (real/complex) type associated with a problem on the real line or line in the complex plane. </p>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8h_source.html#l00037">37</a> of file <a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac0b6f7a075ce464b246b9350f359f598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b6f7a075ce464b246b9350f359f598">&#9670;&nbsp;</a></span>ODE_BVP()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::<a class="el" href="classCppNoddy_1_1ODE__BVP.html">ODE_BVP</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCppNoddy_1_1Equation__1matrix.html">Equation_1matrix</a>&lt; _Type, _Xtype &gt; *&#160;</td>
          <td class="paramname"><em>ptr_to_equation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Xtype &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCppNoddy_1_1Residual.html">Residual</a>&lt; _Type &gt; *&#160;</td>
          <td class="paramname"><em>ptr_to_left_residual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCppNoddy_1_1Residual.html">Residual</a>&lt; _Type &gt; *&#160;</td>
          <td class="paramname"><em>ptr_to_right_residual</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The class is defined by a vector function for the system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ptr_to_equation</td><td>A pointer to an <a class="el" href="classCppNoddy_1_1Equation__1matrix.html" title="An equation object base class used in the IBVP classes (and others).">Equation_1matrix</a> object. </td></tr>
    <tr><td class="paramname">nodes</td><td>A vector that defines the nodal positions. </td></tr>
    <tr><td class="paramname">ptr_to_left_residual</td><td>A pointer to a residual object that defines the LHS boundary conditions. </td></tr>
    <tr><td class="paramname">ptr_to_right_residual</td><td>A pointer to a residual object that defines the RHS boundary conditions. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00031">31</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                                                          :</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    ArcLength_base&lt;_Type&gt; (),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    MAX_ITERATIONS(12),</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    TOL(1.e-8),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    LAST_DET_SIGN(0),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    p_EQUATION(ptr_to_equation),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    p_LEFT_RESIDUAL(ptr_to_left_residual),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    p_RIGHT_RESIDUAL(ptr_to_right_residual),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    MONITOR_DET(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// set up the solution mesh using these nodes</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    SOLUTION = OneD_Node_Mesh&lt;_Type, _Xtype&gt;(nodes, p_EQUATION -&gt; get_order());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span>((p_LEFT_RESIDUAL -&gt; get_number_of_vars() != p_EQUATION -&gt; get_order()) ||</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        (p_RIGHT_RESIDUAL -&gt; get_number_of_vars() != p_EQUATION -&gt; get_order()) ||</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        (p_LEFT_RESIDUAL -&gt; get_order() + p_RIGHT_RESIDUAL -&gt; get_order() != p_EQUATION -&gt; get_order())) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;order &quot;</span> &lt;&lt; p_EQUATION -&gt; get_order() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;left nvars &quot;</span> &lt;&lt; p_LEFT_RESIDUAL -&gt; get_number_of_vars() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;right nvars &quot;</span> &lt;&lt; p_RIGHT_RESIDUAL -&gt; get_number_of_vars() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;left order &quot;</span> &lt;&lt; p_LEFT_RESIDUAL -&gt; get_order() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;right order &quot;</span> &lt;&lt; p_RIGHT_RESIDUAL -&gt; get_order() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      std::string problem;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      problem = <span class="stringliteral">&quot;It looks like the ODE_BVP equation and boundary conditions are\n&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      problem += <span class="stringliteral">&quot;not well posed. The number of variables for each boundary condition\n&quot;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      problem += <span class="stringliteral">&quot;has to be the same as the order of the equation. Also the order of\n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      problem += <span class="stringliteral">&quot;both boundary conditions has to sum to the order of the equation.\n&quot;</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">throw</span> ExceptionRuntime(problem);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#ifdef TIME</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// timers</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    T_ASSEMBLE = Timer(<span class="stringliteral">&quot;ODE_BVP: Assembling of the matrix (incl. equation updates):&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    T_SOLVE = Timer(<span class="stringliteral">&quot;ODE_BVP: Solving of the matrix:&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    T_REFINE = Timer(<span class="stringliteral">&quot;ODE_BVP: Refining the mesh:&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa189ca7f4c5dc1021532c8eef57952b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa189ca7f4c5dc1021532c8eef57952b8">&#9670;&nbsp;</a></span>~ODE_BVP()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::~<a class="el" href="classCppNoddy_1_1ODE__BVP.html">ODE_BVP</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00069">69</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                   {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#ifdef TIME</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">//T_ASSEMBLE.stop();</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    T_ASSEMBLE.print();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">//T_SOLVE.stop();</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    T_SOLVE.print();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">//T_REFINE.stop();</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    T_REFINE.print();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9e64aa28d03056b71b421619405375b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e64aa28d03056b71b421619405375b6">&#9670;&nbsp;</a></span>actions_before_linear_solve()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype  = double&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::actions_before_linear_solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCppNoddy_1_1BandedMatrix.html">BandedMatrix</a>&lt; _Type &gt; &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCppNoddy_1_1DenseVector.html">DenseVector</a>&lt; _Type &gt; &amp;&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A virtual method that is called prior to the linear solve stage of the <a class="el" href="classCppNoddy_1_1ODE__BVP.html#ae73d37efde211f342a3b611a49a47b6b" title="Formulate and solve the ODE using Newton iteration and a second-order finite difference scheme.">solve2()</a> method. </p>
<p>This is called prior to any linear solve to allow the user to manually tune the matrix problem directly. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>The Jacbian matrix to be passed to the linear solver </td></tr>
    <tr><td class="paramname">b</td><td>The residual vector to be passed to the linear solver </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8h_source.html#l00063">63</a> of file <a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5ef5d7dfc131a1b09fe231c11a89803"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5ef5d7dfc131a1b09fe231c11a89803">&#9670;&nbsp;</a></span>adapt() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned, unsigned &gt; <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::adapt </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>adapt_tol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adapt the computational mesh ONCE. </p>
<p>We step through each interior node and evaluate the residual at that node. If the residual is less than the convergence tolerance, the node is removed. If the residual is greater than the adapt_tol parameter, then the mesh is adapted with an addition node place either side of the evaluation node. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adapt_tol</td><td>The residual tolerance at a nodal point that will lead to the mesh adaptation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pair of values indicating the number of refinements and unrefinements. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00481">481</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                                                                     {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">#ifdef TIME</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    T_REFINE.start();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// the order of the problem</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">unsigned</span> order(p_EQUATION -&gt; get_order());</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// get the number of nodes in the mesh</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// -- this may have been refined by the user since the</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// last call.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">unsigned</span> N(SOLUTION.get_nnodes());</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// row counter</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">//std::size_t row( 0 );</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// local state variable and functions</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    DenseVector&lt;_Type&gt; F_node(order, 0.0);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    DenseVector&lt;_Type&gt; R_node(order, 0.0);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// make sure (un)refine flags vector is sized</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    std::vector&lt; bool &gt; refine(N, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    std::vector&lt; bool &gt; unrefine(N, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// Residual vector at interior nodes</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    DenseVector&lt;double&gt; Res2(N, 0.0);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// reset row counter</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">//row = 0;</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// inner nodes of the mesh, node = 1,2,...,N-2</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">for</span>(std::size_t node = 1; node &lt;= N - 2; node += 2) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">// set the current solution at this node</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> var = 0; var &lt; order; ++var) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">//F_node[ var ] = SOLUTION[ var ][ node ];</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        F_node[ var ] = SOLUTION(node, var);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">// set the y-pos in the eqn</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      p_EQUATION -&gt; coord(0) = SOLUTION.coord(node);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="comment">// Update the equation to the nodal position</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      p_EQUATION -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a2affcbe4047df976fb13091d235a3355">update</a>(F_node);<span class="comment"></span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">      //// evaluate the RHS at the node</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span>      <span class="comment">//p_EQUATION -&gt; get_residual( R_node );</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="comment">// step size centred at the node</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      _Xtype invh = 1. / (SOLUTION.coord(node + 1) - SOLUTION.coord(node - 1));</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="comment">// loop over all the variables</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      DenseVector&lt;_Type&gt; temp(order, 0.0);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> var = 0; var &lt; order; ++var) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="comment">// residual</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">//temp[ var ] = p_EQUATION -&gt; residual()[ var ] - ( SOLUTION[ var ][ node + 1 ] - SOLUTION[ var ][ node - 1 ] ) * invh;</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        temp[ var ] = p_EQUATION -&gt; residual()[ var ] - (SOLUTION(node + 1, var) - SOLUTION(node - 1, var)) * invh;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      Res2[ node ] = temp.inf_norm();</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">if</span>(Res2[ node ] &gt; adapt_tol) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        refine[ node ] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(Res2[ node ] &lt; TOL / 10.) {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        unrefine[ node ] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    std::size_t no_refined(0), no_unrefined(0);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">for</span>(std::size_t i = 0; i &lt; refine.size(); ++i) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">if</span>(refine[ i ] == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        no_refined += 1;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span>(unrefine[ i ] == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        no_unrefined += 1;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[ DEBUG ] Refinements = &quot;</span> &lt;&lt; no_refined &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[ DEBUG ] Unrefinements = &quot;</span> &lt;&lt; no_unrefined &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// make a new refined/unrefined mesh</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    DenseVector&lt;_Xtype&gt; X(SOLUTION.nodes());</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    DenseVector&lt;_Xtype&gt; newX;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    newX.push_back(X[ 0 ]);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">for</span>(std::size_t i = 1; i &lt; N - 1; ++i) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">if</span>(refine[ i ]) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">if</span>(!refine[ i - 1 ]) {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;          <span class="comment">// have not already refined to the left</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;          <span class="comment">// so refine left AND right with new nodes</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;          _Xtype left(X[ i - 1 ]);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;          _Xtype right(X[ i + 1 ]);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;          _Xtype here(X[ i ]);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;          newX.push_back((left + here) / 2.);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;          newX.push_back(here);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;          newX.push_back((right + here) / 2.);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;          <span class="comment">// already left refined, so just refine right</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          _Xtype right(X[ i + 1 ]);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;          _Xtype here(X[ i ]);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          newX.push_back(here);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          newX.push_back((right + here) / 2.);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!unrefine[ i ]) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        newX.push_back(X[ i ]);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    newX.push_back(X[ N - 1 ]);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// remesh the current solution to this (un)refined mesh</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    SOLUTION.remesh1(newX);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">#ifdef TIME</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    T_REFINE.stop();</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// adding nodes will screw up the sign of the determinant of the Jacobian</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">// so here we&#39;ll just make it zero</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    LAST_DET_SIGN = 0;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    std::pair&lt; unsigned, unsigned &gt; feedback;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    feedback.first = no_refined;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    feedback.second = no_unrefined;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span> feedback;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="BVPKarmanAdaptive_8cpp_source.html#l00084">main()</a>.</p>

</div>
</div>
<a id="a22f7ec75c1314441e722b45527a3c296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22f7ec75c1314441e722b45527a3c296">&#9670;&nbsp;</a></span>adapt() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned, unsigned &gt; <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; std::complex&lt; double &gt;, std::complex&lt; double &gt; &gt;::adapt </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>adapt_tol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00432">432</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                                                                                               {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    std::string problem;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    problem = <span class="stringliteral">&quot; The ODE_BVP.adapt method has been called for a  \n&quot;</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    problem += <span class="stringliteral">&quot; problem in the complex plane. This doesn&#39;t make sense \n&quot;</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    problem += <span class="stringliteral">&quot; as the path is not geometrically defined. \n&quot;</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">throw</span> ExceptionRuntime(problem);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c5090867f757aa3f6220c044d5b345f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c5090867f757aa3f6220c044d5b345f">&#9670;&nbsp;</a></span>adapt() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned, unsigned &gt; <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; double, std::complex&lt; double &gt; &gt;::adapt </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>adapt_tol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00442">442</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                                                                                   {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    std::string problem;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    problem = <span class="stringliteral">&quot; The ODE_BVP.adapt method has been called for a  \n&quot;</span>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    problem += <span class="stringliteral">&quot; problem in the complex plane. This doesn&#39;t make sense \n&quot;</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    problem += <span class="stringliteral">&quot; as the path is not geometrically defined. \n&quot;</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">throw</span> ExceptionRuntime(problem);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a53a7879084708c7685b17b48e6feee73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53a7879084708c7685b17b48e6feee73">&#9670;&nbsp;</a></span>adapt_until() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::adapt_until </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>adapt_tol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adaptively solve the system until no refinements or unrefinements are applied. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adapt_tol</td><td>The residual tolerance at a nodal point that will lead to the mesh adaptation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00471">471</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                                                  {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    std::pair&lt; unsigned, unsigned &gt; changes;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      changes = <a class="code" href="classCppNoddy_1_1ODE__BVP.html#ad5ef5d7dfc131a1b09fe231c11a89803">adapt</a>(adapt_tol);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="classCppNoddy_1_1ODE__BVP.html#ae73d37efde211f342a3b611a49a47b6b">solve2</a>();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;[INFO] Adapting: &quot;</span> &lt;&lt; changes.first &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; changes.second &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    } <span class="keywordflow">while</span>(changes.first + changes.second != 0);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bceb2baefcf99e9e6327c90052534d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bceb2baefcf99e9e6327c90052534d9">&#9670;&nbsp;</a></span>adapt_until() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; std::complex&lt; double &gt;, std::complex&lt; double &gt; &gt;::adapt_until </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>adapt_tol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00452">452</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                                                                            {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    std::string problem;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    problem = <span class="stringliteral">&quot; The ODE_BVP.adapt method has been called for a  \n&quot;</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    problem += <span class="stringliteral">&quot; problem in the complex plane. This doesn&#39;t make sense \n&quot;</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    problem += <span class="stringliteral">&quot; as the path is not geometrically defined. \n&quot;</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">throw</span> ExceptionRuntime(problem);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a646d61d434c1d7ad1b4b70909e07f241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a646d61d434c1d7ad1b4b70909e07f241">&#9670;&nbsp;</a></span>adapt_until() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; double, std::complex&lt; double &gt; &gt;::adapt_until </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>adapt_tol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00462">462</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                                                {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    std::string problem;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    problem = <span class="stringliteral">&quot; The ODE_BVP.adapt method has been called for a  \n&quot;</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    problem += <span class="stringliteral">&quot; problem in the complex plane. This doesn&#39;t make sense \n&quot;</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    problem += <span class="stringliteral">&quot; as the path is not geometrically defined. \n&quot;</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">throw</span> ExceptionRuntime(problem);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5215f2492cd9c10c5ef753e41f5299fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5215f2492cd9c10c5ef753e41f5299fd">&#9670;&nbsp;</a></span>arclength_solve()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::arclength_solve </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>step</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Arc-length solve the system. </p>
<p>Before this can be called the arc_init method should have been called in order to ensure we know a solution and have derivatives w.r.t. the arc-length parameter. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>y &amp; z should be solved for simultaneously - but to do this we'd have to extend the LAPACK interface and/or provide the same feature for the native solver. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00164">164</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                                                   {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a7547b7619a71f311dfc33892c8860173">ds</a>() = step;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// order of the equation</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">unsigned</span> order(p_EQUATION -&gt; get_order());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// the number of nodes in the BVP</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">unsigned</span> n(SOLUTION.get_nnodes());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Banded Jacobian</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    BandedMatrix&lt;_Type&gt; Jac(n * order, 2 * order - 1, 0.0);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// residuals over all nodes vectors</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    DenseVector&lt;_Type&gt; Res1(n * order, 0.0);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    DenseVector&lt;_Type&gt; Res2(n * order, 0.0);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// RHS vectors for the linear solver(s)</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    DenseVector&lt;_Type&gt; y(n * order, 0.0);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    DenseVector&lt;_Type&gt; <a class="code" href="namespaceCppNoddy_1_1Example.html#ab42c85cd20d26f01c651c8f682b2efa8">z</a>(n * order, 0.0);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#ifdef LAPACK</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    BandedLinearSystem&lt;_Type&gt; system1(&amp;Jac, &amp;y, <span class="stringliteral">&quot;lapack&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    BandedLinearSystem&lt;_Type&gt; system2(&amp;Jac, &amp;<a class="code" href="namespaceCppNoddy_1_1Example.html#ab42c85cd20d26f01c651c8f682b2efa8">z</a>, <span class="stringliteral">&quot;lapack&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    BandedLinearSystem&lt;_Type&gt; system1(&amp;Jac, &amp;y, <span class="stringliteral">&quot;native&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    BandedLinearSystem&lt;_Type&gt; system2(&amp;Jac, &amp;<a class="code" href="namespaceCppNoddy_1_1Example.html#ab42c85cd20d26f01c651c8f682b2efa8">z</a>, <span class="stringliteral">&quot;native&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// we use the member data &#39;monitor_det&#39; to set the linear system determinant monitor</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    system1.set_monitor_det(MONITOR_DET);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// make backups in case we can&#39;t find a converged solution</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    DenseVector&lt;_Type&gt; backup_state(SOLUTION.vars_as_vector());</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    _Type backup_parameter(*(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a>));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// we can generate a 1st-order guess for the next state and parameter</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    DenseVector&lt;_Type&gt; x(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#ad9a605dae6d835a8efb41398a03c17e2">LAST_X</a> + <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a6f3c342760bbe758a5496dcec8c8aaf2">X_DERIV_S</a> * <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    *(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a>) = <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#ad0d420c80f1e189c269be28de67d270c">LAST_PARAM</a> + <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a4a025175a08a7e585109b9c766dfef41">PARAM_DERIV_S</a> * <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// the class keeps the solution in a OneD_mesh object, so we update it here</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    SOLUTION.set_vars_from_vector(x);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// determinant monitor</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">int</span> det_sign(0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// a flag to indicate if we have made a successful step</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">bool</span> step_succeeded(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// iteration counter</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// loop until converged or too many iterations</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">do</span> {<span class="comment"></span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">      /// \todo y &amp; z should be solved for simultaneously - but to do this</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">      /// we&#39;d have to extend the LAPACK interface and/or provide the</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">      /// same feature for the native solver.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span>      ++counter;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="comment">// extra constraint corresponding to the new unknow parameter (arclength)</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordtype">double</span> E1 = <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#ac5e559b7566c5d715387e55a68748e87">arclength_residual</a>(x);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">// construct the Jacobian/residual matrix problem</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      assemble_matrix_problem(Jac, Res1);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <a class="code" href="classCppNoddy_1_1ODE__BVP.html#a9e64aa28d03056b71b421619405375b6">actions_before_linear_solve</a>(Jac, Res1);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">//BandedMatrix&lt;_Type&gt; Jac_copy( Jac );</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      y = Res1;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot; [ DEBUG ] : max_residual = &quot; &lt;&lt; Res1.inf_norm() &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">if</span>(Res1.inf_norm() &lt; TOL &amp;&amp; counter &gt; 1) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        step_succeeded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        system1.solve();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        det_sign = system1.get_det_sign();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      } <span class="keywordflow">catch</span>(<span class="keyword">const</span> ExceptionExternal &amp;error) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        step_succeeded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// derivs w.r.t parameter</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> delta(1.e-8);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      *(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a>) += delta;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">// we actually just want the Res2 &amp; e2 vectors, so we still</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="comment">// use the original Jacobian j ... but it was overwritten by the</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// previous solve.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      assemble_matrix_problem(Jac, Res2);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">//Jac = Jac_copy;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordtype">double</span> E2 = <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#ac5e559b7566c5d715387e55a68748e87">arclength_residual</a>(x);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="classCppNoddy_1_1ODE__BVP.html#a9e64aa28d03056b71b421619405375b6">actions_before_linear_solve</a>(Jac, Res2);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      *(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a>)  -= delta;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      DenseVector&lt;_Type&gt; dRes_dp((Res2 - Res1) / delta);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordtype">double</span> dE_dp = (E2 - E1) / delta;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="namespaceCppNoddy_1_1Example.html#ab42c85cd20d26f01c651c8f682b2efa8">z</a> = dRes_dp;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        system2.solve();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      } <span class="keywordflow">catch</span>(<span class="keyword">const</span> ExceptionExternal&amp; error) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        step_succeeded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">// this is the extra (full) row in the augmented matrix problem</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="comment">// bottom row formed from dE/dx_j</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      DenseVector&lt;_Type&gt; Jac_E(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#aa9bca19cb6b7ce3e4d064f4d030ad918">Jac_arclength_residual</a>(x));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="comment">// given the solutions y &amp; z, the bordering algo provides the</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">// solution to the full sparse system via</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      _Type delta_p = - (E1 + <a class="code" href="namespaceCppNoddy_1_1Utility.html#a4ef891e4e1b6f5bf7c5d588fd8868f1d">Utility::dot</a>(Jac_E, y)) /</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                      (dE_dp + <a class="code" href="namespaceCppNoddy_1_1Utility.html#a4ef891e4e1b6f5bf7c5d588fd8868f1d">Utility::dot</a>(Jac_E, <a class="code" href="namespaceCppNoddy_1_1Example.html#ab42c85cd20d26f01c651c8f682b2efa8">z</a>));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      DenseVector&lt;_Type&gt; delta_x = y + <a class="code" href="namespaceCppNoddy_1_1Example.html#ab42c85cd20d26f01c651c8f682b2efa8">z</a> * delta_p;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot; [ DEBUG ] : Arclength_solve, dp = &quot;</span> &lt;&lt; delta_p</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; dx.inf_norm() = &quot;</span> &lt;&lt; delta_x.inf_norm()</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; theta = &quot;</span> &lt;&lt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#ac4c9b75e76744e81b648c1c5a5c93a8f">THETA</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="comment">// update the state variables and the parameter with corrections</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      x += delta_x;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      *(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a>) += delta_p;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">// the corrections must be put back into the mesh container</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      SOLUTION.set_vars_from_vector(x);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="comment">// converged?</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span>(delta_x.inf_norm() &lt; TOL) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        step_succeeded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">// too many iterations?</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">if</span> ((counter &gt; MAX_ITERATIONS) || (delta_x.inf_norm() &gt; 100 )) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        step_succeeded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    } <span class="keywordflow">while</span>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span>(!step_succeeded) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">// if not a successful step then restore things</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      SOLUTION.set_vars_from_vector(backup_state);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      *(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a>) = backup_parameter;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="comment">// reduce our step length</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> /= <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a9cc4ecca81091e3ebb9bd228c37dbb6e">ARCSTEP_MULTIPLIER</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;[ DEBUG ] : REJECTING STEP \n&quot;</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;[ DEBUG ] : I decreased DS to &quot;</span> &lt;&lt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// update the variables needed for arc-length continuation</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a2affcbe4047df976fb13091d235a3355">update</a>(SOLUTION.vars_as_vector());</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">if</span>(LAST_DET_SIGN * det_sign &lt; 0) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">// a change in the sign of the determinant of the Jacobian</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">// has been found</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        LAST_DET_SIGN = det_sign;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        std::string problem;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        problem = <span class="stringliteral">&quot;[ INFO ] : Determinant monitor has changed signs in the Newton class.\n&quot;</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        problem += <span class="stringliteral">&quot;[ INFO ] : Bifurcation detected.\n&quot;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">throw</span> ExceptionBifurcation(problem);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot; [ DEBUG ] : Number of iterations = &quot;</span> &lt;&lt; counter &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot; [ DEBUG ] : Parameter p = &quot;</span> &lt;&lt; *(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">p_PARAM</a>)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;; arclength DS = &quot;</span> &lt;&lt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot; [ DEBUG ] : Arclength THETA = &quot;</span> &lt;&lt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#ac4c9b75e76744e81b648c1c5a5c93a8f">THETA</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordflow">if</span>(counter &gt; 8 || std::abs(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a>) &gt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#aca2d270f145e35c6f1e737ed47e3fe16">MAX_DS</a>) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">// converging too slowly, so decrease DS</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> /= <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a9cc4ecca81091e3ebb9bd228c37dbb6e">ARCSTEP_MULTIPLIER</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot; [ DEBUG ] : I decreased DS to &quot;</span> &lt;&lt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">if</span>(counter &lt; 4) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span>(std::abs(<span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> * <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a9cc4ecca81091e3ebb9bd228c37dbb6e">ARCSTEP_MULTIPLIER</a>) &lt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#aca2d270f145e35c6f1e737ed47e3fe16">MAX_DS</a>) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <span class="comment">// converging too quickly, so increase DS</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> *= <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a9cc4ecca81091e3ebb9bd228c37dbb6e">ARCSTEP_MULTIPLIER</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot; [ DEBUG ] : I increased DS to &quot;</span> &lt;&lt; <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">DS</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="BVPKarmanArclength_8cpp_source.html#l00092">main()</a>.</p>

</div>
</div>
<a id="ae8cd2a68518675ba206575436dc1fbe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8cd2a68518675ba206575436dc1fbe1">&#9670;&nbsp;</a></span>init_arc()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::init_arc </td>
          <td>(</td>
          <td class="paramtype">_Type *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>max_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the class ready for arc length continuation. </p>
<p>The base class requires a vector, so we wrap the base class method here so that the vector can be extracted from the mesh member data. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>The pointer to the parameter </td></tr>
    <tr><td class="paramname">length</td><td>The initial arc length step to be taken (all in the parameter. </td></tr>
    <tr><td class="paramname">max_length</td><td>The maximum arc length step to be allowed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8h_source.html#l00179">179</a> of file <a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                                                  {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    DenseVector&lt;_Type&gt; state(SOLUTION.vars_as_vector());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keyword">this</span> -&gt; <a class="code" href="classCppNoddy_1_1ODE__BVP.html#ae8cd2a68518675ba206575436dc1fbe1">init_arc</a>(state, <a class="code" href="HYPAcousticImpedance_8cpp.html#a80155586fa275b28773c9b203f52cabaa188032b3e6837794e08d485d4426f1bb">p</a>, length, max_length);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="BVPKarmanArclength_8cpp_source.html#l00092">main()</a>.</p>

</div>
</div>
<a id="acebdc0ea3fade2e901ba5219e3d493c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acebdc0ea3fade2e901ba5219e3d493c8">&#9670;&nbsp;</a></span>max_itns()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype  = double&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int&amp; <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::max_itns </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access method to the maximum number of iterations. </p>
<dl class="section return"><dt>Returns</dt><dd>A handle to the private member data MAX_ITERATIONS </dd></dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8h_source.html#l00120">120</a> of file <a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">return</span> MAX_ITERATIONS;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6de55a04541b156a3f7bbdbb2eaf5420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6de55a04541b156a3f7bbdbb2eaf5420">&#9670;&nbsp;</a></span>set_monitor_det()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::set_monitor_det </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the flag that determines if the determinant will be monitored The default is to monitor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flag</td><td>The boolean value that the flag will be set to </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8h_source.html#l00174">174</a> of file <a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                                        {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    MONITOR_DET = flag;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="BVPHarmonic_8cpp_source.html#l00077">main()</a>.</p>

</div>
</div>
<a id="aa4a32cb096c7fbf1b70b43de0d6e8807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a32cb096c7fbf1b70b43de0d6e8807">&#9670;&nbsp;</a></span>solution()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCppNoddy_1_1OneD__Node__Mesh.html">OneD_Node_Mesh</a>&lt; _Type, _Xtype &gt; &amp; <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::solution</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>A handle to the solution mesh </dd></dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8h_source.html#l00187">187</a> of file <a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                                                         {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">return</span> SOLUTION;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="BVPBerman_8cpp_source.html#l00079">main()</a>.</p>

</div>
</div>
<a id="ae73d37efde211f342a3b611a49a47b6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae73d37efde211f342a3b611a49a47b6b">&#9670;&nbsp;</a></span>solve2()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::solve2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Formulate and solve the ODE using <a class="el" href="classCppNoddy_1_1Newton.html" title="A vector NEWTON iteration class.">Newton</a> iteration and a second-order finite difference scheme. </p>
<p>The solution is stored in the publicly accessible 'solution' member data. </p>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8cpp_source.html#l00083">83</a> of file <a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                      {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// the order of the problem</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">unsigned</span> order(p_EQUATION -&gt; get_order());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// get the number of nodes in the mesh</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// -- this may have been refined by the user since the</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// last call.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">unsigned</span> n(SOLUTION.get_nnodes());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// measure of maximum residual</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">double</span> max_residual(1.0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// iteration counter</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// determinant monitor</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">int</span> det_sign(LAST_DET_SIGN);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// ANY LARGE STORAGE USED IN THE MAIN LOOP IS</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// DEFINED HERE TO AVOID REPEATED CONSTRUCTION.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// Note we blank the A matrix after every iteration.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Banded LHS matrix - max obove diagonal band width is</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// from first variable at node i to last variable at node i+1</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    BandedMatrix&lt;_Type&gt; a(n * order, 2 * order - 1, 0.0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// RHS</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    DenseVector&lt;_Type&gt; b(n * order, 0.0);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// linear solver definition</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#ifdef LAPACK</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    BandedLinearSystem&lt;_Type&gt; system(&amp;a, &amp;b, <span class="stringliteral">&quot;lapack&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    BandedLinearSystem&lt;_Type&gt; system(&amp;a, &amp;b, <span class="stringliteral">&quot;native&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// pass the local monitor_det flag to the linear system</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    system.set_monitor_det(MONITOR_DET);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// loop until converged or too many iterations</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="comment">// iteration counter</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      ++counter;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#ifdef TIME</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      T_ASSEMBLE.start();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      assemble_matrix_problem(a, b);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="classCppNoddy_1_1ODE__BVP.html#a9e64aa28d03056b71b421619405375b6">actions_before_linear_solve</a>(a, b);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      max_residual = b.inf_norm();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot; ODE_BVP.solve : Residual_max = &quot;</span> &lt;&lt; max_residual &lt;&lt; <span class="stringliteral">&quot; tol = &quot;</span> &lt;&lt; TOL &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#ifdef TIME</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      T_ASSEMBLE.stop();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      T_SOLVE.start();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// linear solver</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      system.solve();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// keep the solution in a OneD_Node_Mesh object</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">for</span>(std::size_t var = 0; var &lt; order; ++var) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">for</span>(std::size_t i = 0; i &lt; n; ++i) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          SOLUTION(i, var) += b[ i * order + var ];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#ifdef TIME</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      T_SOLVE.stop();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    } <span class="keywordflow">while</span>((max_residual &gt; TOL) &amp;&amp; (counter &lt; MAX_ITERATIONS));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span>(counter &gt;= MAX_ITERATIONS) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      std::string problem(<span class="stringliteral">&quot;\n The ODE_BVP.solve2 method took too many iterations. \n&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">throw</span> ExceptionItn(problem, counter, max_residual);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// last_det_sign is set to be 0 in ctor, it must be +/-1 when calculated</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span>(MONITOR_DET) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      det_sign = system.get_det_sign();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">if</span>(det_sign * LAST_DET_SIGN &lt; 0) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        LAST_DET_SIGN = det_sign;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        std::string problem;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        problem = <span class="stringliteral">&quot;[ INFO ] : Determinant monitor has changed signs in ODE_BVP.\n&quot;</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        problem += <span class="stringliteral">&quot;[ INFO ] : Bifurcation detected.\n&quot;</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">throw</span> ExceptionBifurcation(problem);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      LAST_DET_SIGN = det_sign;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="BVPBerman_8cpp_source.html#l00079">main()</a>.</p>

</div>
</div>
<a id="a10abc65b31bdc85a98e275635b5dc27d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10abc65b31bdc85a98e275635b5dc27d">&#9670;&nbsp;</a></span>tolerance()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename _Type , typename _Xtype  = double&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double&amp; <a class="el" href="classCppNoddy_1_1ODE__BVP.html">CppNoddy::ODE_BVP</a>&lt; _Type, _Xtype &gt;::tolerance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access method to the tolerance. </p>
<dl class="section return"><dt>Returns</dt><dd>A handle to the private member data TOLERANCE </dd></dl>

<p class="definition">Definition at line <a class="el" href="ODE__BVP_8h_source.html#l00114">114</a> of file <a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                        {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">return</span> TOL;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="ODE__BVP_8h_source.html">ODE_BVP.h</a></li>
<li>src/<a class="el" href="ODE__BVP_8cpp_source.html">ODE_BVP.cpp</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassCppNoddy_1_1ODE__BVP_html_ad5ef5d7dfc131a1b09fe231c11a89803"><div class="ttname"><a href="classCppNoddy_1_1ODE__BVP.html#ad5ef5d7dfc131a1b09fe231c11a89803">CppNoddy::ODE_BVP::adapt</a></div><div class="ttdeci">std::pair&lt; unsigned, unsigned &gt; adapt(const double &amp;adapt_tol)</div><div class="ttdoc">Adapt the computational mesh ONCE.</div><div class="ttdef"><b>Definition:</b> <a href="ODE__BVP_8cpp_source.html#l00481">ODE_BVP.cpp:481</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ODE__BVP_html_ae8cd2a68518675ba206575436dc1fbe1"><div class="ttname"><a href="classCppNoddy_1_1ODE__BVP.html#ae8cd2a68518675ba206575436dc1fbe1">CppNoddy::ODE_BVP::init_arc</a></div><div class="ttdeci">void init_arc(_Type *p, const double &amp;length, const double &amp;max_length)</div><div class="ttdoc">Initialise the class ready for arc length continuation.</div><div class="ttdef"><b>Definition:</b> <a href="ODE__BVP_8h_source.html#l00179">ODE_BVP.h:179</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_1_1Example_html_ab42c85cd20d26f01c651c8f682b2efa8"><div class="ttname"><a href="namespaceCppNoddy_1_1Example.html#ab42c85cd20d26f01c651c8f682b2efa8">CppNoddy::Example::z</a></div><div class="ttdeci">double z(const double &amp;x, const double &amp;y)</div><div class="ttdoc">Topography shape.</div><div class="ttdef"><b>Definition:</b> <a href="HYP2DShallowSource_8cpp_source.html#l00022">HYP2DShallowSource.cpp:22</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ODE__BVP_html_a9e64aa28d03056b71b421619405375b6"><div class="ttname"><a href="classCppNoddy_1_1ODE__BVP.html#a9e64aa28d03056b71b421619405375b6">CppNoddy::ODE_BVP::actions_before_linear_solve</a></div><div class="ttdeci">virtual void actions_before_linear_solve(BandedMatrix&lt; _Type &gt; &amp;a, DenseVector&lt; _Type &gt; &amp;b)</div><div class="ttdoc">A virtual method that is called prior to the linear solve stage of the solve2() method.</div><div class="ttdef"><b>Definition:</b> <a href="ODE__BVP_8h_source.html#l00063">ODE_BVP.h:63</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_ac4c9b75e76744e81b648c1c5a5c93a8f"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#ac4c9b75e76744e81b648c1c5a5c93a8f">CppNoddy::ArcLength_base::THETA</a></div><div class="ttdeci">double THETA</div><div class="ttdoc">the arclength theta</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00127">ArcLength_base.h:127</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_a9cc4ecca81091e3ebb9bd228c37dbb6e"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#a9cc4ecca81091e3ebb9bd228c37dbb6e">CppNoddy::ArcLength_base::ARCSTEP_MULTIPLIER</a></div><div class="ttdeci">double ARCSTEP_MULTIPLIER</div><div class="ttdoc">step change multiplier</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00123">ArcLength_base.h:123</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_ac5e559b7566c5d715387e55a68748e87"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#ac5e559b7566c5d715387e55a68748e87">CppNoddy::ArcLength_base::arclength_residual</a></div><div class="ttdeci">double arclength_residual(const DenseVector&lt; _Type &gt; &amp;x) const</div><div class="ttdoc">The extra constraint that is to be used to replace the unknown arc length.</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8cpp_source.html#l00081">ArcLength_base.cpp:81</a></div></div>
<div class="ttc" id="anamespaceCppNoddy_1_1Utility_html_a4ef891e4e1b6f5bf7c5d588fd8868f1d"><div class="ttname"><a href="namespaceCppNoddy_1_1Utility.html#a4ef891e4e1b6f5bf7c5d588fd8868f1d">CppNoddy::Utility::dot</a></div><div class="ttdeci">_Type dot(const DenseVector&lt; _Type &gt; &amp;X, const DenseVector&lt; _Type &gt; &amp;Y)</div><div class="ttdoc">Templated dot product.</div><div class="ttdef"><b>Definition:</b> <a href="Utility_8h_source.html#l00314">Utility.h:314</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_a95be3e4d21420742796c867c029a0b7e"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#a95be3e4d21420742796c867c029a0b7e">CppNoddy::ArcLength_base::DS</a></div><div class="ttdeci">double DS</div><div class="ttdoc">size of the arc length step</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00119">ArcLength_base.h:119</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_a7547b7619a71f311dfc33892c8860173"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#a7547b7619a71f311dfc33892c8860173">CppNoddy::ArcLength_base::ds</a></div><div class="ttdeci">double &amp; ds()</div><div class="ttdoc">Return a handle to the arclength step.</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8cpp_source.html#l00013">ArcLength_base.cpp:13</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_ad0d420c80f1e189c269be28de67d270c"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#ad0d420c80f1e189c269be28de67d270c">CppNoddy::ArcLength_base::LAST_PARAM</a></div><div class="ttdeci">_Type LAST_PARAM</div><div class="ttdoc">parameter value at the last computed solution</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00115">ArcLength_base.h:115</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_a4a025175a08a7e585109b9c766dfef41"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#a4a025175a08a7e585109b9c766dfef41">CppNoddy::ArcLength_base::PARAM_DERIV_S</a></div><div class="ttdeci">_Type PARAM_DERIV_S</div><div class="ttdoc">derivative of the parameter w.r.t arc length</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00117">ArcLength_base.h:117</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_aa9bca19cb6b7ce3e4d064f4d030ad918"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#aa9bca19cb6b7ce3e4d064f4d030ad918">CppNoddy::ArcLength_base::Jac_arclength_residual</a></div><div class="ttdeci">DenseVector&lt; _Type &gt; Jac_arclength_residual(DenseVector&lt; _Type &gt; &amp;x) const</div><div class="ttdoc">The derivative of the arclength_residual function with respect to each of the state variables.</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00094">ArcLength_base.h:94</a></div></div>
<div class="ttc" id="aHYPAcousticImpedance_8cpp_html_a80155586fa275b28773c9b203f52cabaa188032b3e6837794e08d485d4426f1bb"><div class="ttname"><a href="HYPAcousticImpedance_8cpp.html#a80155586fa275b28773c9b203f52cabaa188032b3e6837794e08d485d4426f1bb">p</a></div><div class="ttdeci">@ p</div><div class="ttdef"><b>Definition:</b> <a href="HYPAcousticImpedance_8cpp_source.html#l00017">HYPAcousticImpedance.cpp:17</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ODE__BVP_html_ae73d37efde211f342a3b611a49a47b6b"><div class="ttname"><a href="classCppNoddy_1_1ODE__BVP.html#ae73d37efde211f342a3b611a49a47b6b">CppNoddy::ODE_BVP::solve2</a></div><div class="ttdeci">void solve2()</div><div class="ttdoc">Formulate and solve the ODE using Newton iteration and a second-order finite difference scheme.</div><div class="ttdef"><b>Definition:</b> <a href="ODE__BVP_8cpp_source.html#l00083">ODE_BVP.cpp:83</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_a217bb0b41062e867c0bb70789a7ba85d"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#a217bb0b41062e867c0bb70789a7ba85d">CppNoddy::ArcLength_base::p_PARAM</a></div><div class="ttdeci">_Type * p_PARAM</div><div class="ttdoc">pointer to the parameter in arclength solves</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00109">ArcLength_base.h:109</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_a6f3c342760bbe758a5496dcec8c8aaf2"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#a6f3c342760bbe758a5496dcec8c8aaf2">CppNoddy::ArcLength_base::X_DERIV_S</a></div><div class="ttdeci">DenseVector&lt; _Type &gt; X_DERIV_S</div><div class="ttdoc">derivative of the state variable w.r.t. arc length</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00113">ArcLength_base.h:113</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_ad9a605dae6d835a8efb41398a03c17e2"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#ad9a605dae6d835a8efb41398a03c17e2">CppNoddy::ArcLength_base::LAST_X</a></div><div class="ttdeci">DenseVector&lt; _Type &gt; LAST_X</div><div class="ttdoc">state variable at the last computed solution</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00111">ArcLength_base.h:111</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_aca2d270f145e35c6f1e737ed47e3fe16"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#aca2d270f145e35c6f1e737ed47e3fe16">CppNoddy::ArcLength_base::MAX_DS</a></div><div class="ttdeci">double MAX_DS</div><div class="ttdoc">maximum arc length step to be taken</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8h_source.html#l00121">ArcLength_base.h:121</a></div></div>
<div class="ttc" id="aclassCppNoddy_1_1ArcLength__base_html_a2affcbe4047df976fb13091d235a3355"><div class="ttname"><a href="classCppNoddy_1_1ArcLength__base.html#a2affcbe4047df976fb13091d235a3355">CppNoddy::ArcLength_base::update</a></div><div class="ttdeci">void update(const DenseVector&lt; _Type &gt; &amp;x)</div><div class="ttdoc">A method called by arclength_solve and init_arc which stores the current converged state and paramete...</div><div class="ttdef"><b>Definition:</b> <a href="ArcLength__base_8cpp_source.html#l00042">ArcLength_base.cpp:42</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Mar 6 2021 14:43:11 for CppNoddy by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
<p>&copy; 2012 </p> <a href="http://hewitt.ddns.net"> R.E. Hewitt</a>
</body>
</html>
