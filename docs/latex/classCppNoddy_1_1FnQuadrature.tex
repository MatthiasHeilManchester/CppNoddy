\doxysubsection{Cpp\+Noddy\+::Fn\+Quadrature Class Reference}
\label{classCppNoddy_1_1FnQuadrature}\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}


A quadrature class that takes a function pointer.  




{\ttfamily \#include $<$Fn\+Quadrature.\+h$>$}

Inheritance diagram for Cpp\+Noddy\+::Fn\+Quadrature\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classCppNoddy_1_1FnQuadrature}
\end{center}
\end{figure}
\doxysubsubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef void($\ast$ \textbf{ fn\+\_\+ptr}) (const double \&, double \&)
\begin{DoxyCompactList}\small\item\em The function pointer associated with this instance. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Fn\+Quadrature} (\textbf{ fn\+\_\+ptr} ptr\+\_\+to\+\_\+fn, const double \&x1, const double \&x2, const unsigned \&num\+\_\+of\+\_\+regions)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\textbf{ Fn\+Quadrature} (\textbf{ fn\+\_\+ptr} ptr\+\_\+to\+\_\+fn, const double \&x1, const double \&x2, const \textbf{ Dense\+Vector}$<$ double $>$ \&nodes)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
void \textbf{ set\+\_\+subintervals} (const unsigned \&n)
\begin{DoxyCompactList}\small\item\em A set method to define a U\+N\+I\+F\+O\+RM number of sub intervals. \end{DoxyCompactList}\item 
double \textbf{ Gauss} (const int \&n)
\begin{DoxyCompactList}\small\item\em n-\/point Gauss rule inefficiently written! \end{DoxyCompactList}\item 
double \textbf{ sub\+\_\+\+Gauss} (const int \&n)
\begin{DoxyCompactList}\small\item\em Evaluate the integral by applying an n-\/point Gauss rule on each of N sub-\/intervals. \end{DoxyCompactList}\item 
double \textbf{ trapezium} ()
\begin{DoxyCompactList}\small\item\em Quick trapezium summation again for sanity checking. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
A quadrature class that takes a function pointer. 

Definition at line 15 of file Fn\+Quadrature.\+h.



\doxysubsubsection{Member Typedef Documentation}
\mbox{\label{classCppNoddy_1_1FnQuadrature_a8115d5e171f78f80e488c885f60cddc4}} 
\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}!fn\_ptr@{fn\_ptr}}
\index{fn\_ptr@{fn\_ptr}!CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}
\doxyparagraph{fn\_ptr}
{\footnotesize\ttfamily typedef void($\ast$ Cpp\+Noddy\+::\+Fn\+Quadrature\+::fn\+\_\+ptr) (const double \&, double \&)}



The function pointer associated with this instance. 



Definition at line 20 of file Fn\+Quadrature.\+h.



\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\label{classCppNoddy_1_1FnQuadrature_a891dcc3c480d39088c6122dda8cc4c85}} 
\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}!FnQuadrature@{FnQuadrature}}
\index{FnQuadrature@{FnQuadrature}!CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}
\doxyparagraph{FnQuadrature()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Cpp\+Noddy\+::\+Fn\+Quadrature\+::\+Fn\+Quadrature (\begin{DoxyParamCaption}\item[{\textbf{ fn\+\_\+ptr}}]{ptr\+\_\+to\+\_\+fn,  }\item[{const double \&}]{x1,  }\item[{const double \&}]{x2,  }\item[{const unsigned \&}]{num\+\_\+of\+\_\+regions }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em ptr\+\_\+to\+\_\+fn} & the function that defines the integrand. \\
\hline
{\em x1} & left hand boundary of the domain. \\
\hline
{\em x2} & right hand boundary of the domain. \\
\hline
{\em num\+\_\+of\+\_\+regions} & initial number of sub-\/regions to divide the domain into. \\
\hline
\end{DoxyParams}


Definition at line 15 of file Fn\+Quadrature.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{18                                                              :}
\DoxyCodeLine{19     A(x1),}
\DoxyCodeLine{20     B(x2),}
\DoxyCodeLine{21     p\_FN(ptr\_to\_fn) \{}
\DoxyCodeLine{22     NODES = Utility::uniform\_node\_vector(x1, x2, num\_of\_regions);}
\DoxyCodeLine{23   \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector().

\mbox{\label{classCppNoddy_1_1FnQuadrature_a3fd3f4c93d7a4cbf08fbd44495d084f1}} 
\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}!FnQuadrature@{FnQuadrature}}
\index{FnQuadrature@{FnQuadrature}!CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}
\doxyparagraph{FnQuadrature()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily Cpp\+Noddy\+::\+Fn\+Quadrature\+::\+Fn\+Quadrature (\begin{DoxyParamCaption}\item[{\textbf{ fn\+\_\+ptr}}]{ptr\+\_\+to\+\_\+fn,  }\item[{const double \&}]{x1,  }\item[{const double \&}]{x2,  }\item[{const \textbf{ Dense\+Vector}$<$ double $>$ \&}]{nodes }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em ptr\+\_\+to\+\_\+fn} & the function that defines the integrand. \\
\hline
{\em x1} & left hand boundary of the domain. \\
\hline
{\em x2} & right hand boundary of the domain. \\
\hline
{\em nodes} & A vector of nodal positions. \\
\hline
\end{DoxyParams}


Definition at line 26 of file Fn\+Quadrature.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{29                                                                :}
\DoxyCodeLine{30     A(x1),}
\DoxyCodeLine{31     B(x2),}
\DoxyCodeLine{32     p\_FN(ptr\_to\_fn) \{}
\DoxyCodeLine{33     NODES = nodes;}
\DoxyCodeLine{34   \}}

\end{DoxyCode}


\doxysubsubsection{Member Function Documentation}
\mbox{\label{classCppNoddy_1_1FnQuadrature_a46ba42c73dc1976af1898e838cc42793}} 
\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}!Gauss@{Gauss}}
\index{Gauss@{Gauss}!CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}
\doxyparagraph{Gauss()}
{\footnotesize\ttfamily double Cpp\+Noddy\+::\+Fn\+Quadrature\+::\+Gauss (\begin{DoxyParamCaption}\item[{const int \&}]{n }\end{DoxyParamCaption})}



n-\/point Gauss rule inefficiently written! 


\begin{DoxyParams}{Parameters}
{\em n} & The number of points. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Approximation to the integral 
\end{DoxyReturn}


Definition at line 40 of file Fn\+Quadrature.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{40                                          \{}
\DoxyCodeLine{41     DenseVector<double> t;    \textcolor{comment}{// evaluation points in [-\/1,1]}}
\DoxyCodeLine{42     DenseVector<double> w;    \textcolor{comment}{// respective weight values}}
\DoxyCodeLine{43     \textcolor{keywordflow}{switch}(n) \{}
\DoxyCodeLine{44     \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{45       t.push\_back(0.0);}
\DoxyCodeLine{46       w.push\_back(2.0);}
\DoxyCodeLine{47       \textcolor{keywordflow}{break};}
\DoxyCodeLine{48     \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{49       t.push\_back(-\/1. / sqrt(3.));}
\DoxyCodeLine{50       w.push\_back(1.0);}
\DoxyCodeLine{51       t.push\_back(1. / sqrt(3.));}
\DoxyCodeLine{52       w.push\_back(1.0);}
\DoxyCodeLine{53       \textcolor{keywordflow}{break};}
\DoxyCodeLine{54     \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{55       t.push\_back(0.0);}
\DoxyCodeLine{56       w.push\_back(8. / 9.);}
\DoxyCodeLine{57       t.push\_back(-\/0.774596669241483);}
\DoxyCodeLine{58       w.push\_back(5. / 9.);}
\DoxyCodeLine{59       t.push\_back(0.774596669241483);}
\DoxyCodeLine{60       w.push\_back(5. / 9.);}
\DoxyCodeLine{61       \textcolor{keywordflow}{break};}
\DoxyCodeLine{62     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{63       std::string problem;}
\DoxyCodeLine{64       problem = \textcolor{stringliteral}{" The Quadrature.Gauss method is trying to apply \(\backslash\)n"};}
\DoxyCodeLine{65       problem += \textcolor{stringliteral}{" a Gauss rule with more points than 3. \(\backslash\)n"};}
\DoxyCodeLine{66       problem += \textcolor{stringliteral}{" Currenlty only n=1,2,3 are supported! \(\backslash\)n"};}
\DoxyCodeLine{67       \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{68     \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70     \textcolor{keywordtype}{double} sum = 0.0;}
\DoxyCodeLine{71     \textcolor{keywordtype}{double} c = 0.5 * (B + A);}
\DoxyCodeLine{72     \textcolor{keywordtype}{double} m = 0.5 * (B -\/ A);}
\DoxyCodeLine{73     \textcolor{keywordtype}{double} f, x;}
\DoxyCodeLine{74     t.scale(m);}
\DoxyCodeLine{75 }
\DoxyCodeLine{76     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < t.size(); ++i) \{}
\DoxyCodeLine{77       x = c + t[ i ];}
\DoxyCodeLine{78       p\_FN(x, f);}
\DoxyCodeLine{79       sum += w[ i ] * f;}
\DoxyCodeLine{80     \}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     sum = sum * m;}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{85   \}}

\end{DoxyCode}


References f, m, Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::push\+\_\+back(), Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::scale(), and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::size().



Referenced by sub\+\_\+\+Gauss().

\mbox{\label{classCppNoddy_1_1FnQuadrature_a10fc417a9c3f67220e7b6d09d91035af}} 
\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}!set\_subintervals@{set\_subintervals}}
\index{set\_subintervals@{set\_subintervals}!CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}
\doxyparagraph{set\_subintervals()}
{\footnotesize\ttfamily void Cpp\+Noddy\+::\+Fn\+Quadrature\+::set\+\_\+subintervals (\begin{DoxyParamCaption}\item[{const unsigned \&}]{n }\end{DoxyParamCaption})}



A set method to define a U\+N\+I\+F\+O\+RM number of sub intervals. 


\begin{DoxyParams}{Parameters}
{\em n} & Number of sub intervals \\
\hline
\end{DoxyParams}


Definition at line 36 of file Fn\+Quadrature.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{36                                                        \{}
\DoxyCodeLine{37     NODES = Utility::uniform\_node\_vector(A, B, n);}
\DoxyCodeLine{38   \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector().



Referenced by main().

\mbox{\label{classCppNoddy_1_1FnQuadrature_a0087a9c74c29536c2468c51085ac6159}} 
\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}!sub\_Gauss@{sub\_Gauss}}
\index{sub\_Gauss@{sub\_Gauss}!CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}
\doxyparagraph{sub\_Gauss()}
{\footnotesize\ttfamily double Cpp\+Noddy\+::\+Fn\+Quadrature\+::sub\+\_\+\+Gauss (\begin{DoxyParamCaption}\item[{const int \&}]{n }\end{DoxyParamCaption})}



Evaluate the integral by applying an n-\/point Gauss rule on each of N sub-\/intervals. 

{\bfseries{ This is inefficient in terms of class instantiation for each sub-\/interval, but not currently an issue. }} 
\begin{DoxyParams}{Parameters}
{\em n} & The order of the Gauss rule. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Approximation to the integral. 
\end{DoxyReturn}


Definition at line 88 of file Fn\+Quadrature.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{88                                              \{}
\DoxyCodeLine{89     \textcolor{keywordtype}{double} x\_left, x\_right;}
\DoxyCodeLine{90     \textcolor{keywordtype}{double} sum = 0.0;}
\DoxyCodeLine{91     \textcolor{keywordtype}{unsigned} num = NODES.size();}
\DoxyCodeLine{92     \textcolor{comment}{//    double h = ( B -\/ A ) / num;}}
\DoxyCodeLine{93 }
\DoxyCodeLine{94     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < num -\/ 1; ++i) \{}
\DoxyCodeLine{95       \textcolor{comment}{//x\_left = A + i * h;}}
\DoxyCodeLine{96       x\_left = NODES[ i ];}
\DoxyCodeLine{97       \textcolor{comment}{//x\_right = x\_left + h;}}
\DoxyCodeLine{98       x\_right = NODES[ i + 1 ];}
\DoxyCodeLine{99       FnQuadrature I(p\_FN, x\_left, x\_right, num);}
\DoxyCodeLine{100       sum += I.Gauss(n);}
\DoxyCodeLine{101     \}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103     \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{104   \}}

\end{DoxyCode}


References Gauss(), and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::size().



Referenced by main().

\mbox{\label{classCppNoddy_1_1FnQuadrature_ac1a664c10f1968dcee047df09d84e991}} 
\index{CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}!trapezium@{trapezium}}
\index{trapezium@{trapezium}!CppNoddy::FnQuadrature@{CppNoddy::FnQuadrature}}
\doxyparagraph{trapezium()}
{\footnotesize\ttfamily double Cpp\+Noddy\+::\+Fn\+Quadrature\+::trapezium (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Quick trapezium summation again for sanity checking. 

Should be essentially equivalent to the 1-\/point Gauss rule. \begin{DoxyReturn}{Returns}
An approximation to the integral. 
\end{DoxyReturn}


Definition at line 106 of file Fn\+Quadrature.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{106                                  \{}
\DoxyCodeLine{107     \textcolor{keywordtype}{double} sum = 0.0;}
\DoxyCodeLine{108     \textcolor{keywordtype}{unsigned} num = NODES.size();}
\DoxyCodeLine{109     \textcolor{keywordtype}{double} h = (B -\/ A) / num;}
\DoxyCodeLine{110     \textcolor{keywordtype}{double} x\_left, x\_right;}
\DoxyCodeLine{111     \textcolor{keywordtype}{double} f\_left, f\_right;}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     x\_left = A;}
\DoxyCodeLine{114     p\_FN(x\_left, f\_left);}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < num; ++i) \{}
\DoxyCodeLine{117       x\_right = A + (i + 1) * h;}
\DoxyCodeLine{118       p\_FN(x\_right, f\_right);}
\DoxyCodeLine{119       sum += (f\_left + f\_right);}
\DoxyCodeLine{120       f\_left = f\_right;}
\DoxyCodeLine{121     \}}
\DoxyCodeLine{122     sum *= h / 2.;}
\DoxyCodeLine{123     \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{124   \}}

\end{DoxyCode}


References h, and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::size().



Referenced by main().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/\textbf{ Fn\+Quadrature.\+h}\item 
src/\textbf{ Fn\+Quadrature.\+cpp}\end{DoxyCompactItemize}
