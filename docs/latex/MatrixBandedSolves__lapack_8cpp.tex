\doxysubsection{Tests/\+Matrix/\+Matrix\+Banded\+Solves\+\_\+lapack.cpp File Reference}
\label{MatrixBandedSolves__lapack_8cpp}\index{Tests/Matrix/MatrixBandedSolves\_lapack.cpp@{Tests/Matrix/MatrixBandedSolves\_lapack.cpp}}
{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$Timer.\+h$>$}\newline
{\ttfamily \#include $<$Types.\+h$>$}\newline
{\ttfamily \#include $<$Utility.\+h$>$}\newline
{\ttfamily \#include $<$Dense\+Linear\+System.\+h$>$}\newline
{\ttfamily \#include $<$Banded\+Linear\+System.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../\+Utils\+\_\+\+Fill.\+h\char`\"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Function Documentation}
\mbox{\label{MatrixBandedSolves__lapack_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{MatrixBandedSolves\_lapack.cpp@{MatrixBandedSolves\_lapack.cpp}!main@{main}}
\index{main@{main}!MatrixBandedSolves\_lapack.cpp@{MatrixBandedSolves\_lapack.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 25 of file Matrix\+Banded\+Solves\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{26 \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{28   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{29   cout << \textcolor{stringliteral}{"=== Matrix: Example linear banded solver  ============\(\backslash\)n"};}
\DoxyCodeLine{30   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{31 }
\DoxyCodeLine{32   \textcolor{keywordtype}{bool} failed = \textcolor{keyword}{false};}
\DoxyCodeLine{33   \textcolor{comment}{// tolerance for the test}}
\DoxyCodeLine{34   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/10;}
\DoxyCodeLine{35 }
\DoxyCodeLine{36   \textcolor{comment}{//}}
\DoxyCodeLine{37   \textcolor{comment}{// SOLVE A BANDED REAL SYSTEM using LAPACK or native}}
\DoxyCodeLine{38   \textcolor{comment}{//}}
\DoxyCodeLine{39   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} offdiag = 2;}
\DoxyCodeLine{40   \textcolor{comment}{// N = size of some of the larger tests}}
\DoxyCodeLine{41   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} N = 511;}
\DoxyCodeLine{42   \textcolor{keyword}{const} \textcolor{keywordtype}{double} D = 12 * ( 1. / ( N -\/ 1 ) ) * ( 1. / ( N -\/ 1 ) );}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   BandedMatrix<double> AB( N, offdiag, 0.0 );}
\DoxyCodeLine{45   DenseVector<double> BB( N, D );}
\DoxyCodeLine{46   Utils\_Fill::fill\_band( AB, 0, -\/30.0 );}
\DoxyCodeLine{47   Utils\_Fill::fill\_band( AB, -\/1, 16.0 );}
\DoxyCodeLine{48   Utils\_Fill::fill\_band( AB, 1, 16.0 );}
\DoxyCodeLine{49   Utils\_Fill::fill\_band( AB, -\/2, -\/1.0 );}
\DoxyCodeLine{50   Utils\_Fill::fill\_band( AB, 2, -\/1.0 );}
\DoxyCodeLine{51   DenseMatrix<double> AD( AB );}
\DoxyCodeLine{52   DenseVector<double> BD( BB );}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   cout << \textcolor{stringliteral}{"     Using dense matrix solver : "} << N << \textcolor{stringliteral}{"x"} << N << \textcolor{stringliteral}{" system \(\backslash\)n"};}
\DoxyCodeLine{55   cout << \textcolor{stringliteral}{"     Using the LAPACK LU dense routine\(\backslash\)n"};}
\DoxyCodeLine{56   DenseLinearSystem<double> dense\_system( \&AD, \&BD, \textcolor{stringliteral}{"lapack"} );}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   \textcolor{keywordflow}{try}}
\DoxyCodeLine{59   \{}
\DoxyCodeLine{60     dense\_system.solve();}
\DoxyCodeLine{61   \}}
\DoxyCodeLine{62   \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{63   \{}
\DoxyCodeLine{64     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{65     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{66   \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   cout << \textcolor{stringliteral}{"  * Not checking.\(\backslash\)n"};}
\DoxyCodeLine{69   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{70   cout << \textcolor{stringliteral}{"     Comparing the banded matrix solver solution : "};}
\DoxyCodeLine{71   cout << N << \textcolor{stringliteral}{"x"} << 2 * AB.noffdiag() + 1 << \textcolor{stringliteral}{" system \(\backslash\)n"};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   cout << \textcolor{stringliteral}{"     Using the LAPACK LU banded routine\(\backslash\)n"};}
\DoxyCodeLine{74   BandedLinearSystem<double> banded\_system( \&AB, \&BB, \textcolor{stringliteral}{"lapack"} );}
\DoxyCodeLine{75 }
\DoxyCodeLine{76   \textcolor{keywordflow}{try}}
\DoxyCodeLine{77   \{}
\DoxyCodeLine{78     banded\_system.solve();}
\DoxyCodeLine{79   \}}
\DoxyCodeLine{80   \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{81   \{}
\DoxyCodeLine{82     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{83     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{84   \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86   BB.sub( BD );}
\DoxyCodeLine{87   \textcolor{keywordflow}{if} ( std::abs( BB.two\_norm() ) > tol )}
\DoxyCodeLine{88   \{}
\DoxyCodeLine{89     failed = \textcolor{keyword}{true};}
\DoxyCodeLine{90     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m * Banded solver does not give same result as dense solver \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{91   \}}
\DoxyCodeLine{92   \textcolor{keywordflow}{else}}
\DoxyCodeLine{93   \{}
\DoxyCodeLine{94     cout << \textcolor{stringliteral}{"     Banded solver agrees with the dense solver.\(\backslash\)n"};}
\DoxyCodeLine{95   \}}
\DoxyCodeLine{96 }
\DoxyCodeLine{97 }
\DoxyCodeLine{98   \textcolor{comment}{//}}
\DoxyCodeLine{99   \textcolor{comment}{// CONCLUDING PASS/FAIL}}
\DoxyCodeLine{100   \textcolor{comment}{//}}
\DoxyCodeLine{101   \textcolor{keywordflow}{if} ( failed )}
\DoxyCodeLine{102   \{}
\DoxyCodeLine{103     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{104     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{105   \}}
\DoxyCodeLine{106   \textcolor{keywordflow}{else}}
\DoxyCodeLine{107   \{}
\DoxyCodeLine{108     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{109     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::failed, Utils\+\_\+\+Fill\+::fill\+\_\+band(), Cpp\+Noddy\+::\+Banded\+Matrix$<$ \+\_\+\+Type $>$\+::noffdiag(), Cpp\+Noddy\+::\+Banded\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve(), Cpp\+Noddy\+::\+Dense\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve(), Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::sub(), and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::two\+\_\+norm().

