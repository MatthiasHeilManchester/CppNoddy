\doxysubsection{Tests/\+E\+V\+P/\+E\+V\+P\+Sparse\+\_\+slepcd.cpp File Reference}
\label{EVPSparse__slepcd_8cpp}\index{Tests/EVP/EVPSparse\_slepcd.cpp@{Tests/EVP/EVPSparse\_slepcd.cpp}}
{\ttfamily \#include $<$Sparse\+Linear\+Eigen\+System.\+h$>$}\newline
{\ttfamily \#include $<$Slepc\+Session.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} (int argc, char $\ast$argv[$\,$])
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solves a 2x2 generalised eigenvalue problem \[ A_{2x2} \,{\underline x}_i = \lambda_i\, B_{2x2}\, {\underline x}_i \] for the 2 eigenvalues $ \lambda_i $, $i=1,2.$. As a test case we use the S\+L\+E\+Pc library. In this case $ A_{2x2} $ and $ B_{2x2} = I $ are such that the eigenvalues are $ 5,\, -1 $. The computation requests eigenvalues that satisfy $ \vert\lambda\vert < 10$. 

\doxysubsubsection{Function Documentation}
\mbox{\label{EVPSparse__slepcd_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{EVPSparse\_slepcd.cpp@{EVPSparse\_slepcd.cpp}!main@{main}}
\index{main@{main}!EVPSparse\_slepcd.cpp@{EVPSparse\_slepcd.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv[$\,$] }\end{DoxyParamCaption})}



Definition at line 18 of file E\+V\+P\+Sparse\+\_\+slepcd.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{19 \{}
\DoxyCodeLine{20 }
\DoxyCodeLine{21   SlepcSession::getInstance(argc,argv);}
\DoxyCodeLine{22 }
\DoxyCodeLine{23   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{24   cout << \textcolor{stringliteral}{"=== EVP: real eigenvalue problem                 ====\(\backslash\)n"};}
\DoxyCodeLine{25   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{26 }
\DoxyCodeLine{27   SparseMatrix<double> a( 2, 2 );}
\DoxyCodeLine{28   SparseMatrix<double> b( 2, 2 );}
\DoxyCodeLine{29   a( 0, 0 ) = 1;}
\DoxyCodeLine{30   a( 0, 1 ) = 2;}
\DoxyCodeLine{31   a( 1, 0 ) = 4;}
\DoxyCodeLine{32   a( 1, 1 ) = 3;}
\DoxyCodeLine{33 }
\DoxyCodeLine{34   b( 0, 0 ) = 1;}
\DoxyCodeLine{35   b( 1, 1 ) = 1;}
\DoxyCodeLine{36 }
\DoxyCodeLine{37   \textcolor{comment}{// a vector for the eigenvalues}}
\DoxyCodeLine{38   DenseVector<D\_complex> lambdas;}
\DoxyCodeLine{39   \textcolor{comment}{// eigenvalues are: 5,-\/1}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41   SparseLinearEigenSystem<double> system( \&a, \&b );}
\DoxyCodeLine{42   \textcolor{keywordflow}{try}}
\DoxyCodeLine{43   \{}
\DoxyCodeLine{44     system.eigensolve();}
\DoxyCodeLine{45   \}}
\DoxyCodeLine{46   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{47   \{}
\DoxyCodeLine{48     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{49     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{50   \}}
\DoxyCodeLine{51 \textcolor{comment}{}}
\DoxyCodeLine{52 \textcolor{comment}{  //// tag any eigenvalues within a distance of 2 of the point 4}}
\DoxyCodeLine{53 \textcolor{comment}{}  system.set\_shift( 4 );}
\DoxyCodeLine{54   system.tag\_eigenvalues\_disc( +1, 2 );}
\DoxyCodeLine{55   \textcolor{comment}{// get those tagged eigenvalues}}
\DoxyCodeLine{56   lambdas = system.get\_tagged\_eigenvalues();}
\DoxyCodeLine{57   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/13;}
\DoxyCodeLine{58   \textcolor{comment}{//lambdas.dump();}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \textcolor{keywordflow}{if} ( std::abs( lambdas[ 0 ] -\/ 5.0 ) < tol )}
\DoxyCodeLine{61   \{}
\DoxyCodeLine{62     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{63     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{64   \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66   cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{67   cout.precision( 12 );}
\DoxyCodeLine{68   cout << \textcolor{stringliteral}{"    Final error = "} << std::abs( lambdas[ 0 ] -\/ 5.0 ) << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{69   lambdas.dump();}
\DoxyCodeLine{70   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{71 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::dump().

