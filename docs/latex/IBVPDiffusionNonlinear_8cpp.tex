\doxysubsection{Tests/\+I\+B\+V\+P/\+I\+B\+V\+P\+Diffusion\+Nonlinear.cpp File Reference}
\label{IBVPDiffusionNonlinear_8cpp}\index{Tests/IBVP/IBVPDiffusionNonlinear.cpp@{Tests/IBVP/IBVPDiffusionNonlinear.cpp}}
{\ttfamily \#include $<$I\+B\+V\+P\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Diffusion\+\_\+equations}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Diffusion\+\_\+left\+\_\+\+BC}
\begin{DoxyCompactList}\small\item\em Define the boundary conditions. \end{DoxyCompactList}\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Diffusion\+\_\+right\+\_\+\+BC}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ U}, 
\textbf{ Ud}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::A} (10.\+0)
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::sigma} (100.\+0)
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solving the unstead diffusion problem\+: \[ U_t - U U_{yy} = -Ae^{-t} sin(\pi y) + ( (1+y) + Ae^{-t} sin(\pi y) )\pi^2 Ae^{-t} sin(\pi y)/\sigma \] with boundary conditions $ U(y=0)=1, U(y=1)=2 $; where $ A=10 $. The initial condition is $ U(y,t=0)=1+y+A sin(\pi y) $. The class constructs and solves the I\+B\+VP using 2nd order finite-\/differencing in both space and time over a non-\/uniform spatial mesh. The output is compared to the exact solution $ U(y,t) = =1+y+A sin(\pi y)e^{-t} $. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{IBVPDiffusionNonlinear_8cpp_a94798fdadfbf49a7c658ace669a1d310}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{U@{U}!IBVPDiffusionNonlinear.cpp@{IBVPDiffusionNonlinear.cpp}}\index{IBVPDiffusionNonlinear.cpp@{IBVPDiffusionNonlinear.cpp}!U@{U}}}\mbox{\label{IBVPDiffusionNonlinear_8cpp_a94798fdadfbf49a7c658ace669a1d310ac461e84f27bbb236874e1011cd66031f}} 
U&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Ud@{Ud}!IBVPDiffusionNonlinear.cpp@{IBVPDiffusionNonlinear.cpp}}\index{IBVPDiffusionNonlinear.cpp@{IBVPDiffusionNonlinear.cpp}!Ud@{Ud}}}\mbox{\label{IBVPDiffusionNonlinear_8cpp_a94798fdadfbf49a7c658ace669a1d310ae3fe7b6f745ea6be7e92f8c854abfb4f}} 
Ud&\\
\hline

\end{DoxyEnumFields}


Definition at line 14 of file I\+B\+V\+P\+Diffusion\+Nonlinear.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{14 \{ U, Ud \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{IBVPDiffusionNonlinear_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{IBVPDiffusionNonlinear.cpp@{IBVPDiffusionNonlinear.cpp}!main@{main}}
\index{main@{main}!IBVPDiffusionNonlinear.cpp@{IBVPDiffusionNonlinear.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 100 of file I\+B\+V\+P\+Diffusion\+Nonlinear.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{101 \{}
\DoxyCodeLine{102   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{103   cout << \textcolor{stringliteral}{"=== IBVP: A nonlinear diffusion problem  ============\(\backslash\)n"};}
\DoxyCodeLine{104   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{105 }
\DoxyCodeLine{106   \textcolor{comment}{// define the system}}
\DoxyCodeLine{107   Example::Diffusion\_equations problem;}
\DoxyCodeLine{108   \textcolor{comment}{// define the boundary conditions}}
\DoxyCodeLine{109   Example::Diffusion\_left\_BC BC\_left;}
\DoxyCodeLine{110   Example::Diffusion\_right\_BC BC\_right;}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   \textcolor{comment}{// domain definition}}
\DoxyCodeLine{113   \textcolor{keywordtype}{double} left = 0.0;}
\DoxyCodeLine{114   \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{115   \textcolor{comment}{// number of (spatial) nodal points}}
\DoxyCodeLine{116   \textcolor{keywordtype}{unsigned} ny = 400;}
\DoxyCodeLine{117   \textcolor{comment}{// time step}}
\DoxyCodeLine{118   \textcolor{keywordtype}{double} dt = 0.005;}
\DoxyCodeLine{119   \textcolor{comment}{// number of time steps}}
\DoxyCodeLine{120   \textcolor{keywordtype}{unsigned} max\_steps = ( unsigned ) ( 2.0 / dt );}
\DoxyCodeLine{121 }
\DoxyCodeLine{122   \textcolor{comment}{// construct our IBVP with more nodes near the boundary}}
\DoxyCodeLine{123   PDE\_IBVP<double> diffusion( \&problem, Utility::power\_node\_vector( left, right, ny, 1.0 ), \&BC\_left, \&BC\_right );}
\DoxyCodeLine{124   \textcolor{comment}{//}}
\DoxyCodeLine{125   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < ny; ++i )}
\DoxyCodeLine{126   \{}
\DoxyCodeLine{127     \textcolor{keywordtype}{double} y( diffusion.solution().coord(i) );}
\DoxyCodeLine{128     diffusion.solution()( i, U ) = (1+y) + Example::A*sin(M\_PI*y);}
\DoxyCodeLine{129     diffusion.solution()( i, Ud ) = 1 + Example::A*M\_PI*cos(M\_PI*y);}
\DoxyCodeLine{130   \}}
\DoxyCodeLine{131 }
\DoxyCodeLine{132   \textcolor{comment}{// set up output details}}
\DoxyCodeLine{133   std::string dirname(\textcolor{stringliteral}{"./DATA"});}
\DoxyCodeLine{134   mkdir( dirname.c\_str(), S\_IRWXU );}
\DoxyCodeLine{135   TrackerFile metric( \textcolor{stringliteral}{"./DATA/IBVP\_diffusion\_metric.dat"} );}
\DoxyCodeLine{136   metric.push\_ptr( \&diffusion.coord(), \textcolor{stringliteral}{"time"} );}
\DoxyCodeLine{137   metric.push\_ptr( \&diffusion.solution()( 0, Ud ), \textcolor{stringliteral}{"y=0 derivative"} );}
\DoxyCodeLine{138   metric.header();}
\DoxyCodeLine{139   TrackerFile profs( \textcolor{stringliteral}{"./DATA/IBVP\_diffusion\_profs.dat"} );}
\DoxyCodeLine{140   profs.push\_ptr( \&diffusion.coord(), \textcolor{stringliteral}{"time"} );}
\DoxyCodeLine{141   profs.push\_ptr( \&diffusion.solution(), \textcolor{stringliteral}{"solution"} );}
\DoxyCodeLine{142   profs.header();}
\DoxyCodeLine{143 }
\DoxyCodeLine{144   Timer timer;}
\DoxyCodeLine{145   timer.start();}
\DoxyCodeLine{146   \textcolor{comment}{//}}
\DoxyCodeLine{147   \textcolor{keywordtype}{double} max\_error( 0.0 );}
\DoxyCodeLine{148   \textcolor{comment}{// time step}}
\DoxyCodeLine{149   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 1; i < max\_steps; ++i )}
\DoxyCodeLine{150   \{}
\DoxyCodeLine{151     \textcolor{comment}{// take a time step}}
\DoxyCodeLine{152     \textcolor{keywordflow}{try}}
\DoxyCodeLine{153     \{}
\DoxyCodeLine{154       diffusion.step2( dt );}
\DoxyCodeLine{155     \}}
\DoxyCodeLine{156     \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{157     \{}
\DoxyCodeLine{158       cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{159       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{160     \}}
\DoxyCodeLine{161     \textcolor{keywordflow}{if} ( i \% 20 == 0 )}
\DoxyCodeLine{162     \{}
\DoxyCodeLine{163       cout << diffusion.coord() << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{164       profs.update();}
\DoxyCodeLine{165       profs.newline();}
\DoxyCodeLine{166     \}}
\DoxyCodeLine{167     timer.counter()++;}
\DoxyCodeLine{168     metric.update();}
\DoxyCodeLine{169     \textcolor{comment}{//}}
\DoxyCodeLine{170     \textcolor{keywordtype}{double} yy( 0.5 );}
\DoxyCodeLine{171     \textcolor{keywordtype}{double} Uexact = 1 + yy + Example::A*exp(-\/diffusion.coord())*sin(M\_PI*yy);}
\DoxyCodeLine{172     \textcolor{keywordtype}{double} error = diffusion.solution().get\_interpolated\_vars( 0.5 )[ U ] -\/ Uexact;}
\DoxyCodeLine{173     max\_error = std::max( std::abs( error ), max\_error );}
\DoxyCodeLine{174     \textcolor{comment}{//}}
\DoxyCodeLine{175     \textcolor{comment}{// std::cout << " ****** " << diffusion.t() << " " << max\_error << "\(\backslash\)n";}}
\DoxyCodeLine{176   \}}
\DoxyCodeLine{177   timer.stop();}
\DoxyCodeLine{178   timer.print();}
\DoxyCodeLine{179   \textcolor{comment}{//}}
\DoxyCodeLine{180   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol( 1.e-\/4 );}
\DoxyCodeLine{181   \textcolor{comment}{// check the BL transpiration vs the known solution}}
\DoxyCodeLine{182   \textcolor{keywordflow}{if} ( max\_error > tol )}
\DoxyCodeLine{183   \{}
\DoxyCodeLine{184     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{185     cout << \textcolor{stringliteral}{" Max difference over time steps = "} << max\_error << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{186     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{187   \}}
\DoxyCodeLine{188   \textcolor{keywordflow}{else}}
\DoxyCodeLine{189   \{}
\DoxyCodeLine{190     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{191     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{192   \}}
\DoxyCodeLine{193 }
\DoxyCodeLine{194 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::\+A(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::coord(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), Cpp\+Noddy\+::\+Timer\+::counter(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+interpolated\+\_\+vars(), Cpp\+Noddy\+::\+Tracker\+File\+::header(), Cpp\+Noddy\+::\+Tracker\+File\+::newline(), Cpp\+Noddy\+::\+Utility\+::power\+\_\+node\+\_\+vector(), Cpp\+Noddy\+::\+Timer\+::print(), Cpp\+Noddy\+::\+Tracker\+File\+::push\+\_\+ptr(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::solution(), Cpp\+Noddy\+::\+Timer\+::start(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::step2(), Cpp\+Noddy\+::\+Timer\+::stop(), U, Ud, and Cpp\+Noddy\+::\+Tracker\+File\+::update().

