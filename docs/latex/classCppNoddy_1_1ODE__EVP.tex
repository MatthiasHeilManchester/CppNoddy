\doxysubsection{Cpp\+Noddy\+::O\+D\+E\+\_\+\+E\+VP$<$ \+\_\+\+Type $>$ Class Template Reference}
\label{classCppNoddy_1_1ODE__EVP}\index{CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}}


A templated object for real/complex vector system of first-\/order ordinary differential equations.  




{\ttfamily \#include $<$O\+D\+E\+\_\+\+E\+V\+P.\+h$>$}

Inheritance diagram for Cpp\+Noddy\+::O\+D\+E\+\_\+\+E\+VP$<$ \+\_\+\+Type $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classCppNoddy_1_1ODE__EVP}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ O\+D\+E\+\_\+\+E\+VP} (\textbf{ Equation\+\_\+2matrix}$<$ \+\_\+\+Type $>$ $\ast$equation\+\_\+ptr, const \textbf{ Dense\+Vector}$<$ double $>$ \&nodes, \textbf{ Residual}$<$ \+\_\+\+Type $>$ $\ast$ptr\+\_\+to\+\_\+left\+\_\+residual, \textbf{ Residual}$<$ \+\_\+\+Type $>$ $\ast$ptr\+\_\+to\+\_\+right\+\_\+residual)
\begin{DoxyCompactList}\small\item\em The class is defined by a vector function for the system. \end{DoxyCompactList}\item 
\textbf{ $\sim$\+O\+D\+E\+\_\+\+E\+VP} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
void \textbf{ eigensolve} ()
\begin{DoxyCompactList}\small\item\em Formulate and solve the global eigenvalue problem for a linear system. \end{DoxyCompactList}\item 
\textbf{ Linear\+Eigen\+System\+\_\+base} $\ast$ \textbf{ p\+\_\+eigensystem} ()
\begin{DoxyCompactList}\small\item\em Allow access to the underlying dense linear eigensystem through a pointer to the private member data. \end{DoxyCompactList}\item 
void \textbf{ add\+\_\+tagged\+\_\+to\+\_\+mesh} ()
\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ get\+\_\+mesh} (const unsigned \&i) const
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
\subsubsection*{template$<$typename \+\_\+\+Type$>$\newline
class Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$}

A templated object for real/complex vector system of first-\/order ordinary differential equations. 

Definition at line 35 of file O\+D\+E\+\_\+\+E\+V\+P.\+h.



\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\label{classCppNoddy_1_1ODE__EVP_a8a4951d42bad7fc9671821728f22a28b}} 
\index{CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}!ODE\_EVP@{ODE\_EVP}}
\index{ODE\_EVP@{ODE\_EVP}!CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}}
\doxyparagraph{ODE\_EVP()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+VP}$<$ \+\_\+\+Type $>$\+::\textbf{ O\+D\+E\+\_\+\+E\+VP} (\begin{DoxyParamCaption}\item[{\textbf{ Equation\+\_\+2matrix}$<$ \+\_\+\+Type $>$ $\ast$}]{equation\+\_\+ptr,  }\item[{const \textbf{ Dense\+Vector}$<$ double $>$ \&}]{nodes,  }\item[{\textbf{ Residual}$<$ \+\_\+\+Type $>$ $\ast$}]{ptr\+\_\+to\+\_\+left\+\_\+residual,  }\item[{\textbf{ Residual}$<$ \+\_\+\+Type $>$ $\ast$}]{ptr\+\_\+to\+\_\+right\+\_\+residual }\end{DoxyParamCaption})}



The class is defined by a vector function for the system. 


\begin{DoxyParams}{Parameters}
{\em equation\+\_\+ptr} & A pointer to an equation with 2 associated matrices; matrix1 will define the eigenvalue problem. \\
\hline
{\em nodes} & A vector of nodal points. \\
\hline
{\em ptr\+\_\+to\+\_\+left\+\_\+residual} & A pointer to a residual object that defines the L\+HS boundary conditions. \\
\hline
{\em ptr\+\_\+to\+\_\+right\+\_\+residual} & A pointer to a residual object that defines the R\+HS boundary conditions. \\
\hline
\end{DoxyParams}


Definition at line 26 of file O\+D\+E\+\_\+\+E\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{29                                                                   :}
\DoxyCodeLine{30     p\_EQUATION(ptr\_to\_equation),}
\DoxyCodeLine{31     p\_LEFT\_RESIDUAL(ptr\_to\_left\_residual),}
\DoxyCodeLine{32     p\_RIGHT\_RESIDUAL(ptr\_to\_right\_residual),}
\DoxyCodeLine{33     NODES(nodes) \{}
\DoxyCodeLine{34     \textcolor{keywordtype}{unsigned} n(nodes.size());}
\DoxyCodeLine{35     \textcolor{keywordtype}{unsigned} order(p\_EQUATION -\/> get\_order());}
\DoxyCodeLine{36     \textcolor{comment}{// first make the dense matrix equivalent of the problem}}
\DoxyCodeLine{37     \textcolor{comment}{// using the Dense( banded ) constructor}}
\DoxyCodeLine{38     p\_A\_DENSE = \textcolor{keyword}{new} DenseMatrix<\_Type>(n * order, n * order, 0.0);}
\DoxyCodeLine{39     p\_B\_DENSE = \textcolor{keyword}{new} DenseMatrix<\_Type>(n * order, n * order, 0.0);}
\DoxyCodeLine{40     \textcolor{comment}{// point the system pointer to the dense problem}}
\DoxyCodeLine{41     p\_SYSTEM = \textcolor{keyword}{new} DenseLinearEigenSystem<\_Type>(p\_A\_DENSE, p\_B\_DENSE);}
\DoxyCodeLine{42   \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::size().

\mbox{\label{classCppNoddy_1_1ODE__EVP_aedc47494e083b883ad168513b840b203}} 
\index{CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}!````~ODE\_EVP@{$\sim$ODE\_EVP}}
\index{````~ODE\_EVP@{$\sim$ODE\_EVP}!CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}}
\doxyparagraph{$\sim$ODE\_EVP()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+VP}$<$ \+\_\+\+Type $>$\+::$\sim$\textbf{ O\+D\+E\+\_\+\+E\+VP}}



Destructor. 



Definition at line 45 of file O\+D\+E\+\_\+\+E\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{45                            \{}
\DoxyCodeLine{46     \textcolor{comment}{// clean up the matrices \& evp system}}
\DoxyCodeLine{47     \textcolor{keyword}{delete} p\_SYSTEM;}
\DoxyCodeLine{48     \textcolor{keyword}{delete} p\_A\_DENSE;}
\DoxyCodeLine{49     \textcolor{keyword}{delete} p\_B\_DENSE;}
\DoxyCodeLine{50   \}}

\end{DoxyCode}


\doxysubsubsection{Member Function Documentation}
\mbox{\label{classCppNoddy_1_1ODE__EVP_a226aa6bacc1e48f42de14327ebcb2e4a}} 
\index{CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}!add\_tagged\_to\_mesh@{add\_tagged\_to\_mesh}}
\index{add\_tagged\_to\_mesh@{add\_tagged\_to\_mesh}!CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}}
\doxyparagraph{add\_tagged\_to\_mesh()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+VP}$<$ \+\_\+\+Type $>$\+::add\+\_\+tagged\+\_\+to\+\_\+mesh (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 60 of file O\+D\+E\+\_\+\+E\+V\+P.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{60                               \{}
\DoxyCodeLine{61       \textcolor{comment}{// clear the existing data if any}}
\DoxyCodeLine{62       MESHES.clear();}
\DoxyCodeLine{63       \textcolor{comment}{// order of the equation}}
\DoxyCodeLine{64       \textcolor{keywordtype}{unsigned} order = p\_EQUATION -\/> get\_order();}
\DoxyCodeLine{65       \textcolor{comment}{// get the eigenvalues}}
\DoxyCodeLine{66       DenseVector<D\_complex> vals(p\_SYSTEM -\/> get\_tagged\_eigenvalues());}
\DoxyCodeLine{67       \textcolor{comment}{// get the eigenvectors}}
\DoxyCodeLine{68       DenseMatrix<D\_complex> vecs(p\_SYSTEM -\/> get\_tagged\_eigenvectors());}
\DoxyCodeLine{69       \textcolor{comment}{// loop through the eigenvectors}}
\DoxyCodeLine{70       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} ivec = 0; ivec < vals.size(); ++ivec) \{}
\DoxyCodeLine{71         \textcolor{comment}{// make a mesh with the right node distribution}}
\DoxyCodeLine{72         \textcolor{comment}{// we'll increase the order by 1 to allow the eigenvalue to be}}
\DoxyCodeLine{73         \textcolor{comment}{// stored at each nodal point -\/-\/ this is wasteful but very useful}}
\DoxyCodeLine{74         \textcolor{comment}{// for feeding this into a BVP for local refinement.}}
\DoxyCodeLine{75         OneD\_Node\_Mesh<D\_complex> eigfn(NODES, order + 1);}
\DoxyCodeLine{76         \textcolor{comment}{// loop through all nodes}}
\DoxyCodeLine{77         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} node = 0; node < NODES.size(); ++node) \{}
\DoxyCodeLine{78           \textcolor{comment}{// complex vector of the dof at this node ( + 1 for the eigenvalue)}}
\DoxyCodeLine{79           DenseVector<D\_complex> vars\_at\_node(order + 1, 0.0);}
\DoxyCodeLine{80           \textcolor{comment}{// get the dof from the eigenvector}}
\DoxyCodeLine{81           \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} var = 0; var < order; ++var) \{}
\DoxyCodeLine{82             vars\_at\_node[ var ] = vecs[ ivec ][ node * order + var ];}
\DoxyCodeLine{83           \}}
\DoxyCodeLine{84           \textcolor{comment}{// the last variable at each node is the corresponding eigenvalue}}
\DoxyCodeLine{85           vars\_at\_node[ order ] = vals[ ivec ];}
\DoxyCodeLine{86           \textcolor{comment}{// set the first 'order' dof to be those from the eigenvector}}
\DoxyCodeLine{87           eigfn.set\_nodes\_vars(node, vars\_at\_node);}
\DoxyCodeLine{88         \}\textcolor{comment}{}}
\DoxyCodeLine{89 \textcolor{comment}{        //// store the eigenvalue in the mesh at each node ... wasteful, but useful}}
\DoxyCodeLine{90 \textcolor{comment}{        //// a complex vector filled with the same value N times}}
\DoxyCodeLine{91 \textcolor{comment}{}        \textcolor{comment}{//DenseVector<D\_complex> c( NODES.size(), vals[ ivec ] );}\textcolor{comment}{}}
\DoxyCodeLine{92 \textcolor{comment}{        //// add it to the mesh -\/-\/ for use in nonlinear local refinement via ODE\_BVP}}
\DoxyCodeLine{93 \textcolor{comment}{}        \textcolor{comment}{//eigfn.push\_var( c );}}
\DoxyCodeLine{94         \textcolor{comment}{// add the eigenfunction to the vector of meshes}}
\DoxyCodeLine{95         MESHES.push\_back(eigfn);}
\DoxyCodeLine{96       \}}
\DoxyCodeLine{97     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::set\+\_\+nodes\+\_\+vars(), and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::size().



Referenced by main(), and Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::\+Neutral\+\_\+residual().

\mbox{\label{classCppNoddy_1_1ODE__EVP_acbff1cbd57fcdf83a15c85ae37839027}} 
\index{CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}!eigensolve@{eigensolve}}
\index{eigensolve@{eigensolve}!CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}}
\doxyparagraph{eigensolve()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+VP}$<$ \+\_\+\+Type $>$\+::eigensolve}



Formulate and solve the global eigenvalue problem for a linear system. 



Definition at line 58 of file O\+D\+E\+\_\+\+E\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{58                                   \{}
\DoxyCodeLine{59     \textcolor{comment}{// NOTE: moving construct\_banded\_system to the constructor is a bad idea, because}}
\DoxyCodeLine{60     \textcolor{comment}{// sometimes we will want to construct an EVP that depends on an}}
\DoxyCodeLine{61     \textcolor{comment}{// underlying baseflow solution that is unknown at the time of construction.}}
\DoxyCodeLine{62     \textcolor{comment}{//}}
\DoxyCodeLine{63     \textcolor{comment}{// construct the banded matrix eigenvalue problem that corresponds}}
\DoxyCodeLine{64     \textcolor{comment}{// to the equation \& boundary conditions specified in the constructor.}}
\DoxyCodeLine{65     assemble\_dense\_problem();}
\DoxyCodeLine{66     \textcolor{comment}{// solve the system}}
\DoxyCodeLine{67     p\_SYSTEM -\/> eigensolve();}
\DoxyCodeLine{68   \}}

\end{DoxyCode}


Referenced by main(), and Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::\+Neutral\+\_\+residual().

\mbox{\label{classCppNoddy_1_1ODE__EVP_a07af715c0124f6eb4290b8ec8187ebcd}} 
\index{CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}!get\_mesh@{get\_mesh}}
\index{get\_mesh@{get\_mesh}!CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}}
\doxyparagraph{get\_mesh()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$\textbf{ D\+\_\+complex}$>$ \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+VP}$<$ \+\_\+\+Type $>$\+::get\+\_\+mesh (\begin{DoxyParamCaption}\item[{const unsigned \&}]{i }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 99 of file O\+D\+E\+\_\+\+E\+V\+P.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{99                                                                 \{}
\DoxyCodeLine{100 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{101       \textcolor{keywordflow}{if}(i > MESHES.size()) \{}
\DoxyCodeLine{102         std::string problem;}
\DoxyCodeLine{103         problem = \textcolor{stringliteral}{"You have tried to extract an eigenfunction from the ODE\_EVP class\(\backslash\)n"};}
\DoxyCodeLine{104         problem += \textcolor{stringliteral}{"whose index is outside the range of stored meshes.\(\backslash\)n"};}
\DoxyCodeLine{105         \textcolor{keywordflow}{throw} ExceptionRange(problem, MESHES.size(), i);}
\DoxyCodeLine{106       \}}
\DoxyCodeLine{107 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{108       \textcolor{keywordflow}{return} MESHES[ i ];}
\DoxyCodeLine{109     \}}

\end{DoxyCode}


Referenced by main(), and Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::\+Neutral\+\_\+residual().

\mbox{\label{classCppNoddy_1_1ODE__EVP_a1674a6e43e4b0881ac2aca1bbd67888a}} 
\index{CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}!p\_eigensystem@{p\_eigensystem}}
\index{p\_eigensystem@{p\_eigensystem}!CppNoddy::ODE\_EVP$<$ \_Type $>$@{CppNoddy::ODE\_EVP$<$ \_Type $>$}}
\doxyparagraph{p\_eigensystem()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Linear\+Eigen\+System\+\_\+base} $\ast$ \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+VP}$<$ \+\_\+\+Type $>$\+::p\+\_\+eigensystem}



Allow access to the underlying dense linear eigensystem through a pointer to the private member data. 



Definition at line 53 of file O\+D\+E\+\_\+\+E\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{53                                                         \{}
\DoxyCodeLine{54     \textcolor{keywordflow}{return} p\_SYSTEM;}
\DoxyCodeLine{55   \}}

\end{DoxyCode}


Referenced by main(), and Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::\+Neutral\+\_\+residual().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/\textbf{ O\+D\+E\+\_\+\+E\+V\+P.\+h}\item 
src/\textbf{ O\+D\+E\+\_\+\+E\+V\+P.\+cpp}\end{DoxyCompactItemize}
