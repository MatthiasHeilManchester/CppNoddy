\doxysubsection{Cpp\+Noddy\+::reversed\+\_\+\+BL$<$ \+\_\+\+Type $>$ Class Template Reference}
\label{classCppNoddy_1_1reversed__BL}\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}


A templated object for real/complex vector system of unsteady equations.  




{\ttfamily \#include $<$reversed\+\_\+\+B\+L.\+h$>$}

Inheritance diagram for Cpp\+Noddy\+::reversed\+\_\+\+BL$<$ \+\_\+\+Type $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classCppNoddy_1_1reversed__BL}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ reversed\+\_\+\+BL} (\textbf{ Equation\+\_\+3matrix}$<$ \+\_\+\+Type $>$ $\ast$equation\+\_\+ptr, const \textbf{ Dense\+Vector}$<$ double $>$ \&xnodes, const \textbf{ Dense\+Vector}$<$ double $>$ \&ynodes, \textbf{ Residual\+\_\+with\+\_\+coords}$<$ \+\_\+\+Type $>$ $\ast$ptr\+\_\+to\+\_\+bottom\+\_\+residual, \textbf{ Residual\+\_\+with\+\_\+coords}$<$ \+\_\+\+Type $>$ $\ast$ptr\+\_\+to\+\_\+top\+\_\+residual)
\begin{DoxyCompactList}\small\item\em The class is defined by a vector function for the system. \end{DoxyCompactList}\item 
\textbf{ $\sim$reversed\+\_\+\+BL} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
void \textbf{ update\+\_\+previous\+\_\+solution} ()
\begin{DoxyCompactList}\small\item\em Copy the current solution to the previous solution. \end{DoxyCompactList}\item 
void \textbf{ step2} (const double \&dt)
\begin{DoxyCompactList}\small\item\em A Crank-\/\+Nicolson \textquotesingle{}time\textquotesingle{} stepper. \end{DoxyCompactList}\item 
void \textbf{ bidirectional\+\_\+step2} (const double \&dt)
\begin{DoxyCompactList}\small\item\em A Crank-\/\+Nicolson \textquotesingle{}time\textquotesingle{} stepper. \end{DoxyCompactList}\item 
double \& \textbf{ t} ()
\begin{DoxyCompactList}\small\item\em Return a reference to the current value of the \textquotesingle{}timelike\textquotesingle{} coordinate. \end{DoxyCompactList}\item 
double \& \textbf{ tolerance} ()
\begin{DoxyCompactList}\small\item\em Return a reference to the convergence tolerance. \end{DoxyCompactList}\item 
\textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type $>$ \& \textbf{ solution} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
\subsubsection*{template$<$typename \+\_\+\+Type$>$\newline
class Cpp\+Noddy\+::reversed\+\_\+\+B\+L$<$ \+\_\+\+Type $>$}

A templated object for real/complex vector system of unsteady equations. 

Definition at line 24 of file reversed\+\_\+\+B\+L.\+h.



\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\label{classCppNoddy_1_1reversed__BL_a65bb63fbde4011cf2c68d6d2f3086997}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!reversed\_BL@{reversed\_BL}}
\index{reversed\_BL@{reversed\_BL}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{reversed\_BL()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::\textbf{ reversed\+\_\+\+BL} (\begin{DoxyParamCaption}\item[{\textbf{ Equation\+\_\+3matrix}$<$ \+\_\+\+Type $>$ $\ast$}]{equation\+\_\+ptr,  }\item[{const \textbf{ Dense\+Vector}$<$ double $>$ \&}]{xnodes,  }\item[{const \textbf{ Dense\+Vector}$<$ double $>$ \&}]{ynodes,  }\item[{\textbf{ Residual\+\_\+with\+\_\+coords}$<$ \+\_\+\+Type $>$ $\ast$}]{ptr\+\_\+to\+\_\+bottom\+\_\+residual,  }\item[{\textbf{ Residual\+\_\+with\+\_\+coords}$<$ \+\_\+\+Type $>$ $\ast$}]{ptr\+\_\+to\+\_\+top\+\_\+residual }\end{DoxyParamCaption})}



The class is defined by a vector function for the system. 


\begin{DoxyParams}{Parameters}
{\em equation\+\_\+ptr} & A pointer to an inherited \doxyref{Equation}{p.}{classCppNoddy_1_1Equation} object. \\
\hline
{\em xnodes} & A vector that defines the nodal x-\/positions. \\
\hline
{\em ynodes} & A vector that defines the nodal y-\/positions. \\
\hline
{\em ptr\+\_\+to\+\_\+bottom\+\_\+residual} & A pointer to a residual object that defines the y=y1 boundary conditions. \\
\hline
{\em ptr\+\_\+to\+\_\+top\+\_\+residual} & A pointer to a residual object that defines the y=y2 boundary conditions. \\
\hline
\end{DoxyParams}


Definition at line 17 of file reversed\+\_\+\+B\+L.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{22                                                       :}
\DoxyCodeLine{23     TOL(1.e-\/8),}
\DoxyCodeLine{24     T(0.0),}
\DoxyCodeLine{25     MAX\_ITERATIONS(30),}
\DoxyCodeLine{26     p\_EQUATION(ptr\_to\_equation),}
\DoxyCodeLine{27     p\_BOTTOM\_RESIDUAL(ptr\_to\_bottom\_residual),}
\DoxyCodeLine{28     p\_TOP\_RESIDUAL(ptr\_to\_top\_residual),}
\DoxyCodeLine{29     UPDATED(\textcolor{keyword}{false}) \{}
\DoxyCodeLine{30     \textcolor{comment}{// create the 2D mesh for the current time level and previous time level}}
\DoxyCodeLine{31     SOLN = TwoD\_Node\_Mesh<\_Type>(xnodes, ynodes, p\_EQUATION -\/> get\_order());}
\DoxyCodeLine{32     \textcolor{comment}{// copy construct the previous solution's storage}}
\DoxyCodeLine{33     PREV\_SOLN = SOLN;}
\DoxyCodeLine{34     \textcolor{comment}{// initialise the eqn object}}
\DoxyCodeLine{35     p\_EQUATION -\/> coord(2) = xnodes[0];}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{37     \textcolor{comment}{// timers}}
\DoxyCodeLine{38     T\_ASSEMBLE = Timer(\textcolor{stringliteral}{"Assembling of the matrix (incl. equation updates):"});}
\DoxyCodeLine{39     T\_SOLVE = Timer(\textcolor{stringliteral}{"Solving of the matrix:"});}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{41   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1reversed__BL_acfa7e3a3296734ec60df6ffc7410c77a}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!````~reversed\_BL@{$\sim$reversed\_BL}}
\index{````~reversed\_BL@{$\sim$reversed\_BL}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{$\sim$reversed\_BL()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::$\sim$\textbf{ reversed\+\_\+\+BL}}



Destructor. 



Definition at line 44 of file reversed\+\_\+\+B\+L.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{44                                    \{}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{46     std::cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{47     T\_ASSEMBLE.stop();}
\DoxyCodeLine{48     T\_ASSEMBLE.print();}
\DoxyCodeLine{49     T\_SOLVE.stop();}
\DoxyCodeLine{50     T\_SOLVE.print();}
\DoxyCodeLine{51 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{52   \}}

\end{DoxyCode}


\doxysubsubsection{Member Function Documentation}
\mbox{\label{classCppNoddy_1_1reversed__BL_acfa8eb6e5c1fe6811fa772eaa88f25ca}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!bidirectional\_step2@{bidirectional\_step2}}
\index{bidirectional\_step2@{bidirectional\_step2}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{bidirectional\_step2()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::bidirectional\+\_\+step2 (\begin{DoxyParamCaption}\item[{const double \&}]{dt }\end{DoxyParamCaption})}



A Crank-\/\+Nicolson \textquotesingle{}time\textquotesingle{} stepper. 



Definition at line 141 of file reversed\+\_\+\+B\+L.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{141                                                                \{}
\DoxyCodeLine{142     DT = dt;}
\DoxyCodeLine{143     \textcolor{keywordflow}{if}(!UPDATED) \{}
\DoxyCodeLine{144       std::string problem;}
\DoxyCodeLine{145       problem = \textcolor{stringliteral}{" You have called the reversed\_BL::bidirectional\_step2 method without calling\(\backslash\)n"};}
\DoxyCodeLine{146       problem += \textcolor{stringliteral}{" the reversed\_BL::update\_previous\_solution method first. This\(\backslash\)n"};}
\DoxyCodeLine{147       problem += \textcolor{stringliteral}{" method is required to copy/store the previous time level's solution\(\backslash\)n"};}
\DoxyCodeLine{148       problem += \textcolor{stringliteral}{" and then allow you to specify/alter the x-\/initial condition by\(\backslash\)n"};}
\DoxyCodeLine{149       problem += \textcolor{stringliteral}{" for the current time level."};}
\DoxyCodeLine{150       \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{151     \}}
\DoxyCodeLine{152     \textcolor{comment}{// the order of the problem}}
\DoxyCodeLine{153     \textcolor{keywordtype}{unsigned} order(p\_EQUATION -\/> get\_order());}
\DoxyCodeLine{154     \textcolor{comment}{// get the number of nodes in the mesh}}
\DoxyCodeLine{155     \textcolor{comment}{// -\/-\/ this may have been refined by the user since the last call.}}
\DoxyCodeLine{156     \textcolor{keywordtype}{unsigned} nx(SOLN.get\_nnodes().first);}
\DoxyCodeLine{157     \textcolor{keywordtype}{unsigned} ny(SOLN.get\_nnodes().second);}
\DoxyCodeLine{158     \textcolor{comment}{// measure of maximum residual}}
\DoxyCodeLine{159     \textcolor{keywordtype}{double} max\_residual(1.0);}
\DoxyCodeLine{160     \textcolor{comment}{// the current solution moves to the previous solution}}
\DoxyCodeLine{161     \textcolor{comment}{// ANY LARGE STORAGE USED IN THE MAIN LOOP IS}}
\DoxyCodeLine{162     \textcolor{comment}{// DEFINED HERE TO AVOID REPEATED CONSTRUCTION.}}
\DoxyCodeLine{163     \textcolor{comment}{// Note we blank the A matrix after every iteration.}}
\DoxyCodeLine{164     \textcolor{comment}{//}}
\DoxyCodeLine{165     \textcolor{comment}{// Banded LHS matrix -\/ max obove diagonal band width is}}
\DoxyCodeLine{166     \textcolor{comment}{// from first variable at node i to last variable at node i+1}}
\DoxyCodeLine{167     BandedMatrix<\_Type> a(ny * order, 2 * order -\/ 1, 0.0);}
\DoxyCodeLine{168     \textcolor{comment}{// RHS}}
\DoxyCodeLine{169     DenseVector<\_Type> b(ny * order, 0.0);}
\DoxyCodeLine{170     \textcolor{comment}{// linear solver definition}}
\DoxyCodeLine{171 \textcolor{preprocessor}{\#ifdef LAPACK}}
\DoxyCodeLine{172     BandedLinearSystem<\_Type> system(\&a, \&b, \textcolor{stringliteral}{"lapack"});}
\DoxyCodeLine{173 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{174     BandedLinearSystem<\_Type> system(\&a, \&b, \textcolor{stringliteral}{"native"});}
\DoxyCodeLine{175 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{176     \textcolor{comment}{// which node did convergence fail?}}
\DoxyCodeLine{177     \textcolor{keywordtype}{unsigned} jfail = 0;}
\DoxyCodeLine{178     \textcolor{comment}{// step from j=0 to j=nx-\/3 ... at each we assemble and solve for j+1}}
\DoxyCodeLine{179     \textcolor{comment}{// which covers the positions j=1,2,...,nx-\/2. Note that the solution}}
\DoxyCodeLine{180     \textcolor{comment}{// at j=0 and nx-\/1 are defined in the bidirectional problem.}}
\DoxyCodeLine{181     \textcolor{keywordflow}{for}(std::size\_t j = 0; j < nx -\/ 2; ++j) \{\textcolor{comment}{}}
\DoxyCodeLine{182 \textcolor{comment}{      //// next x-\/soln guess is the previous x-\/soln}}
\DoxyCodeLine{183 \textcolor{comment}{}      \textcolor{comment}{//for ( std::size\_t i = 0; i < ny; ++i )}}
\DoxyCodeLine{184       \textcolor{comment}{//\{}}
\DoxyCodeLine{185       \textcolor{comment}{//for ( std::size\_t var = 0; var < order; ++var )}}
\DoxyCodeLine{186       \textcolor{comment}{//\{}}
\DoxyCodeLine{187       \textcolor{comment}{//SOLN( j + 1, i, var ) = SOLN( j, i, var );}}
\DoxyCodeLine{188       \textcolor{comment}{//\}}}
\DoxyCodeLine{189       \textcolor{comment}{//\}}}
\DoxyCodeLine{190       \textcolor{comment}{// iteration counter}}
\DoxyCodeLine{191       \textcolor{keywordtype}{int} counter = 0;}
\DoxyCodeLine{192       \textcolor{comment}{// loop until converged or too many iterations}}
\DoxyCodeLine{193       \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{194         \textcolor{comment}{// iteration counter}}
\DoxyCodeLine{195         ++counter;}
\DoxyCodeLine{196         \textcolor{comment}{// time the assemble phase}}
\DoxyCodeLine{197 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{198         T\_ASSEMBLE.start();}
\DoxyCodeLine{199 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{200         \textcolor{comment}{// *** hardwired velocity direction/shear hackery}}
\DoxyCodeLine{201         \textcolor{comment}{//  if ( SOLN( j+2, 0, 2) > 0.0 )}}
\DoxyCodeLine{202 }
\DoxyCodeLine{203         \textcolor{keywordtype}{bool} reversed(\textcolor{keyword}{false});}
\DoxyCodeLine{204         \textcolor{keywordflow}{if}(SOLN(j+2, 0, 2) < 0.0) \{}
\DoxyCodeLine{205           reversed = \textcolor{keyword}{true};}
\DoxyCodeLine{206         \}}
\DoxyCodeLine{207 }
\DoxyCodeLine{208         \textcolor{keywordflow}{if}(!reversed) \{}
\DoxyCodeLine{209           assemble\_matrix\_problem(a, b, j);}
\DoxyCodeLine{210         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{211 }
\DoxyCodeLine{212           \textcolor{comment}{//std::cout << SOLN.coord(j+2,0).first << " Reversed \(\backslash\)n";}}
\DoxyCodeLine{213           bidirectional\_assemble\_matrix\_problem(a, b, j);}
\DoxyCodeLine{214         \}}
\DoxyCodeLine{215         max\_residual = b.inf\_norm();}
\DoxyCodeLine{216 \textcolor{preprocessor}{\#ifdef DEBUG}}
\DoxyCodeLine{217         std::cout.precision(12);}
\DoxyCodeLine{218         std::cout << \textcolor{stringliteral}{" reversed\_BL.bidirectional\_step2 : x\_j = "} << SOLN.coord(j,0).first << \textcolor{stringliteral}{" Residual\_max = "} << max\_residual << \textcolor{stringliteral}{" tol = "} << TOL << \textcolor{stringliteral}{" counter = "} << counter << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{219 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{220 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{221         T\_ASSEMBLE.stop();}
\DoxyCodeLine{222         T\_SOLVE.start();}
\DoxyCodeLine{223 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{224         jfail = j;}
\DoxyCodeLine{225         \textcolor{comment}{// linear solver}}
\DoxyCodeLine{226         system.solve();}
\DoxyCodeLine{227         \textcolor{comment}{// write the solution back into the TwoD\_Node\_Mesh object}}
\DoxyCodeLine{228         \textcolor{keywordflow}{for}(std::size\_t i = 0; i < ny; ++i) \{}
\DoxyCodeLine{229           \textcolor{keywordflow}{for}(std::size\_t var = 0; var < order; ++var) \{}
\DoxyCodeLine{230             SOLN(j + 1, i, var) += b[ i * order + var ];}
\DoxyCodeLine{231           \}}
\DoxyCodeLine{232         \}}
\DoxyCodeLine{233 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{234         T\_SOLVE.stop();}
\DoxyCodeLine{235 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{236       \} \textcolor{keywordflow}{while}((max\_residual > TOL) \&\& (counter < MAX\_ITERATIONS));}
\DoxyCodeLine{237       \textcolor{keywordflow}{if}(counter >= MAX\_ITERATIONS) \{}
\DoxyCodeLine{238         std::cout << \textcolor{stringliteral}{" reversed\_BL.bidirectional\_step2 : x\_j = "} << SOLN.coord(jfail,0).first << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{239         std::string problem(\textcolor{stringliteral}{"\(\backslash\)n The reversed\_BL.bidirectional\_step2 method took too many iterations. \(\backslash\)n"});}
\DoxyCodeLine{240         \textcolor{keywordflow}{throw} ExceptionItn(problem, counter, max\_residual);}
\DoxyCodeLine{241       \}}
\DoxyCodeLine{242     \}}
\DoxyCodeLine{243     \textcolor{comment}{// set the time to the updated level}}
\DoxyCodeLine{244     T += DT;}
\DoxyCodeLine{245 \textcolor{preprocessor}{\#ifdef DEBUG}}
\DoxyCodeLine{246     std::cout << \textcolor{stringliteral}{"[DEBUG] solved at t = "} << T << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{247 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{248     UPDATED = \textcolor{keyword}{false};}
\DoxyCodeLine{249   \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::inf\+\_\+norm(), and Cpp\+Noddy\+::\+Banded\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve().

\mbox{\label{classCppNoddy_1_1reversed__BL_a079c9e562f05ea1f53acd7d65f88cf0f}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!solution@{solution}}
\index{solution@{solution}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{solution()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type $>$ \& \textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::solution\hspace{0.3cm}{\ttfamily [inline]}}

\begin{DoxyReturn}{Returns}
A handle to the solution mesh 
\end{DoxyReturn}


Definition at line 113 of file reversed\+\_\+\+B\+L.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{113                                                              \{}
\DoxyCodeLine{114     \textcolor{keywordflow}{return} SOLN;}
\DoxyCodeLine{115   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1reversed__BL_ab1d4bab7777f3e62c78ff2b7c6d656dc}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!step2@{step2}}
\index{step2@{step2}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{step2()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::step2 (\begin{DoxyParamCaption}\item[{const double \&}]{dt }\end{DoxyParamCaption})}



A Crank-\/\+Nicolson \textquotesingle{}time\textquotesingle{} stepper. 



Definition at line 55 of file reversed\+\_\+\+B\+L.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{55                                                  \{}
\DoxyCodeLine{56     DT = dt;}
\DoxyCodeLine{57     \textcolor{keywordflow}{if}(!UPDATED) \{}
\DoxyCodeLine{58       std::string problem;}
\DoxyCodeLine{59       problem = \textcolor{stringliteral}{" You have called the reversed\_BL::step2 method without calling\(\backslash\)n"};}
\DoxyCodeLine{60       problem += \textcolor{stringliteral}{" the reversed\_BL::update\_previous\_solution method first. This\(\backslash\)n"};}
\DoxyCodeLine{61       problem += \textcolor{stringliteral}{" method is required to copy/store the previous time level's solution\(\backslash\)n"};}
\DoxyCodeLine{62       problem += \textcolor{stringliteral}{" and then allow you to specify/alter the x-\/initial condition by\(\backslash\)n"};}
\DoxyCodeLine{63       problem += \textcolor{stringliteral}{" for the current time level."};}
\DoxyCodeLine{64       \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{65     \}}
\DoxyCodeLine{66     \textcolor{comment}{// the order of the problem}}
\DoxyCodeLine{67     \textcolor{keywordtype}{unsigned} order(p\_EQUATION -\/> get\_order());}
\DoxyCodeLine{68     \textcolor{comment}{// get the number of nodes in the mesh}}
\DoxyCodeLine{69     \textcolor{comment}{// -\/-\/ this may have been refined by the user since the last call.}}
\DoxyCodeLine{70     \textcolor{keywordtype}{unsigned} nx(SOLN.get\_nnodes().first);}
\DoxyCodeLine{71     \textcolor{keywordtype}{unsigned} ny(SOLN.get\_nnodes().second);}
\DoxyCodeLine{72     \textcolor{comment}{// measure of maximum residual}}
\DoxyCodeLine{73     \textcolor{keywordtype}{double} max\_residual(1.0);}
\DoxyCodeLine{74     \textcolor{comment}{// the current solution moves to the previous solution}}
\DoxyCodeLine{75     \textcolor{comment}{// ANY LARGE STORAGE USED IN THE MAIN LOOP IS}}
\DoxyCodeLine{76     \textcolor{comment}{// DEFINED HERE TO AVOID REPEATED CONSTRUCTION.}}
\DoxyCodeLine{77     \textcolor{comment}{// Note we blank the A matrix after every iteration.}}
\DoxyCodeLine{78     \textcolor{comment}{//}}
\DoxyCodeLine{79     \textcolor{comment}{// Banded LHS matrix -\/ max obove diagonal band width is}}
\DoxyCodeLine{80     \textcolor{comment}{// from first variable at node i to last variable at node i+1}}
\DoxyCodeLine{81     BandedMatrix<\_Type> a(ny * order, 2 * order -\/ 1, 0.0);}
\DoxyCodeLine{82     \textcolor{comment}{// RHS}}
\DoxyCodeLine{83     DenseVector<\_Type> b(ny * order, 0.0);}
\DoxyCodeLine{84     \textcolor{comment}{// linear solver definition}}
\DoxyCodeLine{85 \textcolor{preprocessor}{\#ifdef LAPACK}}
\DoxyCodeLine{86     BandedLinearSystem<\_Type> system(\&a, \&b, \textcolor{stringliteral}{"lapack"});}
\DoxyCodeLine{87 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{88     BandedLinearSystem<\_Type> system(\&a, \&b, \textcolor{stringliteral}{"native"});}
\DoxyCodeLine{89 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{90     \textcolor{keywordtype}{unsigned} jfail = 0;}
\DoxyCodeLine{91     \textcolor{keywordflow}{for}(std::size\_t j = 0; j < nx -\/ 1; ++j) \{}
\DoxyCodeLine{92       \textcolor{comment}{// iteration counter}}
\DoxyCodeLine{93       \textcolor{keywordtype}{int} counter = 0;}
\DoxyCodeLine{94       \textcolor{comment}{// loop until converged or too many iterations}}
\DoxyCodeLine{95       \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{96         \textcolor{comment}{// iteration counter}}
\DoxyCodeLine{97         ++counter;}
\DoxyCodeLine{98         \textcolor{comment}{// time the assemble phase}}
\DoxyCodeLine{99 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{100         T\_ASSEMBLE.start();}
\DoxyCodeLine{101 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{102         assemble\_matrix\_problem(a, b, j);}
\DoxyCodeLine{103         max\_residual = b.inf\_norm();}
\DoxyCodeLine{104 \textcolor{preprocessor}{\#ifdef DEBUG}}
\DoxyCodeLine{105         std::cout.precision(12);}
\DoxyCodeLine{106         std::cout << \textcolor{stringliteral}{" reversed\_BL.step2 : x\_j = "} << SOLN.coord(j,0).first << \textcolor{stringliteral}{" Residual\_max = "} << max\_residual << \textcolor{stringliteral}{" tol = "} << TOL << \textcolor{stringliteral}{" counter = "} << counter << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{107 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{108 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{109         T\_ASSEMBLE.stop();}
\DoxyCodeLine{110         T\_SOLVE.start();}
\DoxyCodeLine{111 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{112         jfail = j;}
\DoxyCodeLine{113         \textcolor{comment}{// linear solver}}
\DoxyCodeLine{114         system.solve();}
\DoxyCodeLine{115         \textcolor{comment}{// keep the solution in a OneD\_GenMesh object}}
\DoxyCodeLine{116         \textcolor{keywordflow}{for}(std::size\_t i = 0; i < ny; ++i) \{}
\DoxyCodeLine{117           \textcolor{keywordflow}{for}(std::size\_t var = 0; var < order; ++var) \{}
\DoxyCodeLine{118             SOLN(j + 1, i, var) += b[ i * order + var ];}
\DoxyCodeLine{119           \}}
\DoxyCodeLine{120         \}}
\DoxyCodeLine{121 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{122         T\_SOLVE.stop();}
\DoxyCodeLine{123 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{124       \} \textcolor{keywordflow}{while}((max\_residual > TOL) \&\& (counter < MAX\_ITERATIONS));}
\DoxyCodeLine{125       \textcolor{keywordflow}{if}(counter >= MAX\_ITERATIONS) \{}
\DoxyCodeLine{126         std::cout << \textcolor{stringliteral}{" reversed\_BL.step2 : x\_j = "} << SOLN.coord(jfail,0).first << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{127         std::string problem(\textcolor{stringliteral}{"\(\backslash\)n The reversed\_BL.step2 method took too many iterations. \(\backslash\)n"});}
\DoxyCodeLine{128         \textcolor{keywordflow}{throw} ExceptionItn(problem, counter, max\_residual);}
\DoxyCodeLine{129       \}}
\DoxyCodeLine{130     \}}
\DoxyCodeLine{131     \textcolor{comment}{// set the time to the updated level}}
\DoxyCodeLine{132     T += DT;}
\DoxyCodeLine{133 \textcolor{preprocessor}{\#ifdef DEBUG}}
\DoxyCodeLine{134     std::cout << \textcolor{stringliteral}{"[DEBUG] solved at t = "} << T << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{135 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{136     UPDATED = \textcolor{keyword}{false};}
\DoxyCodeLine{137   \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::inf\+\_\+norm(), and Cpp\+Noddy\+::\+Banded\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve().

\mbox{\label{classCppNoddy_1_1reversed__BL_a2393a750e7c6b959b64cd2112a7ce9a9}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!t@{t}}
\index{t@{t}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{t()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
double \& \textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::t\hspace{0.3cm}{\ttfamily [inline]}}



Return a reference to the current value of the \textquotesingle{}timelike\textquotesingle{} coordinate. 

\begin{DoxyReturn}{Returns}
A handle to the current timelinke coordinate stored in the object 
\end{DoxyReturn}


Definition at line 118 of file reversed\+\_\+\+B\+L.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{118                                        \{}
\DoxyCodeLine{119     \textcolor{keywordflow}{return} T;}
\DoxyCodeLine{120   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1reversed__BL_a67e3a1b6fdee6aee462b0feed4c0f3f6}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!tolerance@{tolerance}}
\index{tolerance@{tolerance}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{tolerance()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
double\& \textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::tolerance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Return a reference to the convergence tolerance. 



Definition at line 59 of file reversed\+\_\+\+B\+L.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{59                         \{}
\DoxyCodeLine{60       \textcolor{keywordflow}{return} TOL;}
\DoxyCodeLine{61     \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1reversed__BL_a38daa0e0b08169ef3945d69ba43e7fa9}} 
\index{CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}!update\_previous\_solution@{update\_previous\_solution}}
\index{update\_previous\_solution@{update\_previous\_solution}!CppNoddy::reversed\_BL$<$ \_Type $>$@{CppNoddy::reversed\_BL$<$ \_Type $>$}}
\doxyparagraph{update\_previous\_solution()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::reversed\+\_\+\+BL}$<$ \+\_\+\+Type $>$\+::update\+\_\+previous\+\_\+solution (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Copy the current solution to the previous solution. 



Definition at line 43 of file reversed\+\_\+\+B\+L.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{43                                     \{}
\DoxyCodeLine{44       PREV\_SOLN = SOLN;}
\DoxyCodeLine{45       UPDATED = \textcolor{keyword}{true};}
\DoxyCodeLine{46     \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/\textbf{ reversed\+\_\+\+B\+L.\+h}\item 
src/\textbf{ reversed\+\_\+\+B\+L.\+cpp}\end{DoxyCompactItemize}
