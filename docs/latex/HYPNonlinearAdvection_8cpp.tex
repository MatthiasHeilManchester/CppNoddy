\doxysubsection{Tests/\+H\+Y\+P\+\_\+1\+D/\+H\+Y\+P\+Nonlinear\+Advection.cpp File Reference}
\label{HYPNonlinearAdvection_8cpp}\index{Tests/HYP\_1D/HYPNonlinearAdvection.cpp@{Tests/HYP\_1D/HYPNonlinearAdvection.cpp}}
{\ttfamily \#include $<$One\+D\+\_\+\+H\+Y\+P\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Nlin\+Adv}
\begin{DoxyCompactList}\small\item\em Define the system. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \textbf{ Cpp\+Noddy\+::\+Example\+::\+Q\+\_\+init} (const double \&x, \textbf{ Dense\+Vector}$<$ double $>$ \&q)
\begin{DoxyCompactList}\small\item\em Set the initial state of the system. \end{DoxyCompactList}\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solving the 1D `nonlinear advection equation' \[ Q_t + \left ( \frac{Q^2}{2} \right )_x = 0 \quad \mbox{where} \quad Q=Q(x,t) \] using a T\+VD Lax-\/\+Friedrichs scheme for $ x\in[0,1]$. The initial condition is taken to be \[ Q(x,0) = \sin( 2\pi x ) \] The test is simply conservation of $ Q $ in this case. 

\doxysubsubsection{Function Documentation}
\mbox{\label{HYPNonlinearAdvection_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{HYPNonlinearAdvection.cpp@{HYPNonlinearAdvection.cpp}!main@{main}}
\index{main@{main}!HYPNonlinearAdvection.cpp@{HYPNonlinearAdvection.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 72 of file H\+Y\+P\+Nonlinear\+Advection.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{73 \{}
\DoxyCodeLine{74   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{75   cout << \textcolor{stringliteral}{"=== Hyperbolic: 1D nonlinear advection equation  ====\(\backslash\)n"};}
\DoxyCodeLine{76   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   \textcolor{comment}{// define the domain/mesh}}
\DoxyCodeLine{79   \textcolor{keyword}{const} \textcolor{keywordtype}{double} left =  0.0;}
\DoxyCodeLine{80   \textcolor{keyword}{const} \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{81   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} N = 141;}
\DoxyCodeLine{82   DenseVector<double> faces\_x = Utility::uniform\_node\_vector( left, right, N );}
\DoxyCodeLine{83 }
\DoxyCodeLine{84   \textcolor{keywordtype}{double} t = 0.0;}
\DoxyCodeLine{85 }
\DoxyCodeLine{86   Example::NlinAdv conservative\_problem;}
\DoxyCodeLine{87   OneD\_TVDLF\_Mesh NlinAdv\_mesh( faces\_x, \&conservative\_problem, Example::Q\_init );}
\DoxyCodeLine{88   NlinAdv\_mesh.set\_limiter( 0 );}
\DoxyCodeLine{89 }
\DoxyCodeLine{90   \textcolor{keywordtype}{double} I1 = NlinAdv\_mesh.integrate()[0];}
\DoxyCodeLine{91   \textcolor{keywordtype}{int} loop\_counter( 5 );}
\DoxyCodeLine{92 }
\DoxyCodeLine{93   std::string dirname(\textcolor{stringliteral}{"./DATA"});}
\DoxyCodeLine{94   mkdir( dirname.c\_str(), S\_IRWXU );}
\DoxyCodeLine{95   TrackerFile my\_file( \textcolor{stringliteral}{"./DATA/HYP\_NlinAdv.dat"} );}
\DoxyCodeLine{96   \textcolor{comment}{// first column of the output will always be the time}}
\DoxyCodeLine{97   my\_file.push\_ptr( \&t, \textcolor{stringliteral}{"time"} );}
\DoxyCodeLine{98   OneD\_Node\_Mesh<double> soln = NlinAdv\_mesh.get\_soln();}
\DoxyCodeLine{99   my\_file.push\_ptr( \&soln, \textcolor{stringliteral}{"mesh"} );}
\DoxyCodeLine{100 }
\DoxyCodeLine{101   \textcolor{keywordtype}{double} asym( 0.0 );}
\DoxyCodeLine{102   \textcolor{keywordflow}{do}}
\DoxyCodeLine{103   \{}
\DoxyCodeLine{104     \textcolor{keywordtype}{double} dt = NlinAdv\_mesh.update( 0.475 );}
\DoxyCodeLine{105     t += dt;}
\DoxyCodeLine{106     soln = NlinAdv\_mesh.get\_soln();}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{keywordflow}{if} ( loop\_counter \% 10 == 0 )}
\DoxyCodeLine{109     \{}
\DoxyCodeLine{110       soln = NlinAdv\_mesh.get\_soln();}
\DoxyCodeLine{111       my\_file.update();}
\DoxyCodeLine{112       my\_file.newline();}
\DoxyCodeLine{113     \}}
\DoxyCodeLine{114     ++loop\_counter;}
\DoxyCodeLine{115     asym = std::max( asym, std::abs( soln.get\_interpolated\_vars( 0.75 )[0] + soln.get\_interpolated\_vars( 0.25 )[0] ) );}
\DoxyCodeLine{116   \}}
\DoxyCodeLine{117   \textcolor{keywordflow}{while} ( ( t < 0.4 ) \&\& ( loop\_counter < 1000 ) );}
\DoxyCodeLine{118 }
\DoxyCodeLine{119   \textcolor{keywordtype}{double} I2 = NlinAdv\_mesh.integrate()[0];}
\DoxyCodeLine{120   soln = NlinAdv\_mesh.get\_soln();}
\DoxyCodeLine{121   my\_file.update();}
\DoxyCodeLine{122   my\_file.newline();}
\DoxyCodeLine{123   \textcolor{comment}{// problem should be antisymmetric about x = 1/2}}
\DoxyCodeLine{124   \textcolor{keywordflow}{if} ( ( asym > 1.e-\/10 ) || ( std::abs( I1 -\/ I2 ) > 1.e-\/8 ) || ( loop\_counter >= 1000 ) )}
\DoxyCodeLine{125   \{}
\DoxyCodeLine{126     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{127     cout << \textcolor{stringliteral}{"asymmetry = "} << asym << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{128     cout << \textcolor{stringliteral}{"integral difference = "} << I1 -\/ I2 << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{129     cout << \textcolor{stringliteral}{"loop counter = "} << loop\_counter << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{130     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{131   \}}
\DoxyCodeLine{132   \textcolor{keywordflow}{else}}
\DoxyCodeLine{133   \{}
\DoxyCodeLine{134     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{135     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{136   \}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \} \textcolor{comment}{// end of main()}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+interpolated\+\_\+vars(), Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::get\+\_\+soln(), Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::integrate(), Cpp\+Noddy\+::\+Tracker\+File\+::newline(), Cpp\+Noddy\+::\+Tracker\+File\+::push\+\_\+ptr(), Cpp\+Noddy\+::\+Example\+::\+Q\+\_\+init(), Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::set\+\_\+limiter(), Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector(), Cpp\+Noddy\+::\+Tracker\+File\+::update(), and Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::update().

