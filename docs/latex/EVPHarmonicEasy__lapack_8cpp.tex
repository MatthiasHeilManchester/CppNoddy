\doxysubsection{Tests/\+E\+V\+P/\+E\+V\+P\+Harmonic\+Easy\+\_\+lapack.cpp File Reference}
\label{EVPHarmonicEasy__lapack_8cpp}\index{Tests/EVP/EVPHarmonicEasy\_lapack.cpp@{Tests/EVP/EVPHarmonicEasy\_lapack.cpp}}
{\ttfamily \#include $<$E\+V\+P\+\_\+bundle.\+h$>$}\newline
{\ttfamily \#include $<$Utility.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../\+Utils\+\_\+\+Fill.\+h\char`\"{}}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::harmonic\+\_\+equation}
\begin{DoxyCompactList}\small\item\em Define the harmonic equation by inheriting the \doxyref{Equation}{p.}{classCppNoddy_1_1Equation} base class. \end{DoxyCompactList}\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::harmonic\+\_\+both\+\_\+\+BC}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ f}, 
\textbf{ fd}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solves the harmonic equation \[ f\textnormal{\textquotesingle}\textnormal{\textquotesingle}(x) + \lambda f(x) = 0 \] as an eigenvalue problem for $ \lambda $ over the unit domain with homogeneous boundary conditions for $ f(x) $, returning the smallest eigenvalue. This is the \textquotesingle{}easy\textquotesingle{} approach, using the O\+D\+E\+\_\+\+E\+VP class which is constructed from an Equation\+\_\+with\+\_\+mass object, with Residual objects for the boundary conditions. The solver then only needs a pointer to the eigenvalue variable. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{EVPHarmonicEasy__lapack_8cpp_a05589fbab0657f08285ebdfe93f5ec9e}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{f@{f}!EVPHarmonicEasy\_lapack.cpp@{EVPHarmonicEasy\_lapack.cpp}}\index{EVPHarmonicEasy\_lapack.cpp@{EVPHarmonicEasy\_lapack.cpp}!f@{f}}}\mbox{\label{EVPHarmonicEasy__lapack_8cpp_a05589fbab0657f08285ebdfe93f5ec9ea7ce756344023b99e5ab27b804feb765c}} 
f&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{fd@{fd}!EVPHarmonicEasy\_lapack.cpp@{EVPHarmonicEasy\_lapack.cpp}}\index{EVPHarmonicEasy\_lapack.cpp@{EVPHarmonicEasy\_lapack.cpp}!fd@{fd}}}\mbox{\label{EVPHarmonicEasy__lapack_8cpp_a05589fbab0657f08285ebdfe93f5ec9ea1e4d60e5b05464d07a30096747025a42}} 
fd&\\
\hline

\end{DoxyEnumFields}


Definition at line 18 of file E\+V\+P\+Harmonic\+Easy\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{18 \{f, fd \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{EVPHarmonicEasy__lapack_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{EVPHarmonicEasy\_lapack.cpp@{EVPHarmonicEasy\_lapack.cpp}!main@{main}}
\index{main@{main}!EVPHarmonicEasy\_lapack.cpp@{EVPHarmonicEasy\_lapack.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 72 of file E\+V\+P\+Harmonic\+Easy\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{73 \{}
\DoxyCodeLine{74   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{75   cout << \textcolor{stringliteral}{"=== EVP: The harmonic equation done the easy way ====\(\backslash\)n"};}
\DoxyCodeLine{76   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{77 }
\DoxyCodeLine{78   \textcolor{comment}{// test pass/fail}}
\DoxyCodeLine{79   \textcolor{keywordtype}{bool} failed( \textcolor{keyword}{true} );}
\DoxyCodeLine{80 }
\DoxyCodeLine{81 }
\DoxyCodeLine{82   Example::harmonic\_equation problem;}
\DoxyCodeLine{83   Example::harmonic\_both\_BC BC\_both;}
\DoxyCodeLine{84   \textcolor{comment}{// domain is 0 to 1}}
\DoxyCodeLine{85   \textcolor{keywordtype}{double} left = 0.0;}
\DoxyCodeLine{86   \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{87   \textcolor{comment}{// number of nodal points}}
\DoxyCodeLine{88   \textcolor{keywordtype}{int} N = 256;}
\DoxyCodeLine{89   \textcolor{comment}{// EV is pi\string^2 so we'll guess = 10 + 0i}}
\DoxyCodeLine{90   D\_complex guess( 10.0, 0.0 );}
\DoxyCodeLine{91   \textcolor{comment}{// pass/fail tolerance}}
\DoxyCodeLine{92   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/3;}
\DoxyCodeLine{93 }
\DoxyCodeLine{94   cout << \textcolor{stringliteral}{" Solving the system using LAPACK:\(\backslash\)n"};}
\DoxyCodeLine{95   \textcolor{comment}{// set up the ode eigenproblem}}
\DoxyCodeLine{96   ODE\_EVP<double> ode\_lapack( \&problem, Utility::uniform\_node\_vector( left, right, N ), \&BC\_both, \&BC\_both );}
\DoxyCodeLine{97   ode\_lapack.p\_eigensystem() -\/> set\_calc\_eigenvectors( \textcolor{keyword}{true} );}
\DoxyCodeLine{98   ode\_lapack.p\_eigensystem() -\/> set\_shift( guess );}
\DoxyCodeLine{99   \textcolor{keywordflow}{try}}
\DoxyCodeLine{100   \{}
\DoxyCodeLine{101     \textcolor{comment}{// solve the global eigenvalue}}
\DoxyCodeLine{102     ode\_lapack.eigensolve();}
\DoxyCodeLine{103   \}}
\DoxyCodeLine{104   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{105   \{}
\DoxyCodeLine{106     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{107     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{108   \}}
\DoxyCodeLine{109   \textcolor{comment}{// get the eigenvalues in a disk of radius 1 about the guess}}
\DoxyCodeLine{110   ode\_lapack.p\_eigensystem() -\/> tag\_eigenvalues\_disc( + 1, 1. );}
\DoxyCodeLine{111   \textcolor{comment}{// get the tagged eigenvalue(s) -\/-\/ hopefully only 1}}
\DoxyCodeLine{112   DenseVector<D\_complex> lapack\_lambdas = ode\_lapack.p\_eigensystem() -\/> get\_tagged\_eigenvalues();}
\DoxyCodeLine{113   \textcolor{keywordflow}{if} ( abs( lapack\_lambdas[ 0 ].real() -\/ M\_PI * M\_PI ) < tol )}
\DoxyCodeLine{114   \{}
\DoxyCodeLine{115     failed = \textcolor{keyword}{false};}
\DoxyCodeLine{116     cout << \textcolor{stringliteral}{"  LAPACK solver works.\(\backslash\)n"};}
\DoxyCodeLine{117   \}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119   \textcolor{keywordflow}{if} ( failed )}
\DoxyCodeLine{120   \{}
\DoxyCodeLine{121     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{122     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{123   \}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125   cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{126   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::eigensolve(), Cpp\+Noddy\+::\+Example\+::failed, Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::p\+\_\+eigensystem(), Cpp\+Noddy\+::\+Utility\+::real(), and Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector().

