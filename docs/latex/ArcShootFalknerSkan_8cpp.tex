\doxysubsection{Tests/\+Arclength/\+Arc\+Shoot\+Falkner\+Skan.cpp File Reference}
\label{ArcShootFalknerSkan_8cpp}\index{Tests/Arclength/ArcShootFalknerSkan.cpp@{Tests/Arclength/ArcShootFalknerSkan.cpp}}
{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$I\+V\+P\+\_\+bundle.\+h$>$}\newline
{\ttfamily \#include $<$Newton\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+F\+S\+\_\+eqn}
\begin{DoxyCompactList}\small\item\em Define the Falkner-\/\+Skan equation. \end{DoxyCompactList}\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+F\+S\+\_\+residual}
\begin{DoxyCompactList}\small\item\em Define a residual function using the boundary conditions for the Blasius profile. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Arc-\/length continue the Falkner-\/\+Skan equation \[ f\textnormal{\textquotesingle}\textnormal{\textquotesingle}\textnormal{\textquotesingle}(y) + f(y) f\textnormal{\textquotesingle}\textnormal{\textquotesingle}(y) + \beta \left ( 1 - f\textnormal{\textquotesingle}(y)^2 \right )= 0\,, \] for varying values of the Hartree parameter $ \beta $ -- around the well known limit point. The boundary conditions are $ f(0)=f\textnormal{\textquotesingle}(0)=0 $ and $ f\textnormal{\textquotesingle}(\infty) = 1 $. We start from the Blasius solution, then arc-\/length continue to find the limit point at $ \beta \approx -0.19 $.

Using Runge-\/\+Kutta to solve a B\+VP is not a great method, but here it\textquotesingle{}s used to demo the arc-\/length continuation for scalar problems. 

\doxysubsubsection{Function Documentation}
\mbox{\label{ArcShootFalknerSkan_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{ArcShootFalknerSkan.cpp@{ArcShootFalknerSkan.cpp}!main@{main}}
\index{main@{main}!ArcShootFalknerSkan.cpp@{ArcShootFalknerSkan.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 85 of file Arc\+Shoot\+Falkner\+Skan.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{86 \{}
\DoxyCodeLine{87   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{88   cout << \textcolor{stringliteral}{"=== ARC: arc-\/length continuation of the FS equation =\(\backslash\)n"};}
\DoxyCodeLine{89   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{90 }
\DoxyCodeLine{91   \textcolor{comment}{// the residual function to be satisfied}}
\DoxyCodeLine{92   Example::FS\_residual problem;}
\DoxyCodeLine{93 }
\DoxyCodeLine{94   \textcolor{comment}{// initial conditions}}
\DoxyCodeLine{95   problem.eqn -\/> beta = -\/0.11;}
\DoxyCodeLine{96   DenseVector<double> stress( 1, 0.4 );}
\DoxyCodeLine{97   \textcolor{comment}{// Scalar Newton iteration problem}}
\DoxyCodeLine{98   Newton<double> newton( \&problem );}
\DoxyCodeLine{99 }
\DoxyCodeLine{100   newton.set\_monitor\_det( \textcolor{keyword}{true} );}
\DoxyCodeLine{101   \textcolor{comment}{// initialise a state for arc length continuation}}
\DoxyCodeLine{102   newton.init\_arc( stress, \&problem.eqn -\/> beta, -\/0.01, 0.1 );}
\DoxyCodeLine{103 }
\DoxyCodeLine{104   \textcolor{comment}{// output for the data}}
\DoxyCodeLine{105   std::string dirname(\textcolor{stringliteral}{"./DATA"});}
\DoxyCodeLine{106   mkdir( dirname.c\_str(), S\_IRWXU );}
\DoxyCodeLine{107   TrackerFile my\_file( \textcolor{stringliteral}{"./DATA/FSarc\_path.dat"} );}
\DoxyCodeLine{108   my\_file.push\_ptr( \&problem.eqn -\/> beta, \textcolor{stringliteral}{"Hartree parameter"} );}
\DoxyCodeLine{109   my\_file.push\_ptr( \&stress, \textcolor{stringliteral}{"Shear stress at the wall"} );}
\DoxyCodeLine{110   my\_file.header();}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   \textcolor{comment}{// seek out the limit point in an ad hoc way}}
\DoxyCodeLine{113   \textcolor{keywordtype}{double} approx\_limit\_point = 0.0;}
\DoxyCodeLine{114   \textcolor{keywordflow}{do}}
\DoxyCodeLine{115   \{}
\DoxyCodeLine{116     \textcolor{keywordtype}{double} last\_beta = problem.eqn -\/> beta;}
\DoxyCodeLine{117     \textcolor{keywordflow}{try}}
\DoxyCodeLine{118     \{}
\DoxyCodeLine{119       \textcolor{keywordflow}{try}}
\DoxyCodeLine{120       \{}
\DoxyCodeLine{121         newton.arclength\_solve( stress );}
\DoxyCodeLine{122         \textcolor{comment}{//cout << problem.eqn -\/> beta << " " << stress[0] << "\(\backslash\)n";}}
\DoxyCodeLine{123       \}}
\DoxyCodeLine{124       \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{125       \{}
\DoxyCodeLine{126         cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{127         \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{128       \}}
\DoxyCodeLine{129     \}}
\DoxyCodeLine{130     \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} ExceptionBifurcation \&bifn )}
\DoxyCodeLine{131     \{}
\DoxyCodeLine{132       cout << \textcolor{stringliteral}{" Bifurcation detected between beta = "} << last\_beta}
\DoxyCodeLine{133            << \textcolor{stringliteral}{" and beta = "} << problem.eqn -\/> beta << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{134       cout << \textcolor{stringliteral}{" Continuing further.\(\backslash\)n"};}
\DoxyCodeLine{135       newton.set\_monitor\_det( \textcolor{keyword}{false} );}
\DoxyCodeLine{136       approx\_limit\_point = 0.5 * ( problem.eqn -\/> beta + last\_beta );}
\DoxyCodeLine{137     \}}
\DoxyCodeLine{138     my\_file.update();}
\DoxyCodeLine{139   \}}
\DoxyCodeLine{140   \textcolor{keywordflow}{while} ( problem.eqn -\/> beta  < -\/0.1 );}
\DoxyCodeLine{141 }
\DoxyCodeLine{142   \textcolor{keywordflow}{if} ( abs( approx\_limit\_point + 0.1988 ) > 0.0005 )}
\DoxyCodeLine{143   \{}
\DoxyCodeLine{144     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{145     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{146   \}}
\DoxyCodeLine{147   \textcolor{keywordflow}{else}}
\DoxyCodeLine{148   \{}
\DoxyCodeLine{149     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{150     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{151   \}}
\DoxyCodeLine{152 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Newton$<$ \+\_\+\+Type $>$\+::arclength\+\_\+solve(), Cpp\+Noddy\+::\+Tracker\+File\+::header(), Cpp\+Noddy\+::\+Arc\+Length\+\_\+base$<$ \+\_\+\+Type $>$\+::init\+\_\+arc(), Cpp\+Noddy\+::\+Tracker\+File\+::push\+\_\+ptr(), Cpp\+Noddy\+::\+Newton$<$ \+\_\+\+Type $>$\+::set\+\_\+monitor\+\_\+det(), and Cpp\+Noddy\+::\+Tracker\+File\+::update().

