\doxysubsection{Tests/\+I\+V\+P/\+I\+V\+P\+Harmonic.cpp File Reference}
\label{IVPHarmonic_8cpp}\index{Tests/IVP/IVPHarmonic.cpp@{Tests/IVP/IVPHarmonic.cpp}}
{\ttfamily \#include $<$I\+V\+P\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Harmonic\+\_\+equation$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$}
\begin{DoxyCompactList}\small\item\em Define the harmonic equation by inheriting the \doxyref{Equation}{p.}{classCppNoddy_1_1Equation} base class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Integrate the harmonic equation \[ f\textnormal{\textquotesingle}\textnormal{\textquotesingle}(y) + \lambda f(y) = 0 \] with $\lambda=10$ from $ y = 0$ to $1$ as an I\+VP, using an adaptive Runge-\/\+Kutta-\/\+Fehlberg routine. 

\doxysubsubsection{Function Documentation}
\mbox{\label{IVPHarmonic_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{IVPHarmonic.cpp@{IVPHarmonic.cpp}!main@{main}}
\index{main@{main}!IVPHarmonic.cpp@{IVPHarmonic.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 42 of file I\+V\+P\+Harmonic.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{43 \{}
\DoxyCodeLine{44 }
\DoxyCodeLine{45   Timer timer;}
\DoxyCodeLine{46   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{47   cout << \textcolor{stringliteral}{"=== IVP: solving harmonic equation ==================\(\backslash\)n"};}
\DoxyCodeLine{48   cout << \textcolor{stringliteral}{"   Solving between x = 0 to x = 10 \(\backslash\)n"};}
\DoxyCodeLine{49   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{50   cout << \textcolor{stringliteral}{"   Running shoot45 method -\/ auto step choice \(\backslash\)n"};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{comment}{// set up the problem}}
\DoxyCodeLine{53   Example::Harmonic\_equation problem;}
\DoxyCodeLine{54   problem.lambda = 10.0;}
\DoxyCodeLine{55 }
\DoxyCodeLine{56   \textcolor{comment}{// pass it to the ode}}
\DoxyCodeLine{57   ODE\_IVP<double> ode( \&problem, 0.0, 10.0, 1000 );}
\DoxyCodeLine{58   \textcolor{comment}{// run the checks}}
\DoxyCodeLine{59   cout.precision( 12 );}
\DoxyCodeLine{60 }
\DoxyCodeLine{61   \textcolor{keywordtype}{double} tol( 1.e-\/7 );}
\DoxyCodeLine{62   DenseVector<double> u\_init( 2, 0.0 );}
\DoxyCodeLine{63   DenseVector<double> u\_final( 2, 0.0 );}
\DoxyCodeLine{64   u\_init[ 0 ] = 1.0;}
\DoxyCodeLine{65   u\_init[ 1 ] = 0.0;}
\DoxyCodeLine{66 }
\DoxyCodeLine{67   problem.coord(0) = 0.0;}
\DoxyCodeLine{68   ode.shoot45( u\_init, tol, 0.01 );}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{keywordflow}{try}}
\DoxyCodeLine{71   \{}
\DoxyCodeLine{72     u\_final = ode.shoot45( u\_init, tol, 0.01 );}
\DoxyCodeLine{73   \}}
\DoxyCodeLine{74   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{75   \{}
\DoxyCodeLine{76     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{77     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{78   \}}
\DoxyCodeLine{79   timer.counter()++;}
\DoxyCodeLine{80 }
\DoxyCodeLine{81   \textcolor{keywordtype}{bool} failed( \textcolor{keyword}{false} );}
\DoxyCodeLine{82   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} j = 1; j < 7; j++ )}
\DoxyCodeLine{83   \{}
\DoxyCodeLine{84     \textcolor{comment}{// run through a few tolerance choices}}
\DoxyCodeLine{85     tol = 1. / ( pow( 10., j ) );}
\DoxyCodeLine{86     \textcolor{comment}{// auto step choice; tolerance; initial step}}
\DoxyCodeLine{87     u\_final = ode.shoot45( u\_init, tol, 0.01 );}
\DoxyCodeLine{88     \textcolor{comment}{// some output}}
\DoxyCodeLine{89     cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{90     cout << \textcolor{stringliteral}{"    Error relative tol : "} << tol << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{91     cout << \textcolor{stringliteral}{"    Error |num -\/ exact|: "}}
\DoxyCodeLine{92          << abs( u\_final[ 0 ] -\/ cos( sqrt( problem.lambda ) * 10. ) ) << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{93 }
\DoxyCodeLine{94     \textcolor{keywordflow}{if} ( abs( u\_final[ 0 ] -\/ cos( sqrt( problem.lambda ) * 10. ) ) > 10. * tol )}
\DoxyCodeLine{95     \{}
\DoxyCodeLine{96       failed = \textcolor{keyword}{true};}
\DoxyCodeLine{97     \}}
\DoxyCodeLine{98   \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100   \textcolor{keywordflow}{if} ( failed )}
\DoxyCodeLine{101   \{}
\DoxyCodeLine{102     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{103     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{104   \}}
\DoxyCodeLine{105   \textcolor{keywordflow}{else}}
\DoxyCodeLine{106   \{}
\DoxyCodeLine{107     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{108     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{109   \}}
\DoxyCodeLine{110 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Timer\+::counter(), Cpp\+Noddy\+::\+Example\+::failed, and Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+V\+P$<$ \+\_\+\+Type $>$\+::shoot45().

