\doxysubsection{Tests/\+I\+B\+V\+P/\+I\+B\+V\+P\+Diffusion.cpp File Reference}
\label{IBVPDiffusion_8cpp}\index{Tests/IBVP/IBVPDiffusion.cpp@{Tests/IBVP/IBVPDiffusion.cpp}}
{\ttfamily \#include $<$I\+B\+V\+P\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Diff\+\_\+equation}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Diff\+\_\+both\+\_\+\+BC}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ f}, 
\textbf{ fd}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solving the heat diffusion equation \[ f_t = f_{yy} \] subject to $ f(0) = 0 $ and $ f(1) = 0 $ with initial condition $ f(y,t=0) = y(1-y) $. The solution is computed over a range of $ t $ and the maximum deviation away from the analytical solution is found. The test fails if this deviation is larger than a set tolerance $ \tau $. The analytical solution is the Fourier series\+: \[ f(y,t) = \sum_{n=1,3,...}^M \frac{8}{n^3\pi^3} \sin ( n\pi y) \exp{ -n^2\pi^2 t } \] The series is truncated at the $ M $-\/th term, in such a way that the first neglected term is of magnitude $ < \tau /10 $. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{IBVPDiffusion_8cpp_aaf8fd5f0e57d456151c951e0f3715fc4}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{f@{f}!IBVPDiffusion.cpp@{IBVPDiffusion.cpp}}\index{IBVPDiffusion.cpp@{IBVPDiffusion.cpp}!f@{f}}}\mbox{\label{IBVPDiffusion_8cpp_aaf8fd5f0e57d456151c951e0f3715fc4a7ce756344023b99e5ab27b804feb765c}} 
f&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{fd@{fd}!IBVPDiffusion.cpp@{IBVPDiffusion.cpp}}\index{IBVPDiffusion.cpp@{IBVPDiffusion.cpp}!fd@{fd}}}\mbox{\label{IBVPDiffusion_8cpp_aaf8fd5f0e57d456151c951e0f3715fc4a1e4d60e5b05464d07a30096747025a42}} 
fd&\\
\hline

\end{DoxyEnumFields}


Definition at line 19 of file I\+B\+V\+P\+Diffusion.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{19 \{ f, fd \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{IBVPDiffusion_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{IBVPDiffusion.cpp@{IBVPDiffusion.cpp}!main@{main}}
\index{main@{main}!IBVPDiffusion.cpp@{IBVPDiffusion.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 83 of file I\+B\+V\+P\+Diffusion.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{84 \{}
\DoxyCodeLine{85   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{86   cout << \textcolor{stringliteral}{"=== IBVP: An unsteady diffusion eqn =================\(\backslash\)n"};}
\DoxyCodeLine{87   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{88 }
\DoxyCodeLine{89   \textcolor{comment}{// Diffusion equation}}
\DoxyCodeLine{90   Example::Diff\_equation problem;}
\DoxyCodeLine{91   \textcolor{comment}{// boundary conditions}}
\DoxyCodeLine{92   Example::Diff\_both\_BC BC\_both;}
\DoxyCodeLine{93 }
\DoxyCodeLine{94   \textcolor{comment}{// domain definition}}
\DoxyCodeLine{95   \textcolor{keywordtype}{double} left = 0.0;}
\DoxyCodeLine{96   \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{97   \textcolor{comment}{// number of (spatial) nodal points}}
\DoxyCodeLine{98   \textcolor{keywordtype}{unsigned} ny = 201;}
\DoxyCodeLine{99   \textcolor{comment}{// time step}}
\DoxyCodeLine{100   \textcolor{keywordtype}{double} dt = 0.005;}
\DoxyCodeLine{101   \textcolor{comment}{// number of time steps}}
\DoxyCodeLine{102   \textcolor{keywordtype}{unsigned} max\_steps = ( unsigned ) ( 3.0 / dt );}
\DoxyCodeLine{103   \textcolor{comment}{// test tolerance}}
\DoxyCodeLine{104   \textcolor{keywordtype}{double} tol = 1.e-\/4;}
\DoxyCodeLine{105 }
\DoxyCodeLine{106   \textcolor{comment}{// construct our IBVP}}
\DoxyCodeLine{107   PDE\_IBVP<double> heat( \&problem, Utility::uniform\_node\_vector( left, right, ny ), \&BC\_both, \&BC\_both );}
\DoxyCodeLine{108 }
\DoxyCodeLine{109   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < ny; ++i )}
\DoxyCodeLine{110   \{}
\DoxyCodeLine{111     \textcolor{keywordtype}{double} y = heat.solution().coord( i );}
\DoxyCodeLine{112     heat.solution()( i, f ) = y * ( 1 -\/ y );}
\DoxyCodeLine{113     heat.solution()( i, fd ) = 1 -\/ 2 * y;}
\DoxyCodeLine{114   \}}
\DoxyCodeLine{115 }
\DoxyCodeLine{116   \textcolor{comment}{// maximum difference between numerical and series solution at centre point}}
\DoxyCodeLine{117   \textcolor{keywordtype}{double} max\_diff( 0.0 );}
\DoxyCodeLine{118   \textcolor{comment}{// time step}}
\DoxyCodeLine{119   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 1; i < max\_steps; ++i )}
\DoxyCodeLine{120   \{}
\DoxyCodeLine{121     \textcolor{comment}{// take a time step}}
\DoxyCodeLine{122     \textcolor{keywordflow}{try}}
\DoxyCodeLine{123     \{}
\DoxyCodeLine{124       heat.step2( dt );}
\DoxyCodeLine{125     \}}
\DoxyCodeLine{126     \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{127     \{}
\DoxyCodeLine{128       cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{129       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{130     \}}
\DoxyCodeLine{131 }
\DoxyCodeLine{132     \textcolor{comment}{// evaluate analytical Fourier series solution at y = 0.5}}
\DoxyCodeLine{133     \textcolor{keywordtype}{unsigned} mid = ( ny -\/ 1 ) / 2;}
\DoxyCodeLine{134     \textcolor{keywordtype}{double} y = left + mid * ( right -\/ left ) / ( ny -\/ 1 );}
\DoxyCodeLine{135     \textcolor{keywordtype}{double} u( 0.0 );}
\DoxyCodeLine{136     \textcolor{keywordtype}{int} en( -\/1 );}
\DoxyCodeLine{137     \textcolor{keywordtype}{double} correction( 0.0 );}
\DoxyCodeLine{138     \textcolor{keywordflow}{do}}
\DoxyCodeLine{139     \{}
\DoxyCodeLine{140       en += 2;}
\DoxyCodeLine{141       correction = 8 / ( std::pow( en * M\_PI, 3 ) )}
\DoxyCodeLine{142                    * std::exp( -\/std::pow( en * M\_PI, 2 ) * heat.coord() ) * std::sin( en * M\_PI * y );}
\DoxyCodeLine{143       u += correction;}
\DoxyCodeLine{144     \}}
\DoxyCodeLine{145     \textcolor{keywordflow}{while} ( std::abs( correction ) > tol / 10. );}
\DoxyCodeLine{146     \textcolor{comment}{// examine the difference between the numerical and series solutions}}
\DoxyCodeLine{147     max\_diff = std::max( max\_diff, std::abs( u -\/ heat.solution()( mid, f ) ) );}
\DoxyCodeLine{148   \}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150   \textcolor{keywordtype}{bool} failed = \textcolor{keyword}{true};}
\DoxyCodeLine{151   \textcolor{keywordflow}{if} ( abs( max\_diff ) < tol )}
\DoxyCodeLine{152   \{}
\DoxyCodeLine{153     failed = \textcolor{keyword}{false};}
\DoxyCodeLine{154   \}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156   \textcolor{keywordflow}{if} ( failed )}
\DoxyCodeLine{157   \{}
\DoxyCodeLine{158     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{159     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{160   \}}
\DoxyCodeLine{161   \textcolor{keywordflow}{else}}
\DoxyCodeLine{162   \{}
\DoxyCodeLine{163     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{164     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{165   \}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::coord(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), f, Cpp\+Noddy\+::\+Example\+::failed, fd, Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::solution(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::step2(), u, and Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector().

