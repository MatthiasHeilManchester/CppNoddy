\doxysubsection{Tests/\+I\+B\+V\+P/\+I\+B\+V\+P\+Nonlinear\+Adv\+Diffusion.cpp File Reference}
\label{IBVPNonlinearAdvDiffusion_8cpp}\index{Tests/IBVP/IBVPNonlinearAdvDiffusion.cpp@{Tests/IBVP/IBVPNonlinearAdvDiffusion.cpp}}
{\ttfamily \#include $<$I\+B\+V\+P\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Nlin\+\_\+adv\+\_\+equation}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Nlin\+\_\+adv\+\_\+left\+\_\+\+BC}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Nlin\+\_\+adv\+\_\+right\+\_\+\+BC}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ U}, 
\textbf{ Ud}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
const double \textbf{ Cpp\+Noddy\+::\+Example\+::eps} (2.\+0)
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::source} (const double \&y, const double \&t)
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solving the nonlinear advection diffusion equation \[ U_{yy} - Re U U_t = S( y, t ) \] subject to $ U(y=0,t) = 1 $ and $ U(y=1,t) = 2 $ with initial condition $ U(y,t=0) = 1 + y + \epsilon y(1-y) $ and a source term \[ S(y,t) = ( 1 + y + \epsilon y(1-y)e^{-t} ) \epsilon y(1-y ) e^{-t} - 2\epsilon e^{-t} / Re \] for some constant parameters $\epsilon $ and $ Re $. This source term is chosen to allow an exact solution \[ U(y,t) = 1 + y + \epsilon y(1-y) e^{-t} \] against which the numerical computation is compared, by computing the maximum absolute deviation over all spatial and temporal nodes. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{IBVPNonlinearAdvDiffusion_8cpp_a7ff5f2dff38e7639981794c43dc9167b}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{U@{U}!IBVPNonlinearAdvDiffusion.cpp@{IBVPNonlinearAdvDiffusion.cpp}}\index{IBVPNonlinearAdvDiffusion.cpp@{IBVPNonlinearAdvDiffusion.cpp}!U@{U}}}\mbox{\label{IBVPNonlinearAdvDiffusion_8cpp_a7ff5f2dff38e7639981794c43dc9167bac461e84f27bbb236874e1011cd66031f}} 
U&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Ud@{Ud}!IBVPNonlinearAdvDiffusion.cpp@{IBVPNonlinearAdvDiffusion.cpp}}\index{IBVPNonlinearAdvDiffusion.cpp@{IBVPNonlinearAdvDiffusion.cpp}!Ud@{Ud}}}\mbox{\label{IBVPNonlinearAdvDiffusion_8cpp_a7ff5f2dff38e7639981794c43dc9167bae3fe7b6f745ea6be7e92f8c854abfb4f}} 
Ud&\\
\hline

\end{DoxyEnumFields}


Definition at line 19 of file I\+B\+V\+P\+Nonlinear\+Adv\+Diffusion.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{19 \{ U, Ud \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{IBVPNonlinearAdvDiffusion_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{IBVPNonlinearAdvDiffusion.cpp@{IBVPNonlinearAdvDiffusion.cpp}!main@{main}}
\index{main@{main}!IBVPNonlinearAdvDiffusion.cpp@{IBVPNonlinearAdvDiffusion.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 107 of file I\+B\+V\+P\+Nonlinear\+Adv\+Diffusion.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{108 \{}
\DoxyCodeLine{109   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{110   cout << \textcolor{stringliteral}{"=== IBVP: Nonlinear advection diffusion =============\(\backslash\)n"};}
\DoxyCodeLine{111   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{112 }
\DoxyCodeLine{113   \textcolor{comment}{// instantiate the problem}}
\DoxyCodeLine{114   Example::Nlin\_adv\_equation problem;}
\DoxyCodeLine{115   Example::Nlin\_adv\_left\_BC BC\_left;}
\DoxyCodeLine{116   Example::Nlin\_adv\_right\_BC BC\_right;}
\DoxyCodeLine{117 }
\DoxyCodeLine{118   \textcolor{comment}{// domain definition}}
\DoxyCodeLine{119   \textcolor{keywordtype}{double} left = 0.0;}
\DoxyCodeLine{120   \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{121   \textcolor{comment}{// number of (spatial) nodal points}}
\DoxyCodeLine{122   \textcolor{keywordtype}{unsigned} ny = 400;}
\DoxyCodeLine{123   \textcolor{comment}{// number of time steps}}
\DoxyCodeLine{124   \textcolor{keywordtype}{unsigned} max\_steps = 4000;}
\DoxyCodeLine{125   \textcolor{comment}{// time step}}
\DoxyCodeLine{126   \textcolor{keywordtype}{double} dt = 1.0 / ( max\_steps -\/ 1 );}
\DoxyCodeLine{127 }
\DoxyCodeLine{128   \textcolor{comment}{// initial rotation frequency}}
\DoxyCodeLine{129   Example::Re = 1.0;}
\DoxyCodeLine{130 }
\DoxyCodeLine{131   \textcolor{comment}{// construct our IBVP}}
\DoxyCodeLine{132   PDE\_IBVP<double> advection( \&problem, Utility::uniform\_node\_vector( left, right, ny ), \&BC\_left, \&BC\_right );}
\DoxyCodeLine{133 }
\DoxyCodeLine{134   \textcolor{comment}{// initial conditions}}
\DoxyCodeLine{135   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < ny; ++i )}
\DoxyCodeLine{136   \{}
\DoxyCodeLine{137     \textcolor{keywordtype}{double} y = advection.solution().coord( i );}
\DoxyCodeLine{138     advection.solution()( i, U ) = 1.0 + y + Example::eps * y * ( 1 -\/ y );}
\DoxyCodeLine{139     advection.solution()( i, Ud ) = 1.0;}
\DoxyCodeLine{140   \}}
\DoxyCodeLine{141 }
\DoxyCodeLine{142   \textcolor{comment}{// set up output details}}
\DoxyCodeLine{143   std::string dirname(\textcolor{stringliteral}{"./DATA"});}
\DoxyCodeLine{144   mkdir( dirname.c\_str(), S\_IRWXU );}
\DoxyCodeLine{145   TrackerFile my\_file( \textcolor{stringliteral}{"./DATA/IBVP\_NlinAdvection.dat"} );}
\DoxyCodeLine{146   my\_file.push\_ptr( \&advection.coord(), \textcolor{stringliteral}{"time"} );}
\DoxyCodeLine{147   my\_file.push\_ptr( \&advection.solution(), \textcolor{stringliteral}{"Solution profile"} );}
\DoxyCodeLine{148   my\_file.header();}
\DoxyCodeLine{149 }
\DoxyCodeLine{150   \textcolor{keywordtype}{double} max\_err( 0.0 );}
\DoxyCodeLine{151   \textcolor{comment}{// time step}}
\DoxyCodeLine{152   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 1; i < max\_steps; ++i )}
\DoxyCodeLine{153   \{}
\DoxyCodeLine{154     \textcolor{comment}{// take a time step}}
\DoxyCodeLine{155     \textcolor{keywordflow}{try}}
\DoxyCodeLine{156     \{}
\DoxyCodeLine{157       advection.step2( dt );}
\DoxyCodeLine{158     \}}
\DoxyCodeLine{159     \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{160     \{}
\DoxyCodeLine{161       cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{162       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{163     \}}
\DoxyCodeLine{164     \textcolor{keywordflow}{if} ( i \% 100 == 0 )}
\DoxyCodeLine{165     \{}
\DoxyCodeLine{166       my\_file.update();}
\DoxyCodeLine{167       my\_file.newline();}
\DoxyCodeLine{168     \}}
\DoxyCodeLine{169     \textcolor{comment}{// generate the exact solution to compare to}}
\DoxyCodeLine{170     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < ny; ++i )}
\DoxyCodeLine{171     \{}
\DoxyCodeLine{172       \textcolor{keywordtype}{double} y = advection.solution().coord( i );}
\DoxyCodeLine{173       \textcolor{keyword}{const} \textcolor{keywordtype}{double} exact\_solution = 1.0 + y + Example::eps * y * ( 1 -\/ y ) * std::exp( -\/advection.coord() );}
\DoxyCodeLine{174       max\_err = std::max( max\_err, std::abs( advection.solution()( i, 0 ) -\/ exact\_solution ) );}
\DoxyCodeLine{175     \}}
\DoxyCodeLine{176   \}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178   \textcolor{keywordflow}{if} ( max\_err > 1.e-\/6 )}
\DoxyCodeLine{179   \{}
\DoxyCodeLine{180     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{181     cout.precision( 14 );}
\DoxyCodeLine{182     cout << 1. / ( ny -\/ 1 ) << \textcolor{stringliteral}{" "} << dt << \textcolor{stringliteral}{" "} << max\_err << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{183     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{184   \}}
\DoxyCodeLine{185   \textcolor{keywordflow}{else}}
\DoxyCodeLine{186   \{}
\DoxyCodeLine{187     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{188     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{189   \}}
\DoxyCodeLine{190 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::coord(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), Cpp\+Noddy\+::\+Example\+::eps(), Cpp\+Noddy\+::\+Tracker\+File\+::header(), Cpp\+Noddy\+::\+Tracker\+File\+::newline(), Cpp\+Noddy\+::\+Tracker\+File\+::push\+\_\+ptr(), Cpp\+Noddy\+::\+Example\+::\+Re, Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::solution(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::step2(), U, Ud, Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector(), and Cpp\+Noddy\+::\+Tracker\+File\+::update().

