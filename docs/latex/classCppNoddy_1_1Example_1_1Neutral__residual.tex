\doxysubsection{Cpp\+Noddy\+::Example\+::Neutral\+\_\+residual Class Reference}
\label{classCppNoddy_1_1Example_1_1Neutral__residual}\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
Inheritance diagram for Cpp\+Noddy\+::Example\+::Neutral\+\_\+residual\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classCppNoddy_1_1Example_1_1Neutral__residual}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Neutral\+\_\+residual} (const unsigned \&initial\+\_\+N)
\item 
\textbf{ $\sim$\+Neutral\+\_\+residual} ()
\item 
void \textbf{ residual\+\_\+fn} (const \textbf{ Dense\+Vector}$<$ double $>$ \&\textbf{ z}, \textbf{ Dense\+Vector}$<$ double $>$ \&\textbf{ f}) const
\begin{DoxyCompactList}\small\item\em A blank virtual residual function method. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\textbf{ O\+D\+E\+\_\+\+B\+VP}$<$ \textbf{ D\+\_\+complex} $>$ $\ast$ \textbf{ ode\+\_\+local}
\item 
\textbf{ O\+S\+\_\+bvp\+\_\+equation} $\ast$ \textbf{ bvp}
\item 
\textbf{ O\+S\+\_\+bvp\+\_\+left\+\_\+\+BC} $\ast$ \textbf{ B\+C\+\_\+left}
\item 
\textbf{ O\+S\+\_\+bvp\+\_\+right\+\_\+\+BC} $\ast$ \textbf{ B\+C\+\_\+right}
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}


\doxysubsubsection{Detailed Description}


Definition at line 155 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.



\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\label{classCppNoddy_1_1Example_1_1Neutral__residual_a682ee008f574bf8ba7101bbf5538b8ae}} 
\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}!Neutral\_residual@{Neutral\_residual}}
\index{Neutral\_residual@{Neutral\_residual}!CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
\doxyparagraph{Neutral\_residual()}
{\footnotesize\ttfamily Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::\+Neutral\+\_\+residual (\begin{DoxyParamCaption}\item[{const unsigned \&}]{initial\+\_\+N }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 160 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{160                                                     : Residual<double>( 1 )}
\DoxyCodeLine{161       \{}
\DoxyCodeLine{162         \textcolor{comment}{// instantiate the object by doing a rough QZ pass of the eigenvalues}}
\DoxyCodeLine{163         OS\_evp\_equation evp;}
\DoxyCodeLine{164         \textcolor{comment}{// instantiate the BCs}}
\DoxyCodeLine{165         OS\_evp\_both\_BC BC\_both;}
\DoxyCodeLine{166         \textcolor{comment}{// domain is -\/1 to 1}}
\DoxyCodeLine{167         \textcolor{keywordtype}{double} left = -\/1.0;}
\DoxyCodeLine{168         \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{169         \textcolor{comment}{// number of nodal points}}
\DoxyCodeLine{170         \textcolor{keywordtype}{int} N = initial\_N;}
\DoxyCodeLine{171         \textcolor{comment}{// mesh}}
\DoxyCodeLine{172         DenseVector<double> nodes( Utility::uniform\_node\_vector( left, right, N ) );}
\DoxyCodeLine{173         \textcolor{comment}{// pass it to the ode}}
\DoxyCodeLine{174         ODE\_EVP<D\_complex> ode\_global( \&evp, nodes, \&BC\_both, \&BC\_both );}
\DoxyCodeLine{175         \textcolor{keywordflow}{try}}
\DoxyCodeLine{176         \{}
\DoxyCodeLine{177           \textcolor{comment}{// solve the global eigenvalue problem for growth rate}}
\DoxyCodeLine{178           ode\_global.eigensolve();}
\DoxyCodeLine{179         \}}
\DoxyCodeLine{180         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{181         \{}
\DoxyCodeLine{182           std::cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{183           assert(\textcolor{keyword}{false});}
\DoxyCodeLine{184         \}}
\DoxyCodeLine{185         \textcolor{comment}{// get the eigenvalues near the origin}}
\DoxyCodeLine{186         ode\_global.p\_eigensystem() -\/> tag\_eigenvalues\_disc( + 1, 0.6 );}
\DoxyCodeLine{187         \textcolor{comment}{// make a mesh of each tagged eigenmode in the ODE\_EVP class}}
\DoxyCodeLine{188         ode\_global.add\_tagged\_to\_mesh();}
\DoxyCodeLine{189         DenseVector<D\_complex> lambdas = ode\_global.p\_eigensystem() -\/> get\_tagged\_eigenvalues();}
\DoxyCodeLine{190 }
\DoxyCodeLine{191         \textcolor{comment}{// instantiate the nonlinear BVP formulation}}
\DoxyCodeLine{192         bvp = \textcolor{keyword}{new} OS\_bvp\_equation;}
\DoxyCodeLine{193         BC\_left = \textcolor{keyword}{new} OS\_bvp\_left\_BC;}
\DoxyCodeLine{194         BC\_right = \textcolor{keyword}{new} OS\_bvp\_right\_BC;}
\DoxyCodeLine{195         \textcolor{comment}{// pass it to the ode BVP solver}}
\DoxyCodeLine{196         ode\_local = \textcolor{keyword}{new} ODE\_BVP<D\_complex>( bvp, nodes, BC\_left, BC\_right );}
\DoxyCodeLine{197         ode\_local -\/> set\_monitor\_det( \textcolor{keyword}{false} );}
\DoxyCodeLine{198         \textcolor{comment}{// use our not-\/great initial guess from QZ code to start the solver off}}
\DoxyCodeLine{199         \textcolor{comment}{// here we just use the first (0) tagged eigenvalue}}
\DoxyCodeLine{200         ode\_local -\/> solution() = ode\_global.get\_mesh( 0 );}
\DoxyCodeLine{201         \textcolor{comment}{// interpolate onto a finer mesh}}
\DoxyCodeLine{202         ode\_local -\/> solution().remesh1( Utility::uniform\_node\_vector( left, right, 201 ) );}
\DoxyCodeLine{203         ode\_local -\/> set\_monitor\_det( \textcolor{keyword}{false} );}
\DoxyCodeLine{204         ode\_local -\/> solve2();}
\DoxyCodeLine{205         \textcolor{comment}{// adaptively refine the mesh}}
\DoxyCodeLine{206         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{int} i = 0; i < MAX\_REFINE; ++i )}
\DoxyCodeLine{207         \{}
\DoxyCodeLine{208           ode\_local -\/> adapt( 1.e-\/2 );}
\DoxyCodeLine{209           ode\_local -\/> solve2();}
\DoxyCodeLine{210           std::cout << \textcolor{stringliteral}{"Adapted to "} << ode\_local -\/> solution().get\_nnodes() << \textcolor{stringliteral}{" nodes \(\backslash\)n"};}
\DoxyCodeLine{211         \}}
\DoxyCodeLine{212       \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::add\+\_\+tagged\+\_\+to\+\_\+mesh(), B\+C\+\_\+left, B\+C\+\_\+right, bvp, Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::eigensolve(), Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::get\+\_\+mesh(), Cpp\+Noddy\+::\+Example\+::\+M\+A\+X\+\_\+\+R\+E\+F\+I\+N\+E(), ode\+\_\+local, Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::p\+\_\+eigensystem(), and Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector().

\mbox{\label{classCppNoddy_1_1Example_1_1Neutral__residual_a868596771a36cfed1eecfc9c6e36de4d}} 
\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}!````~Neutral\_residual@{$\sim$Neutral\_residual}}
\index{````~Neutral\_residual@{$\sim$Neutral\_residual}!CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
\doxyparagraph{$\sim$Neutral\_residual()}
{\footnotesize\ttfamily Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::$\sim$\+Neutral\+\_\+residual (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 214 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{215       \{}
\DoxyCodeLine{216         \textcolor{keyword}{delete} bvp;}
\DoxyCodeLine{217         \textcolor{keyword}{delete} BC\_left;}
\DoxyCodeLine{218         \textcolor{keyword}{delete} BC\_right;}
\DoxyCodeLine{219         \textcolor{keyword}{delete} ode\_local;}
\DoxyCodeLine{220       \}}

\end{DoxyCode}


References B\+C\+\_\+left, B\+C\+\_\+right, bvp, and ode\+\_\+local.



\doxysubsubsection{Member Function Documentation}
\mbox{\label{classCppNoddy_1_1Example_1_1Neutral__residual_ad8b939b4d60c6b21daf96b3bf2e7fb7d}} 
\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}!residual\_fn@{residual\_fn}}
\index{residual\_fn@{residual\_fn}!CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
\doxyparagraph{residual\_fn()}
{\footnotesize\ttfamily void Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::residual\+\_\+fn (\begin{DoxyParamCaption}\item[{const \textbf{ Dense\+Vector}$<$ double $>$ \&}]{state,  }\item[{\textbf{ Dense\+Vector}$<$ double $>$ \&}]{f }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



A blank virtual residual function method. 


\begin{DoxyParams}{Parameters}
{\em state} & The unknown variable. \\
\hline
{\em f} & The residual function f(x). \\
\hline
\end{DoxyParams}


Reimplemented from \textbf{ Cpp\+Noddy\+::\+Residual$<$ double $>$} \doxyref{}{p.}{classCppNoddy_1_1Residual_a8016270e2cd26406a3681087f4a105c8}.



Definition at line 222 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{223       \{}
\DoxyCodeLine{224         Example::Re = z[ 0 ];}
\DoxyCodeLine{225         \textcolor{comment}{// solve the nonlinear BVP}}
\DoxyCodeLine{226         ode\_local -\/> solve2();}
\DoxyCodeLine{227         \textcolor{comment}{// return the residual}}
\DoxyCodeLine{228         f[ 0 ] = ode\_local -\/> solution()( 0, eval ).imag();}
\DoxyCodeLine{229         wave\_speed = ode\_local -\/> solution()( 0, eval ).real();}
\DoxyCodeLine{230       \}}

\end{DoxyCode}


References eval, f, Cpp\+Noddy\+::\+Utility\+::imag(), ode\+\_\+local, Cpp\+Noddy\+::\+Example\+::\+Re, Cpp\+Noddy\+::\+Utility\+::real(), Cpp\+Noddy\+::\+Example\+::wave\+\_\+speed, and Cpp\+Noddy\+::\+Example\+::z().



\doxysubsubsection{Member Data Documentation}
\mbox{\label{classCppNoddy_1_1Example_1_1Neutral__residual_af082f865e4e840ed7efdc6565e8ad1e3}} 
\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}!BC\_left@{BC\_left}}
\index{BC\_left@{BC\_left}!CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
\doxyparagraph{BC\_left}
{\footnotesize\ttfamily \textbf{ O\+S\+\_\+bvp\+\_\+left\+\_\+\+BC}$\ast$ Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::\+B\+C\+\_\+left}



Definition at line 234 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.



Referenced by Neutral\+\_\+residual(), and $\sim$\+Neutral\+\_\+residual().

\mbox{\label{classCppNoddy_1_1Example_1_1Neutral__residual_a337091a6d2e46cafe7e0bca204c08057}} 
\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}!BC\_right@{BC\_right}}
\index{BC\_right@{BC\_right}!CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
\doxyparagraph{BC\_right}
{\footnotesize\ttfamily \textbf{ O\+S\+\_\+bvp\+\_\+right\+\_\+\+BC}$\ast$ Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::\+B\+C\+\_\+right}



Definition at line 235 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.



Referenced by Neutral\+\_\+residual(), and $\sim$\+Neutral\+\_\+residual().

\mbox{\label{classCppNoddy_1_1Example_1_1Neutral__residual_a89001ab7542065819fe909f5f2d54cf0}} 
\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}!bvp@{bvp}}
\index{bvp@{bvp}!CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
\doxyparagraph{bvp}
{\footnotesize\ttfamily \textbf{ O\+S\+\_\+bvp\+\_\+equation}$\ast$ Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::bvp}



Definition at line 233 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.



Referenced by Neutral\+\_\+residual(), and $\sim$\+Neutral\+\_\+residual().

\mbox{\label{classCppNoddy_1_1Example_1_1Neutral__residual_a2a0002f722f3e1af9cd1f8cc1061f0fa}} 
\index{CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}!ode\_local@{ode\_local}}
\index{ode\_local@{ode\_local}!CppNoddy::Example::Neutral\_residual@{CppNoddy::Example::Neutral\_residual}}
\doxyparagraph{ode\_local}
{\footnotesize\ttfamily \textbf{ O\+D\+E\+\_\+\+B\+VP}$<$\textbf{ D\+\_\+complex}$>$$\ast$ Cpp\+Noddy\+::\+Example\+::\+Neutral\+\_\+residual\+::ode\+\_\+local}



Definition at line 232 of file E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp.



Referenced by Neutral\+\_\+residual(), residual\+\_\+fn(), and $\sim$\+Neutral\+\_\+residual().



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
Tests/\+E\+V\+P/\textbf{ E\+V\+P\+Orr\+Sommerfeld\+Neutral\+Curve\+\_\+lapack.\+cpp}\end{DoxyCompactItemize}
