\doxysubsection{Tests/\+Matrix/\+Matrix\+Sparse\+Solve\+\_\+petscz\+\_\+mklpardiso.cpp File Reference}
\label{MatrixSparseSolve__petscz__mklpardiso_8cpp}\index{Tests/Matrix/MatrixSparseSolve\_petscz\_mklpardiso.cpp@{Tests/Matrix/MatrixSparseSolve\_petscz\_mklpardiso.cpp}}
{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$Timer.\+h$>$}\newline
{\ttfamily \#include $<$Types.\+h$>$}\newline
{\ttfamily \#include $<$Utility.\+h$>$}\newline
{\ttfamily \#include $<$Sparse\+Linear\+System.\+h$>$}\newline
{\ttfamily \#include $<$Petsc\+Session.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} (int argc, char $\ast$argv[$\,$])
\end{DoxyCompactItemize}


\doxysubsubsection{Function Documentation}
\mbox{\label{MatrixSparseSolve__petscz__mklpardiso_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{MatrixSparseSolve\_petscz\_mklpardiso.cpp@{MatrixSparseSolve\_petscz\_mklpardiso.cpp}!main@{main}}
\index{main@{main}!MatrixSparseSolve\_petscz\_mklpardiso.cpp@{MatrixSparseSolve\_petscz\_mklpardiso.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv[$\,$] }\end{DoxyParamCaption})}



Definition at line 21 of file Matrix\+Sparse\+Solve\+\_\+petscz\+\_\+mklpardiso.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23   PetscSession::getInstance(argc,argv);}
\DoxyCodeLine{24   \textcolor{comment}{//auto session = PetscSession(argc,argv);}}
\DoxyCodeLine{25   \textcolor{comment}{//PetscInitialize(NULL,NULL,(char*)0,(char*)0);}}
\DoxyCodeLine{26   \textcolor{comment}{//}}
\DoxyCodeLine{27   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{28   cout << \textcolor{stringliteral}{"=== Matrix: Example linear sparse solver  ===========\(\backslash\)n"};}
\DoxyCodeLine{29   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   \textcolor{keywordtype}{bool} failed = \textcolor{keyword}{false};}
\DoxyCodeLine{32   \textcolor{comment}{// tolerance for the test}}
\DoxyCodeLine{33   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/10;}
\DoxyCodeLine{34 }
\DoxyCodeLine{35   \textcolor{comment}{//}}
\DoxyCodeLine{36   \textcolor{comment}{// SOLVE A SMALL "Sparse"(!) 2X2 COMPLEX SYSTEM}}
\DoxyCodeLine{37   cout << \textcolor{stringliteral}{"=== Matrix: complex  ==============================\(\backslash\)n"};}
\DoxyCodeLine{38   \textcolor{comment}{//}}
\DoxyCodeLine{39   SparseMatrix<D\_complex> A( 2, 2 );}
\DoxyCodeLine{40   DenseVector<D\_complex> B( 2, 0.0 );}
\DoxyCodeLine{41   A( 0, 0 ) = 1.;}
\DoxyCodeLine{42   A( 0, 1 ) = 2.;}
\DoxyCodeLine{43   A( 1, 0 ) = 3.;}
\DoxyCodeLine{44   A( 1, 1 ) = 4.;}
\DoxyCodeLine{45   B[ 0 ] = 5.;}
\DoxyCodeLine{46   B[ 1 ] = 11.;}
\DoxyCodeLine{47   \textcolor{comment}{//}}
\DoxyCodeLine{48   SparseLinearSystem<D\_complex> small\_system( \&A, \&B, \textcolor{stringliteral}{"petsc"} );}
\DoxyCodeLine{49 }
\DoxyCodeLine{50   \textcolor{keywordflow}{try}}
\DoxyCodeLine{51   \{}
\DoxyCodeLine{52     \textcolor{comment}{// below is equivalent to small\_system.solve();}}
\DoxyCodeLine{53     cout << \textcolor{stringliteral}{"Prefact\(\backslash\)n"};}
\DoxyCodeLine{54     small\_system.factorise();}
\DoxyCodeLine{55     cout << \textcolor{stringliteral}{"Postfact\(\backslash\)n"};}
\DoxyCodeLine{56     small\_system.solve\_using\_factorisation();}
\DoxyCodeLine{57     cout << \textcolor{stringliteral}{"Postsolve\(\backslash\)n"};}
\DoxyCodeLine{58   \}}
\DoxyCodeLine{59   \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{60   \{}
\DoxyCodeLine{61     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{62     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{63   \}}
\DoxyCodeLine{64   DenseVector<D\_complex> answer( 2, 0.0 );}
\DoxyCodeLine{65   answer[ 0 ] = 1.0;}
\DoxyCodeLine{66   answer[ 1 ] = 2.0;}
\DoxyCodeLine{67   B.sub( answer );}
\DoxyCodeLine{68   \textcolor{keywordflow}{if} ( B.inf\_norm() > tol )}
\DoxyCodeLine{69   \{}
\DoxyCodeLine{70     std::cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m Simple 2x2 complex sparse system was not solved correctly\(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{71     std::cout << \textcolor{stringliteral}{" residual vector's inf\_norm = "} << B.inf\_norm() << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{72     failed = \textcolor{keyword}{true};}
\DoxyCodeLine{73   \}}
\DoxyCodeLine{74   \textcolor{keywordflow}{else}}
\DoxyCodeLine{75   \{}
\DoxyCodeLine{76     std::cout << \textcolor{stringliteral}{" Simple 2x2 complex sparse solve works.\(\backslash\)n"};}
\DoxyCodeLine{77   \}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79   \textcolor{comment}{// double the RHS and try a resolve}}
\DoxyCodeLine{80   B[ 0 ] = 10.;}
\DoxyCodeLine{81   B[ 1 ] = 22.;}
\DoxyCodeLine{82   \textcolor{keywordflow}{try}}
\DoxyCodeLine{83   \{}
\DoxyCodeLine{84     small\_system.solve\_using\_factorisation();}
\DoxyCodeLine{85   \}}
\DoxyCodeLine{86   \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{87   \{}
\DoxyCodeLine{88     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{89     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{90   \}}
\DoxyCodeLine{91   answer[ 0 ] = 2.0;}
\DoxyCodeLine{92   answer[ 1 ] = 4.0;}
\DoxyCodeLine{93   B.sub( answer );}
\DoxyCodeLine{94   \textcolor{keywordflow}{if} ( B.inf\_norm() > tol )}
\DoxyCodeLine{95   \{}
\DoxyCodeLine{96     std::cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m Simple 2x2 complex sparse system was not solved correctly\(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{97     std::cout << \textcolor{stringliteral}{" residual vector's inf\_norm = "} << B.inf\_norm() << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{98     failed = \textcolor{keyword}{true};}
\DoxyCodeLine{99   \}}
\DoxyCodeLine{100   \textcolor{keywordflow}{else}}
\DoxyCodeLine{101   \{}
\DoxyCodeLine{102     std::cout << \textcolor{stringliteral}{" Simple 2x2 complex sparse solve\_using\_factorisation works.\(\backslash\)n"};}
\DoxyCodeLine{103   \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105   \textcolor{comment}{// Note: dtor will call cleanup anyway}}
\DoxyCodeLine{106   small\_system.cleanup();}
\DoxyCodeLine{107   \textcolor{comment}{// CONCLUDING PASS/FAIL}}
\DoxyCodeLine{108   \textcolor{comment}{//}}
\DoxyCodeLine{109   \textcolor{keywordflow}{if} ( failed )}
\DoxyCodeLine{110   \{}
\DoxyCodeLine{111     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{112     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{113   \}}
\DoxyCodeLine{114   \textcolor{keywordflow}{else}}
\DoxyCodeLine{115   \{}
\DoxyCodeLine{116     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{117     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{118   \}}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::\+A(), Cpp\+Noddy\+::\+Sparse\+Linear\+System$<$ \+\_\+\+Type $>$\+::cleanup(), Cpp\+Noddy\+::\+Sparse\+Linear\+System$<$ \+\_\+\+Type $>$\+::factorise(), Cpp\+Noddy\+::\+Example\+::failed, Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::inf\+\_\+norm(), Cpp\+Noddy\+::\+Sparse\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve\+\_\+using\+\_\+factorisation(), and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::sub().

