\doxysubsection{Cpp\+Noddy\+::H\+ST\+::Rayleigh$<$ \+\_\+\+Type $>$ Class Template Reference}
\label{classCppNoddy_1_1HST_1_1Rayleigh}\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}


{\ttfamily \#include $<$H\+S\+T.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Rayleigh} (\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type, \+\_\+\+Type $>$ \&base\+\_\+flow\+\_\+solution, double \&\textbf{ alpha}, const std\+::string \&right\+\_\+bc\+\_\+type=\char`\"{}BL\char`\"{})
\begin{DoxyCompactList}\small\item\em ctor -- either for a complex solution in the complex plane, or a double solution along the real line. \end{DoxyCompactList}\item 
void \textbf{ global\+\_\+evp} ()
\begin{DoxyCompactList}\small\item\em Solve the global eigenvalue problem for the \doxyref{Rayleigh}{p.}{classCppNoddy_1_1HST_1_1Rayleigh} equation by employing a second-\/order finite-\/difference matrix. \end{DoxyCompactList}\item 
void \textbf{ local\+\_\+evp} (std\+::size\+\_\+t i\+\_\+ev)
\begin{DoxyCompactList}\small\item\em Solve the E\+VP locally as a nonlinear B\+VP for just one mode. \end{DoxyCompactList}\item 
void \textbf{ remesh1} (const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type, \+\_\+\+Type $>$ \&new\+\_\+baseflow)
\begin{DoxyCompactList}\small\item\em Refine the E\+I\+G\+E\+N\+V\+E\+C\+T\+O\+RS mesh for a new baseflow. \end{DoxyCompactList}\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ std\+::complex$<$ double $>$, \+\_\+\+Type $>$ \& \textbf{ eigenvectors} ()
\begin{DoxyCompactList}\small\item\em A handle to the eigenvectors mesh. \end{DoxyCompactList}\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ std\+::complex$<$ double $>$ $>$ \textbf{ eigenvector} (unsigned i\+\_\+ev)
\item 
void \textbf{ iterate\+\_\+to\+\_\+neutral} (std\+::size\+\_\+t i\+\_\+ev)
\begin{DoxyCompactList}\small\item\em Iterate on the wavenumber A\+L\+P\+HA, using the local\+\_\+evp routine, to drive a selected eigenvalue to be neutral (ie. \end{DoxyCompactList}\item 
\textbf{ Dense\+Vector}$<$ std\+::complex$<$ double $>$ $>$ \& \textbf{ eigenvalues} ()
\begin{DoxyCompactList}\small\item\em A handle to the eigenvalues vector. \end{DoxyCompactList}\item 
double \& \textbf{ alpha} ()
\begin{DoxyCompactList}\small\item\em A handle to the wavenumber. \end{DoxyCompactList}\item 
void \textbf{ iterate\+\_\+to\+\_\+neutral} (std\+::size\+\_\+t i\+\_\+ev)
\item 
void \textbf{ iterate\+\_\+to\+\_\+neutral} (std\+::size\+\_\+t i\+\_\+ev)
\item 
void \textbf{ global\+\_\+evp} ()
\item 
void \textbf{ global\+\_\+evp} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::string \textbf{ R\+I\+G\+H\+T\+\_\+\+B\+C\+\_\+\+T\+Y\+PE}
\item 
double \textbf{ A\+L\+P\+HA}
\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type, \+\_\+\+Type $>$ \textbf{ B\+A\+S\+E\+F\+L\+OW}
\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ std\+::complex$<$ double $>$, \+\_\+\+Type $>$ \textbf{ E\+I\+G\+E\+N\+V\+E\+C\+T\+O\+RS}
\item 
\textbf{ Dense\+Vector}$<$ std\+::complex$<$ double $>$ $>$ \textbf{ E\+I\+G\+E\+N\+V\+A\+L\+U\+ES}
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
\subsubsection*{template$<$typename \+\_\+\+Type$>$\newline
class Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$}



Definition at line 18 of file H\+S\+T.\+h.



\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_aa34bad98d05e4a7444bf9fa18e7dfdcf}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!Rayleigh@{Rayleigh}}
\index{Rayleigh@{Rayleigh}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{Rayleigh()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::\textbf{ Rayleigh} (\begin{DoxyParamCaption}\item[{\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type, \+\_\+\+Type $>$ \&}]{base\+\_\+flow\+\_\+solution,  }\item[{double \&}]{alpha,  }\item[{const std\+::string \&}]{right\+\_\+bc\+\_\+type = {\ttfamily \char`\"{}BL\char`\"{}} }\end{DoxyParamCaption})}



ctor -- either for a complex solution in the complex plane, or a double solution along the real line. 


\begin{DoxyParams}{Parameters}
{\em base\+\_\+flow\+\_\+solution} & The base flow velocity profile and its curvature. \\
\hline
{\em alpha} & The wavenumber of the perturbation. \\
\hline
{\em right\+\_\+bc\+\_\+type} & Determines the choice of boundary condition. \char`\"{}\+B\+L\char`\"{} is a derivative condition, whilst \char`\"{}\+C\+H\+A\+N\+N\+E\+L\char`\"{} is a Dirichlet impermeability condition \\
\hline
\end{DoxyParams}


Definition at line 332 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{332                                                                                                                              \{}
\DoxyCodeLine{333       \textcolor{comment}{// protected data storage}}
\DoxyCodeLine{334       RIGHT\_BC\_TYPE = right\_bc\_type;}
\DoxyCodeLine{335       ALPHA = alpha;}
\DoxyCodeLine{336       BASEFLOW = base\_flow\_solution;}
\DoxyCodeLine{337       EIGENVALUES = DenseVector<std::complex<double> >(BASEFLOW.get\_nnodes(), 0.0);}
\DoxyCodeLine{338       EIGENVECTORS = OneD\_Node\_Mesh<std::complex<double>, \_Type>(BASEFLOW.nodes(), 1);}
\DoxyCodeLine{339     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::alpha.



\doxysubsubsection{Member Function Documentation}
\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_ac1ff98c55f3007f08ebc77e3f4fc9816}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!alpha@{alpha}}
\index{alpha@{alpha}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{alpha()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
double\& \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::alpha (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



A handle to the wavenumber. 

\begin{DoxyReturn}{Returns}
The wavenumber 
\end{DoxyReturn}


Definition at line 140 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{140                       \{}
\DoxyCodeLine{141         \textcolor{keywordflow}{return} ALPHA;}
\DoxyCodeLine{142       \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::\+A\+L\+P\+HA.



Referenced by main().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a0f746357e1300093c27b2dc1206c3d75}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!eigenvalues@{eigenvalues}}
\index{eigenvalues@{eigenvalues}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{eigenvalues()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Dense\+Vector}$<$std\+::complex$<$double$>$ $>$\& \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::eigenvalues (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



A handle to the eigenvalues vector. 

\begin{DoxyReturn}{Returns}
A vector of eigenvalues 
\end{DoxyReturn}


Definition at line 134 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{134                                                       \{}
\DoxyCodeLine{135         \textcolor{keywordflow}{return} EIGENVALUES;}
\DoxyCodeLine{136       \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::\+E\+I\+G\+E\+N\+V\+A\+L\+U\+ES.



Referenced by main().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a0c270aab882e225ebac8bacf682c03f5}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!eigenvector@{eigenvector}}
\index{eigenvector@{eigenvector}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{eigenvector()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$std\+::complex$<$double$>$ $>$ \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::eigenvector (\begin{DoxyParamCaption}\item[{unsigned}]{i\+\_\+ev }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Definition at line 118 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{118                                                                      \{}
\DoxyCodeLine{119         \textcolor{keywordtype}{unsigned} n(BASEFLOW.get\_nnodes());}
\DoxyCodeLine{120         OneD\_Node\_Mesh<std::complex<double> > temp(BASEFLOW.nodes(), 1);}
\DoxyCodeLine{121         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < n; ++i) \{}
\DoxyCodeLine{122           temp(i, 0) = EIGENVECTORS(i, i\_ev);}
\DoxyCodeLine{123         \}}
\DoxyCodeLine{124         \textcolor{keywordflow}{return} temp;}
\DoxyCodeLine{125       \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::\+B\+A\+S\+E\+F\+L\+OW, Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::\+E\+I\+G\+E\+N\+V\+E\+C\+T\+O\+RS, Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nnodes(), and Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::nodes().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_ade2a0c5cb4160138d1b35f4285d9e523}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!eigenvectors@{eigenvectors}}
\index{eigenvectors@{eigenvectors}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{eigenvectors()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$std\+::complex$<$double$>$, \+\_\+\+Type$>$\& \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::eigenvectors (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



A handle to the eigenvectors mesh. 

\begin{DoxyReturn}{Returns}
A mesh containing the eigenvectors, with the i-\/th variable corresponding to the i-\/th eigenvalue. 
\end{DoxyReturn}


Definition at line 114 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{114                                                                 \{}
\DoxyCodeLine{115         \textcolor{keywordflow}{return} EIGENVECTORS;}
\DoxyCodeLine{116       \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::\+E\+I\+G\+E\+N\+V\+E\+C\+T\+O\+RS.

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a58f653d3a8897a6f5be8d156d271e596}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!global\_evp@{global\_evp}}
\index{global\_evp@{global\_evp}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{global\_evp()\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::global\+\_\+evp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Solve the global eigenvalue problem for the \doxyref{Rayleigh}{p.}{classCppNoddy_1_1HST_1_1Rayleigh} equation by employing a second-\/order finite-\/difference matrix. 

The scheme allows for a non-\/uniform distribution of nodal points. 

Referenced by main().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_ad9b9e519b1233775c21ac2218ea980d1}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!global\_evp@{global\_evp}}
\index{global\_evp@{global\_evp}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{global\_evp()\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ double $>$\+::global\+\_\+evp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 428 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{428                                       \{}
\DoxyCodeLine{429       \textcolor{keywordtype}{unsigned} N(BASEFLOW.get\_nnodes());}
\DoxyCodeLine{430       \textcolor{comment}{// Rayleigh EVP -\/-\/ we'll keep it complex even though its extra work}}
\DoxyCodeLine{431       DenseMatrix<std::complex<double> > A(N, N, 0.0);}
\DoxyCodeLine{432       DenseMatrix<std::complex<double> > B(N, N, 0.0);}
\DoxyCodeLine{433       \textcolor{comment}{// f\_0 = 0}}
\DoxyCodeLine{434       A(0, 0) = 1.0;}
\DoxyCodeLine{435       B(0, 0) = 0.0;}
\DoxyCodeLine{436       \textcolor{comment}{// step through the interior nodes}}
\DoxyCodeLine{437       \textcolor{keywordflow}{for}(std::size\_t i = 1; i < N -\/ 1; ++i) \{}
\DoxyCodeLine{438 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{439         \textcolor{keyword}{const} \textcolor{keywordtype}{double} h1 = BASEFLOW.coord(1) -\/ BASEFLOW.coord(0);}
\DoxyCodeLine{440         \textcolor{keywordflow}{if}(std::abs(BASEFLOW.coord(i) -\/ BASEFLOW.coord(i -\/ 1) -\/ h1) > 1.e-\/12) \{}
\DoxyCodeLine{441           std::string problem;}
\DoxyCodeLine{442           problem = \textcolor{stringliteral}{" Warning: The Rayleigh.global\_evp method is only first order \(\backslash\)n"};}
\DoxyCodeLine{443           problem += \textcolor{stringliteral}{" on a non-\/uniform mesh.\(\backslash\)n"};}
\DoxyCodeLine{444           \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{445         \}}
\DoxyCodeLine{446 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{447         \textcolor{keywordtype}{double} h(BASEFLOW.coord(i) -\/ BASEFLOW.coord(i -\/ 1));}
\DoxyCodeLine{448         \textcolor{keywordtype}{double} k(BASEFLOW.coord(i + 1) -\/ BASEFLOW.coord(i));}
\DoxyCodeLine{449         \textcolor{keywordtype}{double} sigma(k / h);   \textcolor{comment}{// sigma = 1 => uniform mesh}}
\DoxyCodeLine{450         \textcolor{keywordtype}{double} y = BASEFLOW.coord(i);}
\DoxyCodeLine{451         \textcolor{keywordtype}{double} U = BASEFLOW.get\_interpolated\_vars(y)[ 0 ];}
\DoxyCodeLine{452         \textcolor{keywordtype}{double} Udd = BASEFLOW.get\_interpolated\_vars(y)[ 1 ];}
\DoxyCodeLine{453         \textcolor{keywordtype}{double} h2 = 0.5 * h * h * sigma * (sigma + 1.0);}
\DoxyCodeLine{454         A(i, i) = U * (-\/(sigma + 1.0) / h2 -\/ ALPHA * ALPHA) -\/ Udd;}
\DoxyCodeLine{455         A(i, i -\/ 1) = sigma * U / h2;}
\DoxyCodeLine{456         A(i, i + 1) = U / h2;}
\DoxyCodeLine{457         \textcolor{comment}{//}}
\DoxyCodeLine{458         B(i, i) = -\/ (sigma + 1.0) / h2 -\/ ALPHA * ALPHA;}
\DoxyCodeLine{459         B(i, i -\/ 1) = sigma / h2;}
\DoxyCodeLine{460         B(i, i + 1) = 1. / h2;}
\DoxyCodeLine{461       \}}
\DoxyCodeLine{462 }
\DoxyCodeLine{463       \textcolor{comment}{// 3 point backward difference the far-\/field in BL, but pin in channel}}
\DoxyCodeLine{464       \textcolor{keywordflow}{if}(RIGHT\_BC\_TYPE == \textcolor{stringliteral}{"BL"}) \{}
\DoxyCodeLine{465         \textcolor{keywordtype}{double} h = BASEFLOW.coord(N -\/ 2) -\/ BASEFLOW.coord(N -\/ 3);}
\DoxyCodeLine{466         \textcolor{keywordtype}{double} k = BASEFLOW.coord(N -\/ 1) -\/ BASEFLOW.coord(N -\/ 2);}
\DoxyCodeLine{467         \textcolor{comment}{//A( N -\/ 1, N -\/ 1 ) = -\/3.0 / ( 2 * h )-\/ alpha;}}
\DoxyCodeLine{468         \textcolor{comment}{//A( N -\/ 1, N -\/ 2 ) = 4.0 / ( 2 * h );}}
\DoxyCodeLine{469         \textcolor{comment}{//A( N -\/ 1, N -\/ 3 ) = -\/1.0 / ( 2 * h );}}
\DoxyCodeLine{470         A(N -\/ 1, N -\/ 1) = h * (h + k) / k * (-\/ 1. / (h * h) + 1. / ((h + k) * (h + k))) -\/ ALPHA;}
\DoxyCodeLine{471         A(N -\/ 1, N -\/ 2) = h * (h + k) / k * (1. / (h * h));}
\DoxyCodeLine{472         A(N -\/ 1, N -\/ 3) = h * (h + k) / k * (1. / ((h + k) * (h + k)));}
\DoxyCodeLine{473         B(N -\/ 1, N -\/ 1) = 0.0;}
\DoxyCodeLine{474       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(RIGHT\_BC\_TYPE == \textcolor{stringliteral}{"CHANNEL"}) \{}
\DoxyCodeLine{475         A(N -\/ 1, N -\/ 1) = 1.0;}
\DoxyCodeLine{476         B(N -\/ 1, N -\/ 1) = 0.0;}
\DoxyCodeLine{477       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{478         std::string problem;}
\DoxyCodeLine{479         problem = \textcolor{stringliteral}{" The Rayleigh.global\_evp\_uniform class has been called with an unknown string \(\backslash\)n"};}
\DoxyCodeLine{480         problem += \textcolor{stringliteral}{" that defines the far-\/field boundary condition."};}
\DoxyCodeLine{481         \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{482       \}}
\DoxyCodeLine{483       \textcolor{keywordtype}{double} U\_max(BASEFLOW(0, 0));}
\DoxyCodeLine{484       \textcolor{keywordtype}{double} U\_min(BASEFLOW(0, 0));}
\DoxyCodeLine{485       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 1; i < N; ++i) \{}
\DoxyCodeLine{486         U\_max = std::max(U\_max, BASEFLOW(i, 0));}
\DoxyCodeLine{487         U\_min = std::min(U\_min, BASEFLOW(i, 0));}
\DoxyCodeLine{488       \}}
\DoxyCodeLine{489 }
\DoxyCodeLine{490       DenseLinearEigenSystem<std::complex<double> > rayleigh\_evp(\&A, \&B);}
\DoxyCodeLine{491       rayleigh\_evp.eigensolve();}
\DoxyCodeLine{492       \textcolor{comment}{// return based on Howard's circle theorem}}
\DoxyCodeLine{493       rayleigh\_evp.set\_shift(std::complex<double> (0.5 * (U\_max + U\_min), 0.0));}
\DoxyCodeLine{494       rayleigh\_evp.tag\_eigenvalues\_disc(+1, 0.5 * (U\_max -\/ U\_min));}
\DoxyCodeLine{495       EIGENVALUES = rayleigh\_evp.get\_tagged\_eigenvalues();}
\DoxyCodeLine{496       DenseMatrix<std::complex<double> > eigenvecs\_mtx = rayleigh\_evp.get\_tagged\_eigenvectors();}
\DoxyCodeLine{497       \textcolor{comment}{// get eigenvectors}}
\DoxyCodeLine{498       EIGENVECTORS = OneD\_Node\_Mesh<std::complex<double>, \textcolor{keywordtype}{double}>(BASEFLOW.nodes(), N);}
\DoxyCodeLine{499       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} evec = 0; evec < EIGENVALUES.size(); ++evec) \{}
\DoxyCodeLine{500         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} node = 0; node < N; ++node) \{}
\DoxyCodeLine{501           EIGENVECTORS(node, evec) = eigenvecs\_mtx(evec, node);}
\DoxyCodeLine{502         \}}
\DoxyCodeLine{503       \}}
\DoxyCodeLine{504     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::\+A(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::eigensolve(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::get\+\_\+tagged\+\_\+eigenvalues(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::get\+\_\+tagged\+\_\+eigenvectors(), h, Cpp\+Noddy\+::\+Linear\+Eigen\+System\+\_\+base\+::set\+\_\+shift(), Cpp\+Noddy\+::\+Example\+::sigma(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::tag\+\_\+eigenvalues\+\_\+disc(), U, and Cpp\+Noddy\+::\+Example\+::\+Udd().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a762b5d3a37d6bf170ccb720cfd2215c2}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!global\_evp@{global\_evp}}
\index{global\_evp@{global\_evp}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{global\_evp()\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ std\+::complex$<$ double $>$ $>$\+::global\+\_\+evp (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 508 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{508                                                    \{}
\DoxyCodeLine{509       \textcolor{keywordtype}{unsigned} N(BASEFLOW.get\_nnodes());}
\DoxyCodeLine{510       \textcolor{comment}{// Rayleigh EVP}}
\DoxyCodeLine{511       DenseMatrix<std::complex<double> > A(N, N, 0.0);}
\DoxyCodeLine{512       DenseMatrix<std::complex<double> > B(N, N, 0.0);}
\DoxyCodeLine{513       \textcolor{comment}{// f\_0 = 0}}
\DoxyCodeLine{514       A(0, 0) = 1.0;}
\DoxyCodeLine{515       B(0, 0) = 0.0;}
\DoxyCodeLine{516       \textcolor{comment}{//const std::complex<double>  h1 = BASEFLOW.coord( 1 ) -\/ BASEFLOW.coord( 0 );}}
\DoxyCodeLine{517       \textcolor{comment}{// step through the interior nodes}}
\DoxyCodeLine{518       \textcolor{keywordflow}{for}(std::size\_t i = 1; i < N -\/ 1; ++i) \{}
\DoxyCodeLine{519 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{520         \textcolor{keyword}{const} \textcolor{keywordtype}{double} h1 = abs(BASEFLOW.coord(1) -\/ BASEFLOW.coord(0));}
\DoxyCodeLine{521         \textcolor{keywordflow}{if}(std::abs(BASEFLOW.coord(i) -\/ BASEFLOW.coord(i -\/ 1) -\/ h1) > 1.e-\/12) \{}
\DoxyCodeLine{522           std::string problem;}
\DoxyCodeLine{523           problem = \textcolor{stringliteral}{" Warning: The Rayleigh.global\_evp method is only first order \(\backslash\)n"};}
\DoxyCodeLine{524           problem += \textcolor{stringliteral}{" on a non-\/uniform mesh.\(\backslash\)n"};}
\DoxyCodeLine{525           \textcolor{comment}{//throw ExceptionRuntime( problem );}}
\DoxyCodeLine{526         \}}
\DoxyCodeLine{527 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{528         std::complex<double>  h(BASEFLOW.coord(i) -\/ BASEFLOW.coord(i -\/ 1));}
\DoxyCodeLine{529         std::complex<double>  k(BASEFLOW.coord(i + 1) -\/ BASEFLOW.coord(i));}
\DoxyCodeLine{530         std::complex<double>  sigma(k / h);   \textcolor{comment}{// sigma = 1 => uniform mesh}}
\DoxyCodeLine{531         std::complex<double>  y = BASEFLOW.coord(i);}
\DoxyCodeLine{532         std::complex<double>  U = BASEFLOW.get\_interpolated\_vars(y)[ 0 ];}
\DoxyCodeLine{533         std::complex<double>  Udd = BASEFLOW.get\_interpolated\_vars(y)[ 1 ];}
\DoxyCodeLine{534         std::complex<double>  h2 = 0.5 * h * h * sigma * (sigma + 1.0);}
\DoxyCodeLine{535         A(i, i) = U * (-\/(sigma + 1.0) / h2 -\/ ALPHA * ALPHA) -\/ Udd;}
\DoxyCodeLine{536         A(i, i -\/ 1) = sigma * U / h2;}
\DoxyCodeLine{537         A(i, i + 1) = U / h2;}
\DoxyCodeLine{538         \textcolor{comment}{//}}
\DoxyCodeLine{539         B(i, i) = -\/ (sigma + 1.0) / h2 -\/ ALPHA * ALPHA;}
\DoxyCodeLine{540         B(i, i -\/ 1) = sigma / h2;}
\DoxyCodeLine{541         B(i, i + 1) = 1. / h2;}
\DoxyCodeLine{542       \}}
\DoxyCodeLine{543 }
\DoxyCodeLine{544       \textcolor{comment}{// 3 point backward difference the far-\/field in BL, but pin in channel}}
\DoxyCodeLine{545       \textcolor{keywordflow}{if}(RIGHT\_BC\_TYPE == \textcolor{stringliteral}{"BL"}) \{}
\DoxyCodeLine{546         std::complex<double>  h = BASEFLOW.coord(N -\/ 2) -\/ BASEFLOW.coord(N -\/ 3);}
\DoxyCodeLine{547         std::complex<double>  k = BASEFLOW.coord(N -\/ 1) -\/ BASEFLOW.coord(N -\/ 2);}
\DoxyCodeLine{548         \textcolor{comment}{//A( N -\/ 1, N -\/ 1 ) = -\/3.0 / ( 2 * h )-\/ alpha;}}
\DoxyCodeLine{549         \textcolor{comment}{//A( N -\/ 1, N -\/ 2 ) = 4.0 / ( 2 * h );}}
\DoxyCodeLine{550         \textcolor{comment}{//A( N -\/ 1, N -\/ 3 ) = -\/1.0 / ( 2 * h );}}
\DoxyCodeLine{551         A(N -\/ 1, N -\/ 1) = h * (h + k) / k * (-\/ 1. / (h * h) + 1. / ((h + k) * (h + k))) -\/ ALPHA;}
\DoxyCodeLine{552         A(N -\/ 1, N -\/ 2) = h * (h + k) / k * (1. / (h * h));}
\DoxyCodeLine{553         A(N -\/ 1, N -\/ 3) = h * (h + k) / k * (1. / ((h + k) * (h + k)));}
\DoxyCodeLine{554         B(N -\/ 1, N -\/ 1) = 0.0;}
\DoxyCodeLine{555       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(RIGHT\_BC\_TYPE == \textcolor{stringliteral}{"CHANNEL"}) \{}
\DoxyCodeLine{556         A(N -\/ 1, N -\/ 1) = 1.0;}
\DoxyCodeLine{557         B(N -\/ 1, N -\/ 1) = 0.0;}
\DoxyCodeLine{558       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{559         std::string problem;}
\DoxyCodeLine{560         problem = \textcolor{stringliteral}{" The Rayleigh.global\_evp\_uniform class has been called with an unknown string \(\backslash\)n"};}
\DoxyCodeLine{561         problem += \textcolor{stringliteral}{" that defines the far-\/field boundary condition."};}
\DoxyCodeLine{562         \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{563       \}}
\DoxyCodeLine{564       \textcolor{keywordtype}{double} U\_max(BASEFLOW(0, 0).real());}
\DoxyCodeLine{565       \textcolor{keywordtype}{double} U\_min(BASEFLOW(0, 0).real());}
\DoxyCodeLine{566       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 1; i < N; ++i) \{}
\DoxyCodeLine{567         U\_max = std::max(U\_max, BASEFLOW(i, 0).real());}
\DoxyCodeLine{568         U\_min = std::min(U\_min, BASEFLOW(i, 0).real());}
\DoxyCodeLine{569       \}}
\DoxyCodeLine{570 }
\DoxyCodeLine{571       DenseLinearEigenSystem<std::complex<double> > rayleigh\_evp(\&A, \&B);}
\DoxyCodeLine{572       rayleigh\_evp.eigensolve();}
\DoxyCodeLine{573       \textcolor{comment}{// return based on Howard's circle theorem}}
\DoxyCodeLine{574       rayleigh\_evp.set\_shift(std::complex<double> (0.5 * (U\_max + U\_min), 0.0));}
\DoxyCodeLine{575       rayleigh\_evp.tag\_eigenvalues\_disc(+1, 0.5 * (U\_max -\/ U\_min));}
\DoxyCodeLine{576       EIGENVALUES = rayleigh\_evp.get\_tagged\_eigenvalues();}
\DoxyCodeLine{577       DenseMatrix<std::complex<double> > eigenvecs\_mtx = rayleigh\_evp.get\_tagged\_eigenvectors();}
\DoxyCodeLine{578       \textcolor{comment}{// get eigenvectors}}
\DoxyCodeLine{579       EIGENVECTORS = OneD\_Node\_Mesh<std::complex<double>, std::complex<double> >(BASEFLOW.nodes(), N);}
\DoxyCodeLine{580       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} evec = 0; evec < EIGENVALUES.size(); ++evec) \{}
\DoxyCodeLine{581         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} node = 0; node < N; ++node) \{}
\DoxyCodeLine{582           EIGENVECTORS(node, evec) = eigenvecs\_mtx(evec, node);}
\DoxyCodeLine{583         \}}
\DoxyCodeLine{584       \}}
\DoxyCodeLine{585     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::\+A(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::eigensolve(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::get\+\_\+tagged\+\_\+eigenvalues(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::get\+\_\+tagged\+\_\+eigenvectors(), h, Cpp\+Noddy\+::\+Utility\+::real(), Cpp\+Noddy\+::\+Linear\+Eigen\+System\+\_\+base\+::set\+\_\+shift(), Cpp\+Noddy\+::\+Example\+::sigma(), Cpp\+Noddy\+::\+Dense\+Linear\+Eigen\+System$<$ \+\_\+\+Type $>$\+::tag\+\_\+eigenvalues\+\_\+disc(), U, and Cpp\+Noddy\+::\+Example\+::\+Udd().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a09d7e010111c9bbc1dc2e0f0d9399faf}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!iterate\_to\_neutral@{iterate\_to\_neutral}}
\index{iterate\_to\_neutral@{iterate\_to\_neutral}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{iterate\_to\_neutral()\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::iterate\+\_\+to\+\_\+neutral (\begin{DoxyParamCaption}\item[{std\+::size\+\_\+t}]{i\+\_\+ev }\end{DoxyParamCaption})}



Iterate on the wavenumber A\+L\+P\+HA, using the local\+\_\+evp routine, to drive a selected eigenvalue to be neutral (ie. 

imaginary part is zero) 
\begin{DoxyParams}{Parameters}
{\em i\+\_\+ev} & The index of the eigenvalue to iterate on \\
\hline
\end{DoxyParams}


Referenced by main().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a858d83d0deac1cbfbab184f1937be27c}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!iterate\_to\_neutral@{iterate\_to\_neutral}}
\index{iterate\_to\_neutral@{iterate\_to\_neutral}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{iterate\_to\_neutral()\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ double $>$\+::iterate\+\_\+to\+\_\+neutral (\begin{DoxyParamCaption}\item[{std\+::size\+\_\+t}]{i\+\_\+ev }\end{DoxyParamCaption})}



Definition at line 351 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{351 \{\}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a68f2da73094e4d9b40e37fce93a4b257}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!iterate\_to\_neutral@{iterate\_to\_neutral}}
\index{iterate\_to\_neutral@{iterate\_to\_neutral}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{iterate\_to\_neutral()\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ std\+::complex$<$ double $>$ $>$\+::iterate\+\_\+to\+\_\+neutral (\begin{DoxyParamCaption}\item[{std\+::size\+\_\+t}]{i\+\_\+ev }\end{DoxyParamCaption})}



Definition at line 354 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{354                                                                          \{}
\DoxyCodeLine{355       \textcolor{keywordtype}{double} delta(1.e-\/8);}
\DoxyCodeLine{356       \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{357         std::cout << \textcolor{stringliteral}{"ALPHA = "} << ALPHA << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{358         local\_evp(i\_ev);}
\DoxyCodeLine{359         std::complex<double> copy\_of\_ev(EIGENVALUES[ i\_ev ]);}
\DoxyCodeLine{360         ALPHA += delta;}
\DoxyCodeLine{361         local\_evp(i\_ev);}
\DoxyCodeLine{362         ALPHA -\/= delta;}
\DoxyCodeLine{363         \textcolor{keywordtype}{double} d\_ev = (std::imag(EIGENVALUES[ i\_ev ]) -\/ std::imag(copy\_of\_ev)) / delta;}
\DoxyCodeLine{364         ALPHA -\/= std::imag(copy\_of\_ev) / d\_ev;}
\DoxyCodeLine{365         std::cout << \textcolor{stringliteral}{"ITERATING: "} << ALPHA << \textcolor{stringliteral}{" "} << EIGENVALUES[ i\_ev ] << \textcolor{stringliteral}{" "} << d\_ev << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{366       \} \textcolor{keywordflow}{while}(std::abs(std::imag(EIGENVALUES[ i\_ev ])) > 1.e-\/6);}
\DoxyCodeLine{367     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Utility\+::imag().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a96f99152757f5ee523dab0c57e3548ee}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!local\_evp@{local\_evp}}
\index{local\_evp@{local\_evp}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{local\_evp()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::local\+\_\+evp (\begin{DoxyParamCaption}\item[{std\+::size\+\_\+t}]{i\+\_\+ev }\end{DoxyParamCaption})}



Solve the E\+VP locally as a nonlinear B\+VP for just one mode. 

Again we employ a second-\/order accurate finite-\/difference scheme which allows for non-\/uniform distribution of nodal points. 
\begin{DoxyParams}{Parameters}
{\em i\+\_\+ev} & The index of the eigenvalue to solve for, based on the return from the global\+\_\+evp method. \\
\hline
\end{DoxyParams}


Definition at line 371 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{371                                                   \{}
\DoxyCodeLine{372       \textcolor{comment}{// number of nodes in the mesh}}
\DoxyCodeLine{373       std::size\_t N = BASEFLOW.get\_nnodes();}
\DoxyCodeLine{374       \textcolor{comment}{// formulate the Rayleigh equation as a BVP}}
\DoxyCodeLine{375       Rayleigh\_equation Rayleigh\_problem;}
\DoxyCodeLine{376       \textcolor{comment}{// boundary conditions}}
\DoxyCodeLine{377       Rayleigh\_left\_BC Rayleigh\_left;}
\DoxyCodeLine{378       Rayleigh\_right\_BC\_deriv Rayleigh\_right\_deriv;}
\DoxyCodeLine{379       Rayleigh\_right\_BC\_Dirichlet Rayleigh\_right\_Dirichlet;}
\DoxyCodeLine{380       \textcolor{comment}{// set the private member data in the objects}}
\DoxyCodeLine{381       Rayleigh\_problem.p\_BASEFLOW = \&BASEFLOW;}
\DoxyCodeLine{382       Rayleigh\_problem.p\_ALPHA = \&ALPHA;}
\DoxyCodeLine{383       Rayleigh\_right\_deriv.p\_ALPHA = \&ALPHA;}
\DoxyCodeLine{384 }
\DoxyCodeLine{385       \textcolor{comment}{// pointer to the equation}}
\DoxyCodeLine{386       ODE\_BVP<std::complex<double>, \_Type>* p\_Rayleigh;}
\DoxyCodeLine{387       \textcolor{keywordflow}{if}(RIGHT\_BC\_TYPE == \textcolor{stringliteral}{"BL"}) \{}
\DoxyCodeLine{388         p\_Rayleigh = \textcolor{keyword}{new} ODE\_BVP<std::complex<double>, \_Type>(\&Rayleigh\_problem, BASEFLOW.nodes(), \&Rayleigh\_left, \&Rayleigh\_right\_deriv);}
\DoxyCodeLine{389       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(RIGHT\_BC\_TYPE == \textcolor{stringliteral}{"CHANNEL"}) \{}
\DoxyCodeLine{390         p\_Rayleigh = \textcolor{keyword}{new} ODE\_BVP<std::complex<double>, \_Type>(\&Rayleigh\_problem, BASEFLOW.nodes(), \&Rayleigh\_left, \&Rayleigh\_right\_Dirichlet);}
\DoxyCodeLine{391       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{392         std::string problem;}
\DoxyCodeLine{393         problem = \textcolor{stringliteral}{" The Rayleigh.global\_evp\_uniform class has been called with an unknown string \(\backslash\)n"};}
\DoxyCodeLine{394         problem += \textcolor{stringliteral}{" that defines the far-\/field boundary condition."};}
\DoxyCodeLine{395         \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{396       \}}
\DoxyCodeLine{397 }
\DoxyCodeLine{398       p\_Rayleigh -\/> max\_itns() = 30;}
\DoxyCodeLine{399 }
\DoxyCodeLine{400       \textcolor{comment}{// set the initial guess using the global\_evp solve data}}
\DoxyCodeLine{401       p\_Rayleigh -\/> solution()(0, 0) = EIGENVECTORS(0, i\_ev);}
\DoxyCodeLine{402       p\_Rayleigh -\/> solution()(0, 1) = (EIGENVECTORS(1, i\_ev) -\/ EIGENVECTORS(0, i\_ev)) / (BASEFLOW.coord(1) -\/ BASEFLOW.coord(0));}
\DoxyCodeLine{403       p\_Rayleigh -\/> solution()(0, 2) = EIGENVALUES[ i\_ev ];}
\DoxyCodeLine{404       \textcolor{comment}{// set the (arbitrary) amplitude from the global\_evp solve data}}
\DoxyCodeLine{405       Rayleigh\_left.AMPLITUDE = p\_Rayleigh -\/> solution()(0, 1);}
\DoxyCodeLine{406       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 1; i < N -\/ 1; ++i) \{}
\DoxyCodeLine{407         p\_Rayleigh -\/> solution()(i, 0) = EIGENVECTORS(i, i\_ev);}
\DoxyCodeLine{408         p\_Rayleigh -\/> solution()(i, 1) = (EIGENVECTORS(i + 1, i\_ev) -\/ EIGENVECTORS(i -\/ 1, i\_ev)) / (BASEFLOW.coord(i + 1) -\/ BASEFLOW.coord(i -\/ 1));}
\DoxyCodeLine{409         p\_Rayleigh -\/> solution()(i, 2) = EIGENVALUES[ i\_ev ];}
\DoxyCodeLine{410       \}}
\DoxyCodeLine{411       p\_Rayleigh -\/> solution()(N -\/ 1, 0) = EIGENVECTORS(N -\/ 1, i\_ev);}
\DoxyCodeLine{412       p\_Rayleigh -\/> solution()(N -\/ 1, 1) = (EIGENVECTORS(N -\/ 1, i\_ev) -\/ EIGENVECTORS(N -\/ 2, i\_ev)) / (BASEFLOW.coord(N -\/ 1) -\/ BASEFLOW.coord(N -\/ 2));}
\DoxyCodeLine{413       p\_Rayleigh -\/> solution()(N -\/ 1, 2) = EIGENVALUES[ i\_ev ];}
\DoxyCodeLine{414 }
\DoxyCodeLine{415       \textcolor{comment}{// do a local solve}}
\DoxyCodeLine{416       p\_Rayleigh -\/> solve2();}
\DoxyCodeLine{417       \textcolor{comment}{// write the eigenvalue and eigenvector back to private member data store}}
\DoxyCodeLine{418       EIGENVALUES[ i\_ev ] = p\_Rayleigh -\/> solution()(0, 2);}
\DoxyCodeLine{419       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < N; ++i) \{}
\DoxyCodeLine{420         EIGENVECTORS(i, i\_ev) = p\_Rayleigh -\/> solution()(i, 0);}
\DoxyCodeLine{421       \}}
\DoxyCodeLine{422       \textcolor{comment}{// delete the equation object}}
\DoxyCodeLine{423       \textcolor{keyword}{delete} p\_Rayleigh;}
\DoxyCodeLine{424     \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a25280057ac16d1e0a6c733b4d547a578}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!remesh1@{remesh1}}
\index{remesh1@{remesh1}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{remesh1()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
void \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::remesh1 (\begin{DoxyParamCaption}\item[{const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type, \+\_\+\+Type $>$ \&}]{new\+\_\+baseflow }\end{DoxyParamCaption})}



Refine the E\+I\+G\+E\+N\+V\+E\+C\+T\+O\+RS mesh for a new baseflow. 

Useful following a global\+\_\+evp solve and prior to a local\+\_\+evp solve. 
\begin{DoxyParams}{Parameters}
{\em new\+\_\+baseflow} & A new mesh containing the base flow, we\textquotesingle{}ll linearly interpolate to this mesh \\
\hline
\end{DoxyParams}


Definition at line 343 of file H\+S\+T.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{343                                                                                   \{}
\DoxyCodeLine{344       \textcolor{comment}{// reset the baseflow mesh}}
\DoxyCodeLine{345       BASEFLOW = new\_baseflow;}
\DoxyCodeLine{346       \textcolor{comment}{// first order interpolation of the eigenvectors}}
\DoxyCodeLine{347       EIGENVECTORS.remesh1(BASEFLOW.nodes());}
\DoxyCodeLine{348     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::remesh1().



\doxysubsubsection{Member Data Documentation}
\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_adc6483c995f529d3355fdcaca9f2d651}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!ALPHA@{ALPHA}}
\index{ALPHA@{ALPHA}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{ALPHA}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
double \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::A\+L\+P\+HA\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 147 of file H\+S\+T.\+h.



Referenced by Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::alpha().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a87ab9275dce1b495e7aca60ed3cc7dc1}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!BASEFLOW@{BASEFLOW}}
\index{BASEFLOW@{BASEFLOW}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{BASEFLOW}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$\+\_\+\+Type, \+\_\+\+Type$>$ \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::B\+A\+S\+E\+F\+L\+OW\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 148 of file H\+S\+T.\+h.



Referenced by Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::eigenvector().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_ae828e1558d28dcf262681d6d73072229}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!EIGENVALUES@{EIGENVALUES}}
\index{EIGENVALUES@{EIGENVALUES}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{EIGENVALUES}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Dense\+Vector}$<$std\+::complex$<$double$>$ $>$ \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::E\+I\+G\+E\+N\+V\+A\+L\+U\+ES\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 150 of file H\+S\+T.\+h.



Referenced by Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::eigenvalues().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_a7b5637cf5dfc9230bac16c47a6256d53}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!EIGENVECTORS@{EIGENVECTORS}}
\index{EIGENVECTORS@{EIGENVECTORS}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{EIGENVECTORS}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$std\+::complex$<$double$>$, \+\_\+\+Type$>$ \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::E\+I\+G\+E\+N\+V\+E\+C\+T\+O\+RS\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 149 of file H\+S\+T.\+h.



Referenced by Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::eigenvector(), and Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh$<$ \+\_\+\+Type $>$\+::eigenvectors().

\mbox{\label{classCppNoddy_1_1HST_1_1Rayleigh_ab0509893963dc6d572dc216d836b7e58}} 
\index{CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}!RIGHT\_BC\_TYPE@{RIGHT\_BC\_TYPE}}
\index{RIGHT\_BC\_TYPE@{RIGHT\_BC\_TYPE}!CppNoddy::HST::Rayleigh$<$ \_Type $>$@{CppNoddy::HST::Rayleigh$<$ \_Type $>$}}
\doxyparagraph{RIGHT\_BC\_TYPE}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
std\+::string \textbf{ Cpp\+Noddy\+::\+H\+S\+T\+::\+Rayleigh}$<$ \+\_\+\+Type $>$\+::R\+I\+G\+H\+T\+\_\+\+B\+C\+\_\+\+T\+Y\+PE\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line 146 of file H\+S\+T.\+h.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
include/\textbf{ H\+S\+T.\+h}\end{DoxyCompactItemize}
