\doxysubsection{Tests/\+H\+Y\+P\+\_\+1\+D/\+H\+Y\+P\+Acoustic\+Impedance.cpp File Reference}
\label{HYPAcousticImpedance_8cpp}\index{Tests/HYP\_1D/HYPAcousticImpedance.cpp@{Tests/HYP\_1D/HYPAcousticImpedance.cpp}}
{\ttfamily \#include $<$One\+D\+\_\+\+H\+Y\+P\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Acoustic\+\_\+1d}
\begin{DoxyCompactList}\small\item\em Define the system. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ p}, 
\textbf{ u}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::K} (4.\+0)
\begin{DoxyCompactList}\small\item\em bulk modulus \end{DoxyCompactList}\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::rho\+\_\+big} (4.\+0)
\begin{DoxyCompactList}\small\item\em higher density \end{DoxyCompactList}\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::rho\+\_\+small} (1.\+0)
\begin{DoxyCompactList}\small\item\em lower density \end{DoxyCompactList}\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::rho} (const double \&x)
\begin{DoxyCompactList}\small\item\em Density function for the medium. \end{DoxyCompactList}\item 
void \textbf{ Cpp\+Noddy\+::\+Example\+::\+Q\+\_\+init} (const double \&x, \textbf{ Dense\+Vector}$<$ double $>$ \&q)
\begin{DoxyCompactList}\small\item\em Set the initial state of the system. \end{DoxyCompactList}\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solve the constant coefficient linear sound wave problem \[ p_t + K u_x = 0 \] \[ \rho u_t + p_x = 0 \] for a right-\/propagating square pressure pulse in a medium with constant bulk modulus $K=4$ and density $\rho = 1$ if $\vert x \vert < 1$ and $\rho = 4$ elsewhere. The (first) reflected wave\textquotesingle{}s velocity amplitude is \[ - \left ( \frac{\frac{K_1}{K_2}-\frac{c_1}{c_2}}{\frac{K_1}{K_2}+\frac{c_1}{c_2}} \right ) \] where $ K_{1,2} $ and $c_{1,2}$ are the bulk modulus and wave speed before and after the density interface, with $c_i = \sqrt{ K_i \rho_i } $. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{HYPAcousticImpedance_8cpp_a80155586fa275b28773c9b203f52caba}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{p@{p}!HYPAcousticImpedance.cpp@{HYPAcousticImpedance.cpp}}\index{HYPAcousticImpedance.cpp@{HYPAcousticImpedance.cpp}!p@{p}}}\mbox{\label{HYPAcousticImpedance_8cpp_a80155586fa275b28773c9b203f52cabaa188032b3e6837794e08d485d4426f1bb}} 
p&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{u@{u}!HYPAcousticImpedance.cpp@{HYPAcousticImpedance.cpp}}\index{HYPAcousticImpedance.cpp@{HYPAcousticImpedance.cpp}!u@{u}}}\mbox{\label{HYPAcousticImpedance_8cpp_a80155586fa275b28773c9b203f52cabaa63f235d4a03b00a5e43f0bfa785c853d}} 
u&\\
\hline

\end{DoxyEnumFields}


Definition at line 17 of file H\+Y\+P\+Acoustic\+Impedance.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{17 \{ p, u \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{HYPAcousticImpedance_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{HYPAcousticImpedance.cpp@{HYPAcousticImpedance.cpp}!main@{main}}
\index{main@{main}!HYPAcousticImpedance.cpp@{HYPAcousticImpedance.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 91 of file H\+Y\+P\+Acoustic\+Impedance.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{92 \{}
\DoxyCodeLine{93   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{94   cout << \textcolor{stringliteral}{"=== Hyperbolic: 1D acoustic wave, impedance problem =\(\backslash\)n"};}
\DoxyCodeLine{95   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{96 }
\DoxyCodeLine{97   \textcolor{comment}{// define the domain/mesh}}
\DoxyCodeLine{98   \textcolor{keyword}{const} \textcolor{keywordtype}{double} left =  -\/7.0;}
\DoxyCodeLine{99   \textcolor{keyword}{const} \textcolor{keywordtype}{double} right = 7.0;}
\DoxyCodeLine{100   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} N = 800;}
\DoxyCodeLine{101   DenseVector<double> faces\_x = Utility::uniform\_node\_vector( left, right, N );}
\DoxyCodeLine{102 }
\DoxyCodeLine{103   \textcolor{comment}{// time}}
\DoxyCodeLine{104   \textcolor{keywordtype}{double} t = 0.0;}
\DoxyCodeLine{105   \textcolor{keywordtype}{double} t\_end = 5.0;}
\DoxyCodeLine{106 }
\DoxyCodeLine{107   \textcolor{comment}{// hyperbolic problem}}
\DoxyCodeLine{108   Example::Acoustic\_1d conservative\_problem;}
\DoxyCodeLine{109   OneD\_TVDLF\_Mesh Acoustic\_mesh( faces\_x, \&conservative\_problem, Example::Q\_init );}
\DoxyCodeLine{110   Acoustic\_mesh.set\_limiter( 1 );}
\DoxyCodeLine{111 }
\DoxyCodeLine{112   \textcolor{comment}{// mesh \& test info}}
\DoxyCodeLine{113   \textcolor{keywordtype}{double} I1 = Acoustic\_mesh.integrate()[0];}
\DoxyCodeLine{114   \textcolor{keywordtype}{int} loop\_counter( 4 );}
\DoxyCodeLine{115   \textcolor{keywordtype}{int} file\_counter( 1 );}
\DoxyCodeLine{116 }
\DoxyCodeLine{117   std::string dirname(\textcolor{stringliteral}{"./DATA"});}
\DoxyCodeLine{118   mkdir( dirname.c\_str(), S\_IRWXU );}
\DoxyCodeLine{119   std::string filename\_stub;}
\DoxyCodeLine{120   filename\_stub = \textcolor{stringliteral}{"./DATA/HYP\_acoustic\_imp"};}
\DoxyCodeLine{121   TrackerFile my\_file( 5 );}
\DoxyCodeLine{122   OneD\_Node\_Mesh<double> soln = Acoustic\_mesh.get\_soln();}
\DoxyCodeLine{123   my\_file.push\_ptr( \&soln, \textcolor{stringliteral}{"mesh"} );}
\DoxyCodeLine{124 }
\DoxyCodeLine{125   \textcolor{keywordflow}{do}}
\DoxyCodeLine{126   \{}
\DoxyCodeLine{127     t += Acoustic\_mesh.update( 0.499, t\_end -\/ t );}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{keywordflow}{if} ( loop\_counter \% 2 == 0 )}
\DoxyCodeLine{130     \{}
\DoxyCodeLine{131       my\_file.set\_filename( filename\_stub + Utility::stringify( file\_counter ) + \textcolor{stringliteral}{".dat"} );}
\DoxyCodeLine{132       soln = Acoustic\_mesh.get\_soln();}
\DoxyCodeLine{133       my\_file.update();}
\DoxyCodeLine{134       file\_counter += 1;}
\DoxyCodeLine{135     \}}
\DoxyCodeLine{136     ++loop\_counter;}
\DoxyCodeLine{137 }
\DoxyCodeLine{138   \}}
\DoxyCodeLine{139   \textcolor{keywordflow}{while} ( ( t < t\_end ) \&\& ( loop\_counter < 1500 ) );}
\DoxyCodeLine{140 }
\DoxyCodeLine{141   soln = Acoustic\_mesh.get\_soln();}
\DoxyCodeLine{142   \textcolor{keywordtype}{double} I2 = Acoustic\_mesh.integrate()[0];}
\DoxyCodeLine{143   \textcolor{comment}{// the first reflected and first transmitted pulses can be determined explicitly.}}
\DoxyCodeLine{144   \textcolor{comment}{// they have amplitude ratios of 1/3 and 8/9ths of the input amplitude for the pressure.}}
\DoxyCodeLine{145   soln = Acoustic\_mesh.get\_soln();}
\DoxyCodeLine{146   \textcolor{keywordtype}{double} E1 = std::abs( soln.get\_interpolated\_vars( -\/5.0 )[0] -\/ 1. / 3. );}
\DoxyCodeLine{147   \textcolor{keywordtype}{double} E2 = std::abs( soln.get\_interpolated\_vars(  4.0 )[0] -\/ 8. / 9. );}
\DoxyCodeLine{148   \textcolor{keywordflow}{if} ( ( E1 > 1.e-\/4 ) || ( E2 > 1.e-\/4 ) || ( std::abs( I1 -\/ I2 ) > 1.e-\/8 ) || ( loop\_counter >= 1500 ) )}
\DoxyCodeLine{149   \{}
\DoxyCodeLine{150     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{151     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{152   \}}
\DoxyCodeLine{153   \textcolor{keywordflow}{else}}
\DoxyCodeLine{154   \{}
\DoxyCodeLine{155     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{156     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{157   \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 \} \textcolor{comment}{// end of main()}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+interpolated\+\_\+vars(), Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::get\+\_\+soln(), Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::integrate(), Cpp\+Noddy\+::\+Tracker\+File\+::push\+\_\+ptr(), Cpp\+Noddy\+::\+Example\+::\+Q\+\_\+init(), Cpp\+Noddy\+::\+Tracker\+File\+::set\+\_\+filename(), Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::set\+\_\+limiter(), Cpp\+Noddy\+::\+Utility\+::stringify(), Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector(), Cpp\+Noddy\+::\+Tracker\+File\+::update(), and Cpp\+Noddy\+::\+One\+D\+\_\+\+T\+V\+D\+L\+F\+\_\+\+Mesh\+::update().

