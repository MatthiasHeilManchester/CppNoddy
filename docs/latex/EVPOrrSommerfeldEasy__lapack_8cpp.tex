\doxysubsection{Tests/\+E\+V\+P/\+E\+V\+P\+Orr\+Sommerfeld\+Easy\+\_\+lapack.cpp File Reference}
\label{EVPOrrSommerfeldEasy__lapack_8cpp}\index{Tests/EVP/EVPOrrSommerfeldEasy\_lapack.cpp@{Tests/EVP/EVPOrrSommerfeldEasy\_lapack.cpp}}
{\ttfamily \#include $<$B\+V\+P\+\_\+bundle.\+h$>$}\newline
{\ttfamily \#include $<$E\+V\+P\+\_\+bundle.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../\+Utils\+\_\+\+Fill.\+h\char`\"{}}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+O\+S\+\_\+evp\+\_\+equation}
\begin{DoxyCompactList}\small\item\em Define the OS equation for the global QZ E\+VP. \end{DoxyCompactList}\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+O\+S\+\_\+bvp\+\_\+equation}
\begin{DoxyCompactList}\small\item\em Define the O\+SE for the local refinement procedure. \end{DoxyCompactList}\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+O\+S\+\_\+evp\+\_\+both\+\_\+\+BC}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+O\+S\+\_\+bvp\+\_\+left\+\_\+\+BC}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+O\+S\+\_\+bvp\+\_\+right\+\_\+\+BC}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \newline
\textbf{ phi}, 
\textbf{ phid}, 
\textbf{ psi}, 
\textbf{ psid}, 
\newline
\textbf{ eval}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::U} (double y)
\begin{DoxyCompactList}\small\item\em Globally define the base flow. \end{DoxyCompactList}\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::\+Udd} (double y)
\begin{DoxyCompactList}\small\item\em Globally define the base flow curvature. \end{DoxyCompactList}\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::\+Re}
\begin{DoxyCompactList}\small\item\em Globally define the Reynolds number and wavenumber. \end{DoxyCompactList}\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::alpha}
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solves the following linear eigenvalue problem for values $ c $ that satisfy \+: \[ \phi\textnormal{\textquotesingle}\textnormal{\textquotesingle}(y) - \alpha^2 \phi(y) - \psi(y) = 0\,, \] \[ \psi\textnormal{\textquotesingle}\textnormal{\textquotesingle}(y) - \alpha^2 \psi(y) - i \alpha Re \left \{ ( U(y) - c ) \psi(y) - U\textnormal{\textquotesingle}\textnormal{\textquotesingle}(y) \phi \right \} = 0\,, \] subject to $ \phi(\pm 1) = \phi\textnormal{\textquotesingle}(\pm 1) = 0 $ where $ \alpha = 1.02 $, $ Re = 5772.2 $ and $ U(y) = 1 - y^2 $. These values approximately correspond to the first neutral temporal mode in plane Poiseuille flow, therefore the test to be satisfied is that an eigenvalue exists with $ \Im ( c ) \approx 0 $. Here we use the O\+D\+E\+\_\+\+E\+VP class with a very low number of mesh points to get an approximation to the temporal spectrum of modes. The \textquotesingle{}most dangerous\textquotesingle{} mode is then extracted from this set, interpolated onto a M\+U\+CH finer mesh, and used as the initial guess in a nonlinear boundary-\/value problem using the O\+D\+E\+\_\+\+B\+VP class. This leads to a local refinement of the selected mode that could equally be applied to other eigenvalues very simply. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{EVPOrrSommerfeldEasy__lapack_8cpp_aba01db17f4a2bfbc3db60dc172972a25}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{phi@{phi}!EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}}\index{EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}!phi@{phi}}}\mbox{\label{EVPOrrSommerfeldEasy__lapack_8cpp_aba01db17f4a2bfbc3db60dc172972a25acc026b1a09b99cfe9d1eefb44256d4ec}} 
phi&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{phid@{phid}!EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}}\index{EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}!phid@{phid}}}\mbox{\label{EVPOrrSommerfeldEasy__lapack_8cpp_aba01db17f4a2bfbc3db60dc172972a25a565f63fd5fe9d086011a6489ab4369b4}} 
phid&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{psi@{psi}!EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}}\index{EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}!psi@{psi}}}\mbox{\label{EVPOrrSommerfeldEasy__lapack_8cpp_aba01db17f4a2bfbc3db60dc172972a25a9be8e27151f60f2ba6b17564b7e49c20}} 
psi&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{psid@{psid}!EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}}\index{EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}!psid@{psid}}}\mbox{\label{EVPOrrSommerfeldEasy__lapack_8cpp_aba01db17f4a2bfbc3db60dc172972a25a96c3bbc1cc198199156c725dbecfa8c2}} 
psid&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{eval@{eval}!EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}}\index{EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}!eval@{eval}}}\mbox{\label{EVPOrrSommerfeldEasy__lapack_8cpp_aba01db17f4a2bfbc3db60dc172972a25a821ca3ef81ef548a3d66c69bc183e647}} 
eval&\\
\hline

\end{DoxyEnumFields}


Definition at line 26 of file E\+V\+P\+Orr\+Sommerfeld\+Easy\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{26 \{ phi, phid, psi, psid, eval \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{EVPOrrSommerfeldEasy__lapack_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}!main@{main}}
\index{main@{main}!EVPOrrSommerfeldEasy\_lapack.cpp@{EVPOrrSommerfeldEasy\_lapack.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 161 of file E\+V\+P\+Orr\+Sommerfeld\+Easy\+\_\+lapack.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{162 \{}
\DoxyCodeLine{163   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{164   cout << \textcolor{stringliteral}{"=== EVP: Temporal OSE via the equation interface ====\(\backslash\)n"};}
\DoxyCodeLine{165   cout << \textcolor{stringliteral}{"===  followed by local refinement of the eigenvalue.\(\backslash\)n"};}
\DoxyCodeLine{166   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 }
\DoxyCodeLine{169   \textcolor{comment}{// instantiate the eigenproblem}}
\DoxyCodeLine{170   Example::OS\_evp\_equation evp;}
\DoxyCodeLine{171   \textcolor{comment}{// instantiate the boundary conditions -\/-\/ same applies at both boundaries}}
\DoxyCodeLine{172   Example::OS\_evp\_both\_BC BC\_both;}
\DoxyCodeLine{173   Example::Re = 5772.2;}
\DoxyCodeLine{174   Example::alpha = 1.02;}
\DoxyCodeLine{175   \textcolor{comment}{// domain is -\/1 to 1}}
\DoxyCodeLine{176   \textcolor{keywordtype}{double} left = -\/1.0;}
\DoxyCodeLine{177   \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{178   \textcolor{comment}{// number of nodal points}}
\DoxyCodeLine{179   \textcolor{keywordtype}{int} N = 32;}
\DoxyCodeLine{180   \textcolor{comment}{// mesh}}
\DoxyCodeLine{181   DenseVector<double> nodes( Utility::uniform\_node\_vector( left, right, N ) );}
\DoxyCodeLine{182 }
\DoxyCodeLine{183   \textcolor{comment}{// pass it to the ode}}
\DoxyCodeLine{184   ODE\_EVP<D\_complex> ode\_global( \&evp, nodes, \&BC\_both, \&BC\_both );}
\DoxyCodeLine{185   \textcolor{keywordflow}{try}}
\DoxyCodeLine{186   \{}
\DoxyCodeLine{187     \textcolor{comment}{// solve the global eigenvalue problem on ropey mesh}}
\DoxyCodeLine{188     ode\_global.eigensolve();}
\DoxyCodeLine{189   \}}
\DoxyCodeLine{190   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{191   \{}
\DoxyCodeLine{192     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{193     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{194   \}}
\DoxyCodeLine{195   \textcolor{comment}{// get the eigenvalues near the origin}}
\DoxyCodeLine{196   ode\_global.p\_eigensystem() -\/> tag\_eigenvalues\_disc( + 1, 0.6 );}
\DoxyCodeLine{197   \textcolor{comment}{// make a mesh of each tagged eigenmode in the ODE\_EVP class}}
\DoxyCodeLine{198   ode\_global.add\_tagged\_to\_mesh();}
\DoxyCodeLine{199 }
\DoxyCodeLine{200   \textcolor{comment}{// instantiate the nonlinear BVP formulation}}
\DoxyCodeLine{201   Example::OS\_bvp\_equation bvp;}
\DoxyCodeLine{202   \textcolor{comment}{// instantiate the BCs}}
\DoxyCodeLine{203   Example::OS\_bvp\_left\_BC BC\_left;}
\DoxyCodeLine{204   Example::OS\_bvp\_right\_BC BC\_right;}
\DoxyCodeLine{205   \textcolor{comment}{// pass it to the ode BVP solver}}
\DoxyCodeLine{206   ODE\_BVP<D\_complex> ode\_local( \&bvp, nodes, \&BC\_left, \&BC\_right );}
\DoxyCodeLine{207   \textcolor{comment}{// use our not-\/great initial guess from QZ code to start the solver off}}
\DoxyCodeLine{208   \textcolor{comment}{// here we just use the first (0) tagged eigenvalue}}
\DoxyCodeLine{209   ode\_local.solution() = ode\_global.get\_mesh( 0 );}
\DoxyCodeLine{210   \textcolor{comment}{// interpolate onto a finer mesh}}
\DoxyCodeLine{211   ode\_local.solution().remesh1( Utility::uniform\_node\_vector( left, right, 1024 ) );}
\DoxyCodeLine{212   ode\_local.set\_monitor\_det( \textcolor{keyword}{false} );}
\DoxyCodeLine{213   \textcolor{comment}{// solve the nonlinear BVP}}
\DoxyCodeLine{214   ode\_local.solve2();}
\DoxyCodeLine{215   \textcolor{comment}{// check the eigenvalue}}
\DoxyCodeLine{216   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/4;}
\DoxyCodeLine{217   \textcolor{keywordflow}{if} ( abs( ode\_local.solution()( 0, eval ).imag() ) < tol )}
\DoxyCodeLine{218   \{}
\DoxyCodeLine{219     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{220     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{221   \}}
\DoxyCodeLine{222   cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{223   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{224 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::add\+\_\+tagged\+\_\+to\+\_\+mesh(), Cpp\+Noddy\+::\+Example\+::alpha, Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::eigensolve(), eval, Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::get\+\_\+mesh(), Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+E\+V\+P$<$ \+\_\+\+Type $>$\+::p\+\_\+eigensystem(), Cpp\+Noddy\+::\+Example\+::\+Re, Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::remesh1(), Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::set\+\_\+monitor\+\_\+det(), Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::solution(), Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::solve2(), and Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector().

