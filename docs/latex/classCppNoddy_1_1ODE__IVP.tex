\doxysubsection{Cpp\+Noddy\+::O\+D\+E\+\_\+\+I\+VP$<$ \+\_\+\+Type $>$ Class Template Reference}
\label{classCppNoddy_1_1ODE__IVP}\index{CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}}


A templated object for real/complex vector system of first-\/order ordinary differential equations.  




{\ttfamily \#include $<$O\+D\+E\+\_\+\+I\+V\+P.\+h$>$}

Inheritance diagram for Cpp\+Noddy\+::O\+D\+E\+\_\+\+I\+VP$<$ \+\_\+\+Type $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classCppNoddy_1_1ODE__IVP}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ O\+D\+E\+\_\+\+I\+VP} (\textbf{ Equation}$<$ \+\_\+\+Type $>$ $\ast$equation\+\_\+ptr, const double \&x\+\_\+init, const double \&x\+\_\+final, const std\+::size\+\_\+t \&num\+\_\+of\+\_\+steps)
\begin{DoxyCompactList}\small\item\em The class is defined by a vector function for the system. \end{DoxyCompactList}\item 
\textbf{ $\sim$\+O\+D\+E\+\_\+\+I\+VP} ()
\item 
\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \textbf{ shoot4} (\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \textbf{ u})
\begin{DoxyCompactList}\small\item\em A fixed step 4th order Runge-\/\+Kutta method. \end{DoxyCompactList}\item 
\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \textbf{ shoot45} (\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \textbf{ u}, const double \&tol, const double \&h\+\_\+init)
\begin{DoxyCompactList}\small\item\em A Runge-\/\+Kutta-\/\+Fehlberg integrator. \end{DoxyCompactList}\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type $>$ \& \textbf{ get\+\_\+mesh} ()
\begin{DoxyCompactList}\small\item\em Return the history of the stepped solution. \end{DoxyCompactList}\item 
unsigned \& \textbf{ store\+\_\+every} ()
\begin{DoxyCompactList}\small\item\em Return a handle to the S\+T\+O\+R\+E\+\_\+\+E\+V\+E\+RY object. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
\subsubsection*{template$<$typename \+\_\+\+Type$>$\newline
class Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+V\+P$<$ \+\_\+\+Type $>$}

A templated object for real/complex vector system of first-\/order ordinary differential equations. 

Definition at line 20 of file O\+D\+E\+\_\+\+I\+V\+P.\+h.



\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\label{classCppNoddy_1_1ODE__IVP_ae1e008c6a48dfc28f20cb0602d7f7e6a}} 
\index{CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}!ODE\_IVP@{ODE\_IVP}}
\index{ODE\_IVP@{ODE\_IVP}!CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}}
\doxyparagraph{ODE\_IVP()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+VP}$<$ \+\_\+\+Type $>$\+::\textbf{ O\+D\+E\+\_\+\+I\+VP} (\begin{DoxyParamCaption}\item[{\textbf{ Equation}$<$ \+\_\+\+Type $>$ $\ast$}]{equation\+\_\+ptr,  }\item[{const double \&}]{x\+\_\+init,  }\item[{const double \&}]{x\+\_\+final,  }\item[{const std\+::size\+\_\+t \&}]{num\+\_\+of\+\_\+steps }\end{DoxyParamCaption})}



The class is defined by a vector function for the system. 


\begin{DoxyParams}{Parameters}
{\em equation\+\_\+ptr} & A pointer to an inherited \doxyref{Equation}{p.}{classCppNoddy_1_1Equation} object. \\
\hline
{\em x\+\_\+init} & The starting point of the domain for the O\+DE. \\
\hline
{\em x\+\_\+final} & The end point of the domain for the O\+DE. \\
\hline
{\em num\+\_\+of\+\_\+steps} & A maximum/default number of steps to be taken. \\
\hline
\end{DoxyParams}


Definition at line 19 of file O\+D\+E\+\_\+\+I\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{21                                                           :}
\DoxyCodeLine{22     X\_INIT(x1),}
\DoxyCodeLine{23     X\_FINAL(x2),}
\DoxyCodeLine{24     H\_INIT((x2 -\/ x1) / num\_of\_points),}
\DoxyCodeLine{25     N(num\_of\_points),}
\DoxyCodeLine{26     p\_EQUATION(ptr),}
\DoxyCodeLine{27     STORE\_EVERY(1) \{}
\DoxyCodeLine{28     p\_EQUATION -\/> coord(0) = X\_INIT;}
\DoxyCodeLine{29   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1ODE__IVP_ace13c1e9d0f770e32f2b6328015412f9}} 
\index{CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}!````~ODE\_IVP@{$\sim$ODE\_IVP}}
\index{````~ODE\_IVP@{$\sim$ODE\_IVP}!CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}}
\doxyparagraph{$\sim$ODE\_IVP()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+VP}$<$ \+\_\+\+Type $>$\+::$\sim$\textbf{ O\+D\+E\+\_\+\+I\+VP}}



Definition at line 32 of file O\+D\+E\+\_\+\+I\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{33   \{\}}

\end{DoxyCode}


\doxysubsubsection{Member Function Documentation}
\mbox{\label{classCppNoddy_1_1ODE__IVP_a77430130ea310e31ed076c120bc03165}} 
\index{CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}!get\_mesh@{get\_mesh}}
\index{get\_mesh@{get\_mesh}!CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}}
\doxyparagraph{get\_mesh()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \+\_\+\+Type $>$ \& \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+VP}$<$ \+\_\+\+Type $>$\+::get\+\_\+mesh}



Return the history of the stepped solution. 

\begin{DoxyReturn}{Returns}
A reference to the mesh solution 
\end{DoxyReturn}


Definition at line 242 of file O\+D\+E\+\_\+\+I\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{242                                                   \{}
\DoxyCodeLine{243     \textcolor{keywordflow}{return} SOLN;}
\DoxyCodeLine{244   \}}

\end{DoxyCode}


Referenced by main().

\mbox{\label{classCppNoddy_1_1ODE__IVP_af1865f3362904f3d58f34444bf6f41d7}} 
\index{CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}!shoot4@{shoot4}}
\index{shoot4@{shoot4}!CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}}
\doxyparagraph{shoot4()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+VP}$<$ \+\_\+\+Type $>$\+::shoot4 (\begin{DoxyParamCaption}\item[{\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$}]{u }\end{DoxyParamCaption})}



A fixed step 4th order Runge-\/\+Kutta method. 


\begin{DoxyParams}{Parameters}
{\em u} & An N\+Vector of initial values. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An N\+Vector of the final values. 
\end{DoxyReturn}


Definition at line 36 of file O\+D\+E\+\_\+\+I\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{36                                                                 \{}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \textcolor{keywordtype}{double} x = X\_INIT;}
\DoxyCodeLine{39     \textcolor{keyword}{const} \textcolor{keywordtype}{double} h = H\_INIT;}
\DoxyCodeLine{40     \textcolor{keyword}{const} \textcolor{keywordtype}{double} hby2 = h / 2.;}
\DoxyCodeLine{41     \textcolor{keyword}{const} \textcolor{keywordtype}{double} hby6 = h / 6.;}
\DoxyCodeLine{42     \textcolor{keyword}{const} \textcolor{keywordtype}{double} hby3 = h / 3.;}
\DoxyCodeLine{43     \textcolor{keyword}{const} \textcolor{keywordtype}{int} order = u.size();}
\DoxyCodeLine{44 }
\DoxyCodeLine{45     DenseVector<\_Type> z(order, 0.0), k1(order, 0.0), k2(order, 0.0), k3(order, 0.0), k4(order, 0.0);}
\DoxyCodeLine{46 }
\DoxyCodeLine{47     DenseVector< double > coords;}
\DoxyCodeLine{48     std::vector< DenseVector<\_Type> > values;}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     coords.push\_back(x);}
\DoxyCodeLine{51     values.push\_back(u);}
\DoxyCodeLine{52 }
\DoxyCodeLine{53     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < N; i++) \{}
\DoxyCodeLine{54       \textcolor{comment}{// k1 = F(u,x)}}
\DoxyCodeLine{55       p\_EQUATION -\/> coord(0) = x;}
\DoxyCodeLine{56       p\_EQUATION -\/> residual\_fn(u, k1);}
\DoxyCodeLine{57       z = u + k1 * hby2;}
\DoxyCodeLine{58 }
\DoxyCodeLine{59       x += hby2;}
\DoxyCodeLine{60 }
\DoxyCodeLine{61       \textcolor{comment}{// k2 = F(z,xhh)}}
\DoxyCodeLine{62       p\_EQUATION -\/> coord(0) = x;}
\DoxyCodeLine{63       p\_EQUATION -\/> residual\_fn(z, k2);}
\DoxyCodeLine{64       z = u + k2 * hby2;}
\DoxyCodeLine{65 }
\DoxyCodeLine{66       \textcolor{comment}{// k3 = F(z,xhh)}}
\DoxyCodeLine{67       p\_EQUATION -\/> coord(0) = x;}
\DoxyCodeLine{68       p\_EQUATION -\/> residual\_fn(z, k3);}
\DoxyCodeLine{69       z = u + k3 * h;}
\DoxyCodeLine{70 }
\DoxyCodeLine{71       x += hby2;}
\DoxyCodeLine{72 }
\DoxyCodeLine{73       \textcolor{comment}{// k4 = F(z,xh)}}
\DoxyCodeLine{74       p\_EQUATION -\/> coord(0) = x;}
\DoxyCodeLine{75       p\_EQUATION -\/> residual\_fn(z, k4);}
\DoxyCodeLine{76       u += k1 * hby6 + k2 * hby3 + k3 * hby3 + k4 * hby6;}
\DoxyCodeLine{77 }
\DoxyCodeLine{78       \textcolor{keywordflow}{if}(i \% STORE\_EVERY == 0) \{}
\DoxyCodeLine{79         coords.push\_back(x);}
\DoxyCodeLine{80         values.push\_back(u);}
\DoxyCodeLine{81       \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     \} \textcolor{comment}{//for loop stepping across domain}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85     \textcolor{comment}{// construct the solution mesh stored in this object}}
\DoxyCodeLine{86     SOLN = OneD\_Node\_Mesh<\_Type>(coords, p\_EQUATION -\/> get\_order());}
\DoxyCodeLine{87     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < coords.size(); ++i) \{}
\DoxyCodeLine{88       \textcolor{comment}{// fill mesh}}
\DoxyCodeLine{89       SOLN.set\_nodes\_vars(i, values[i]);}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91     \textcolor{keywordflow}{return} u;}
\DoxyCodeLine{92   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1ODE__IVP_af45fe967dac3b49957363f05f615ae01}} 
\index{CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}!shoot45@{shoot45}}
\index{shoot45@{shoot45}!CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}}
\doxyparagraph{shoot45()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+VP}$<$ \+\_\+\+Type $>$\+::shoot45 (\begin{DoxyParamCaption}\item[{\textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$}]{u,  }\item[{const double \&}]{tol,  }\item[{const double \&}]{h\+\_\+init }\end{DoxyParamCaption})}



A Runge-\/\+Kutta-\/\+Fehlberg integrator. 


\begin{DoxyParams}{Parameters}
{\em u} & An Nvector of initial values. \\
\hline
{\em tol} & The tolerance used in choosing the step length. \\
\hline
{\em h\+\_\+init} & The initial step length. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An N\+Vector of the final values. 
\end{DoxyReturn}


Definition at line 95 of file O\+D\+E\+\_\+\+I\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{95                                                                                                           \{}
\DoxyCodeLine{96     \textcolor{keywordtype}{bool} ok(\textcolor{keyword}{false});}
\DoxyCodeLine{97     \textcolor{keywordtype}{unsigned} step = 0;}
\DoxyCodeLine{98     \textcolor{keywordtype}{double} x = X\_INIT;}
\DoxyCodeLine{99     \textcolor{keywordtype}{double} h = h\_init;}
\DoxyCodeLine{100     \textcolor{keywordtype}{double} c, diff;}
\DoxyCodeLine{101 }
\DoxyCodeLine{102     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} X2 = 1. / 4.;}
\DoxyCodeLine{103     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} X3 = 3. / 8.;}
\DoxyCodeLine{104     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} X4 = 12. / 13.;}
\DoxyCodeLine{105     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} X5 = 1.;}
\DoxyCodeLine{106     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} X6 = 1. / 2.;}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W21 = 1. / 4.;}
\DoxyCodeLine{109 }
\DoxyCodeLine{110     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W31 = 3. / 32.;}
\DoxyCodeLine{111     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W32 = 9. / 32.;}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W41 = 1932. / 2197.;}
\DoxyCodeLine{114     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W42 = -\/7200. / 2197.;}
\DoxyCodeLine{115     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W43 = 7296. / 2197.;}
\DoxyCodeLine{116 }
\DoxyCodeLine{117     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W51 = 439. / 216.;}
\DoxyCodeLine{118     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W52 = -\/8.;}
\DoxyCodeLine{119     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W53 = 3680. / 513.;}
\DoxyCodeLine{120     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W54 = -\/845. / 4104;}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W61 = -\/8. / 27.;}
\DoxyCodeLine{123     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W62 = 2.;}
\DoxyCodeLine{124     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W63 = -\/3544. / 2565.;}
\DoxyCodeLine{125     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W64 = 1859. / 4104.;}
\DoxyCodeLine{126     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W65 = -\/11. / 40.;}
\DoxyCodeLine{127 }
\DoxyCodeLine{128     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} U1 = 25. / 216.;}
\DoxyCodeLine{129     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} U3 = 1408. / 2565.;}
\DoxyCodeLine{130     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} U4 = 2197. / 4104.;}
\DoxyCodeLine{131     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} U5 = -\/1. / 5.;}
\DoxyCodeLine{132 }
\DoxyCodeLine{133     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} Z1 = 16. / 135.;}
\DoxyCodeLine{134     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} Z3 = 6656. / 12825.;}
\DoxyCodeLine{135     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} Z4 = 28561. / 56430.;}
\DoxyCodeLine{136     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} Z5 = -\/9. / 50.;}
\DoxyCodeLine{137     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} Z6 = 2. / 55.;}
\DoxyCodeLine{138 }
\DoxyCodeLine{139     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} order = u.size();}
\DoxyCodeLine{140 }
\DoxyCodeLine{141     DenseVector<\_Type> z(order, 0.0), e(order, 0.0), k1(order, 0.0),}
\DoxyCodeLine{142                 k2(order, 0.0), k3(order, 0.0), k4(order, 0.0), k5(order, 0.0), k6(order, 0.0);}
\DoxyCodeLine{143 }
\DoxyCodeLine{144     DenseVector< double > coords;}
\DoxyCodeLine{145     std::vector< DenseVector<\_Type> > values;}
\DoxyCodeLine{146 }
\DoxyCodeLine{147     coords.push\_back(x);}
\DoxyCodeLine{148     values.push\_back(u);}
\DoxyCodeLine{149 }
\DoxyCodeLine{150     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{151       step += 1;}
\DoxyCodeLine{152       \textcolor{comment}{// k1 = F(u,x)}}
\DoxyCodeLine{153       p\_EQUATION -\/> coord(0) = x;}
\DoxyCodeLine{154       p\_EQUATION -\/> residual\_fn(u, k1);}
\DoxyCodeLine{155       k1 *= h;}
\DoxyCodeLine{156       z = u + k1 * W21;}
\DoxyCodeLine{157 }
\DoxyCodeLine{158       \textcolor{comment}{// k2 = F(z,x+X2*h)}}
\DoxyCodeLine{159       p\_EQUATION -\/> coord(0) = x + X2 * h;}
\DoxyCodeLine{160       p\_EQUATION -\/> residual\_fn(z, k2);}
\DoxyCodeLine{161       k2 *= h;}
\DoxyCodeLine{162       z = u + k1 * W31 + k2 * W32;}
\DoxyCodeLine{163 }
\DoxyCodeLine{164       \textcolor{comment}{// k3 = F(z,x+X3*h)}}
\DoxyCodeLine{165       p\_EQUATION -\/> coord(0) = x + X3 * h;}
\DoxyCodeLine{166       p\_EQUATION -\/> residual\_fn(z, k3);}
\DoxyCodeLine{167       k3 *= h;}
\DoxyCodeLine{168       z = u + k1 * W41 + k2 * W42 + k3 * W43;}
\DoxyCodeLine{169 }
\DoxyCodeLine{170       \textcolor{comment}{// k4 = F(z,x+X4*h)}}
\DoxyCodeLine{171       p\_EQUATION -\/> coord(0) = x + X4 * h;}
\DoxyCodeLine{172       p\_EQUATION -\/> residual\_fn(z, k4);}
\DoxyCodeLine{173       k4 *= h;}
\DoxyCodeLine{174       z = u + k1 * W51 + k2 * W52 + k3 * W53 + k4 * W54;}
\DoxyCodeLine{175 }
\DoxyCodeLine{176       \textcolor{comment}{// k5 = F(z,x+X5*h)}}
\DoxyCodeLine{177       p\_EQUATION -\/> coord(0) = x + X5 * h;}
\DoxyCodeLine{178       p\_EQUATION -\/> residual\_fn(z, k5);}
\DoxyCodeLine{179       k5 *= h;}
\DoxyCodeLine{180       z = u + k1 * W61 + k2 * W62 + k3 * W63 + k4 * W64 + k5 * W65;}
\DoxyCodeLine{181 }
\DoxyCodeLine{182       \textcolor{comment}{// k6 = F(z,x+X6*h)}}
\DoxyCodeLine{183       p\_EQUATION -\/> coord(0) = x + X6 * h;}
\DoxyCodeLine{184       p\_EQUATION -\/> residual\_fn(z, k6);}
\DoxyCodeLine{185       k6 *= h;}
\DoxyCodeLine{186 }
\DoxyCodeLine{187       e = k1 * U1 + k3 * U3 + k4 * U4 + k5 * U5;}
\DoxyCodeLine{188       z = k1 * Z1 + k3 * Z3 + k4 * Z4 + k5 * Z5 + k6 * Z6;}
\DoxyCodeLine{189 }
\DoxyCodeLine{190       e -\/= z;}
\DoxyCodeLine{191 }
\DoxyCodeLine{192       diff = e.inf\_norm();}
\DoxyCodeLine{193 }
\DoxyCodeLine{194       c = sqrt(sqrt(tol * h / (2 * diff)));}
\DoxyCodeLine{195       ok = \textcolor{keyword}{true};}
\DoxyCodeLine{196 }
\DoxyCodeLine{197       \textcolor{comment}{// is the first step ok? or does it need reducing?}}
\DoxyCodeLine{198       \textcolor{keywordflow}{if}((step == 1) \&\& (c < 1.0)) \{}
\DoxyCodeLine{199         \textcolor{comment}{// step needs reducing so start from initial value again}}
\DoxyCodeLine{200         ok = \textcolor{keyword}{false};}
\DoxyCodeLine{201         step = 1;}
\DoxyCodeLine{202       \}}
\DoxyCodeLine{203 }
\DoxyCodeLine{204 }
\DoxyCodeLine{205       \textcolor{keywordflow}{if}(ok) \{}
\DoxyCodeLine{206         x += h;}
\DoxyCodeLine{207         u += z;}
\DoxyCodeLine{208 }
\DoxyCodeLine{209         \textcolor{keywordflow}{if}(step \% STORE\_EVERY == 0) \{}
\DoxyCodeLine{210           coords.push\_back(x);}
\DoxyCodeLine{211           values.push\_back(u);}
\DoxyCodeLine{212         \}}
\DoxyCodeLine{213 }
\DoxyCodeLine{214       \}}
\DoxyCodeLine{215 }
\DoxyCodeLine{216       h *= c;}
\DoxyCodeLine{217       }
\DoxyCodeLine{218       \textcolor{keywordflow}{if}(x + h > X\_FINAL) \{}
\DoxyCodeLine{219         h = (X\_FINAL -\/ x);}
\DoxyCodeLine{220       \}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222       \textcolor{keywordflow}{if}(step >= N) \{}
\DoxyCodeLine{223         std::string problem;}
\DoxyCodeLine{224         problem = \textcolor{stringliteral}{"The ODE.shoot45 method reached the maximum \(\backslash\)n"};}
\DoxyCodeLine{225         problem += \textcolor{stringliteral}{"number of steps specified by the user. \(\backslash\)n"};}
\DoxyCodeLine{226         \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{227       \}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229     \} \textcolor{keywordflow}{while}(std::abs(x -\/ X\_FINAL) > tol);     \textcolor{comment}{// end loop stepping across domain}}
\DoxyCodeLine{230 }
\DoxyCodeLine{231     \textcolor{comment}{// construct the solution mesh stored in this object}}
\DoxyCodeLine{232     SOLN = OneD\_Node\_Mesh<\_Type>(coords, p\_EQUATION -\/> get\_order());}
\DoxyCodeLine{233     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < coords.size(); ++i) \{}
\DoxyCodeLine{234       \textcolor{comment}{// fill mesh}}
\DoxyCodeLine{235       SOLN.set\_nodes\_vars(i, values[i]);}
\DoxyCodeLine{236     \}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238     \textcolor{keywordflow}{return} u;}
\DoxyCodeLine{239   \}}

\end{DoxyCode}


Referenced by main().

\mbox{\label{classCppNoddy_1_1ODE__IVP_a82b509f7e44fb610c1231784dd106e2b}} 
\index{CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}!store\_every@{store\_every}}
\index{store\_every@{store\_every}!CppNoddy::ODE\_IVP$<$ \_Type $>$@{CppNoddy::ODE\_IVP$<$ \_Type $>$}}
\doxyparagraph{store\_every()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type $>$ \\
unsigned \& \textbf{ Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+I\+VP}$<$ \+\_\+\+Type $>$\+::store\+\_\+every}



Return a handle to the S\+T\+O\+R\+E\+\_\+\+E\+V\+E\+RY object. 

\begin{DoxyReturn}{Returns}
A reference to the S\+T\+O\+R\+E\+\_\+\+E\+V\+E\+RY variable 
\end{DoxyReturn}


Definition at line 247 of file O\+D\+E\+\_\+\+I\+V\+P.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{247                                         \{}
\DoxyCodeLine{248     \textcolor{keywordflow}{return} STORE\_EVERY;}
\DoxyCodeLine{249   \}}

\end{DoxyCode}


Referenced by main().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/\textbf{ O\+D\+E\+\_\+\+I\+V\+P.\+h}\item 
src/\textbf{ O\+D\+E\+\_\+\+I\+V\+P.\+cpp}\end{DoxyCompactItemize}
