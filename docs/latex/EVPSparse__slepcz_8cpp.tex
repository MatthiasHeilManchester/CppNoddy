\doxysubsection{Tests/\+E\+V\+P/\+E\+V\+P\+Sparse\+\_\+slepcz.cpp File Reference}
\label{EVPSparse__slepcz_8cpp}\index{Tests/EVP/EVPSparse\_slepcz.cpp@{Tests/EVP/EVPSparse\_slepcz.cpp}}
{\ttfamily \#include $<$Sparse\+Linear\+Eigen\+System.\+h$>$}\newline
{\ttfamily \#include $<$Slepc\+Session.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} (int argc, char $\ast$argv[$\,$])
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solves a 4x4 complex generalised eigenvalue problem \[ A_{4x4} \,{\underline x}_i = \lambda_i\, B_{4x4}\, {\underline x}_i \] for the 4 eigenvalues $ \lambda_i $, $i=1,2,3,4.$. As a test case we use the S\+L\+E\+Pc library. In this case $ A_{4x4} $ and $ B_{4x4} $ are such that the eigenvalues are $ 3-9i,\, 2-5i,\, 3-i,\, 4-5i $. The computation requests eigenvalues that satisfy $ \vert\lambda\vert < 4$, which in this case is $ 3-i $. 

\doxysubsubsection{Function Documentation}
\mbox{\label{EVPSparse__slepcz_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{EVPSparse\_slepcz.cpp@{EVPSparse\_slepcz.cpp}!main@{main}}
\index{main@{main}!EVPSparse\_slepcz.cpp@{EVPSparse\_slepcz.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv[$\,$] }\end{DoxyParamCaption})}



Definition at line 20 of file E\+V\+P\+Sparse\+\_\+slepcz.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{21 \{}
\DoxyCodeLine{22 }
\DoxyCodeLine{23   SlepcSession::getInstance(argc,argv);}
\DoxyCodeLine{24 }
\DoxyCodeLine{25   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{26   cout << \textcolor{stringliteral}{"=== EVP: complex generalised eigenvalue problem  ====\(\backslash\)n"};}
\DoxyCodeLine{27   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{28 }
\DoxyCodeLine{29   SparseMatrix<D\_complex> a( 4, 4 );}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   a( 0, 0 ) = D\_complex( -\/21.10, -\/22.50 );}
\DoxyCodeLine{32   a( 0, 1 ) = D\_complex( 53.50, -\/50.50 );}
\DoxyCodeLine{33   a( 0, 2 ) = D\_complex( -\/34.50, 127.50 );}
\DoxyCodeLine{34   a( 0, 3 ) = D\_complex( 7.50, 0.50 );}
\DoxyCodeLine{35 }
\DoxyCodeLine{36   a( 1, 0 ) = D\_complex( -\/0.46, -\/7.78 );}
\DoxyCodeLine{37   a( 1, 1 ) = D\_complex( -\/3.50, -\/37.50 );}
\DoxyCodeLine{38   a( 1, 2 ) = D\_complex( -\/15.50, 58.50 );}
\DoxyCodeLine{39   a( 1, 3 ) = D\_complex( -\/10.50, -\/1.50 );}
\DoxyCodeLine{40 }
\DoxyCodeLine{41   a( 2, 0 ) = D\_complex( 4.30, -\/5.50 );}
\DoxyCodeLine{42   a( 2, 1 ) = D\_complex( 39.70, -\/17.10 );}
\DoxyCodeLine{43   a( 2, 2 ) = D\_complex( -\/68.50, 12.50 );}
\DoxyCodeLine{44   a( 2, 3 ) = D\_complex( -\/7.50, -\/3.50 );}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   a( 3, 0 ) = D\_complex( 5.50, 4.40 );}
\DoxyCodeLine{47   a( 3, 1 ) = D\_complex( 14.40, 43.30 );}
\DoxyCodeLine{48   a( 3, 2 ) = D\_complex( -\/32.50, -\/46.00 );}
\DoxyCodeLine{49   a( 3, 3 ) = D\_complex( -\/19.00, -\/32.50 );}
\DoxyCodeLine{50 }
\DoxyCodeLine{51   SparseMatrix<D\_complex> b( 4, 4 );}
\DoxyCodeLine{52 }
\DoxyCodeLine{53   b( 0, 0 ) = D\_complex( 1.00, -\/5.00 );}
\DoxyCodeLine{54   b( 0, 1 ) = D\_complex( 1.60, 1.20 );}
\DoxyCodeLine{55   b( 0, 2 ) = D\_complex( -\/3.00, 0.00 );}
\DoxyCodeLine{56   b( 0, 3 ) = D\_complex( 0.00, -\/1.00 );}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   b( 1, 0 ) = D\_complex( 0.80, -\/0.60 );}
\DoxyCodeLine{59   b( 1, 1 ) = D\_complex( 3.00, -\/5.00 );}
\DoxyCodeLine{60   b( 1, 2 ) = D\_complex( -\/4.00, 3.00 );}
\DoxyCodeLine{61   b( 1, 3 ) = D\_complex( -\/2.40, -\/3.20 );}
\DoxyCodeLine{62 }
\DoxyCodeLine{63   b( 2, 0 ) = D\_complex( 1.00, 0.00 );}
\DoxyCodeLine{64   b( 2, 1 ) = D\_complex( 2.40, 1.80 );}
\DoxyCodeLine{65   b( 2, 2 ) = D\_complex( -\/4.00, -\/5.00 );}
\DoxyCodeLine{66   b( 2, 3 ) = D\_complex( 0.00, -\/3.00 );}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   b( 3, 0 ) = D\_complex( 0.00, 1.00 );}
\DoxyCodeLine{69   b( 3, 1 ) = D\_complex( -\/1.80, 2.40 );}
\DoxyCodeLine{70   b( 3, 2 ) = D\_complex( 0.00, -\/4.00 );}
\DoxyCodeLine{71   b( 3, 3 ) = D\_complex( 4.00, -\/5.00 );}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   \textcolor{comment}{// a vector for the eigenvalues}}
\DoxyCodeLine{74   DenseVector<D\_complex> lambdas;}
\DoxyCodeLine{75   \textcolor{comment}{// eigenvalues are: (3,-\/9), (2,-\/5), (3,-\/1), (4,-\/5)}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77   SparseLinearEigenSystem<D\_complex> system( \&a, \&b );}
\DoxyCodeLine{78   \textcolor{keywordflow}{try}}
\DoxyCodeLine{79   \{}
\DoxyCodeLine{80     system.eigensolve();}
\DoxyCodeLine{81   \}}
\DoxyCodeLine{82   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{83   \{}
\DoxyCodeLine{84     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{85     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{86   \}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88   \textcolor{comment}{// tag any eigenvalues within a distance of 0.1 of the point 3-\/i}}
\DoxyCodeLine{89   system.set\_shift( D\_complex( 3.0, -\/1.0 ) );}
\DoxyCodeLine{90   system.tag\_eigenvalues\_disc( + 1, 0.1 );}
\DoxyCodeLine{91   \textcolor{comment}{// get those tagged eigenvalues}}
\DoxyCodeLine{92   lambdas = system.get\_tagged\_eigenvalues();}
\DoxyCodeLine{93 }
\DoxyCodeLine{94   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/10;}
\DoxyCodeLine{95   \textcolor{keywordflow}{if} ( std::abs( lambdas[ 0 ] -\/ D\_complex( 3.0, -\/1.0 ) ) < tol )}
\DoxyCodeLine{96   \{}
\DoxyCodeLine{97     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{98     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{99   \}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101   cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{102   cout.precision( 12 );}
\DoxyCodeLine{103   cout << \textcolor{stringliteral}{"    Final error = "} << std::abs( lambdas[ 0 ] -\/ D\_complex( 3.0, -\/1.0 ) ) << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{104   lambdas.dump();}
\DoxyCodeLine{105   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{106 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::dump().

