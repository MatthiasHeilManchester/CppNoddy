\doxysubsection{Cpp\+Noddy\+::FT Namespace Reference}
\label{namespaceCppNoddy_1_1FT}\index{CppNoddy::FT@{CppNoddy::FT}}


Some algorithms associated with Fourier transforms of \doxyref{Cpp\+Noddy}{p.}{namespaceCppNoddy} container data.  


\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ shift} (const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&ft)
\begin{DoxyCompactList}\small\item\em Shift the frequency spectrum obtained from dft to give positive and negative freq. \end{DoxyCompactList}\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ ishift} (const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&ft)
\begin{DoxyCompactList}\small\item\em Invert the shif operation to recover a spectrum in the form that is expected by the idft routine. \end{DoxyCompactList}\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ dft\+\_\+with\+\_\+shift} (const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&\textbf{ f})
\begin{DoxyCompactList}\small\item\em A wrapper that calls the \textquotesingle{}dft\textquotesingle{} method above followed by the \textquotesingle{}shift\textquotesingle{} method. \end{DoxyCompactList}\item 
\textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ dft\+\_\+with\+\_\+shift} (const \textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&\textbf{ f})
\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ idft\+\_\+with\+\_\+ishift} (const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&ft, double origin=0)
\begin{DoxyCompactList}\small\item\em A wrapper that calls the \textquotesingle{}ishift\textquotesingle{} method above followed by the \textquotesingle{}idft\textquotesingle{} method. \end{DoxyCompactList}\item 
\textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ idft\+\_\+with\+\_\+ishift} (const \textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&ft, double origin=0)
\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ dft} (const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&\textbf{ f})
\begin{DoxyCompactList}\small\item\em (Slow) D\+FT of the real data (x\+\_\+i,f\+\_\+i), i = 0, ... \end{DoxyCompactList}\item 
\textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \textbf{ idft} (const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&ft, double origin=0)
\begin{DoxyCompactList}\small\item\em (Slow) Inverse D\+FT of the complex data (omega\+\_\+i,F\+\_\+i), i = 0,...,N-\/1; N must be E\+V\+EN. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Some algorithms associated with Fourier transforms of \doxyref{Cpp\+Noddy}{p.}{namespaceCppNoddy} container data. 

\doxysubsubsection{Function Documentation}
\mbox{\label{namespaceCppNoddy_1_1FT_a0652ebfdc2d97c661bc0859e8d0e54bf}} 
\index{CppNoddy::FT@{CppNoddy::FT}!dft@{dft}}
\index{dft@{dft}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{dft()}
{\footnotesize\ttfamily \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::dft (\begin{DoxyParamCaption}\item[{const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{f }\end{DoxyParamCaption})}



(Slow) D\+FT of the real data (x\+\_\+i,f\+\_\+i), i = 0, ... 

N-\/1; N must be E\+V\+EN. 
\begin{DoxyParams}{Parameters}
{\em f} & The data to be (discrete) Fourier transformed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The Fourier transform in \char`\"{}frequency\char`\"{} space (omega\+\_\+i,F\+\_\+i). The N frequencies are omega\+\_\+i = 0, domega,..., (N-\/1)$\ast$domega. The S\+E\+C\+O\+ND half of the spectrum provides the -\/ve frequencies (as in M\+A\+T\+L\+AB). 
\end{DoxyReturn}


Definition at line 88 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{88                                                                         \{}
\DoxyCodeLine{89       \textcolor{keyword}{const} D\_complex I(0.0,1.0); \textcolor{comment}{// imaginary unit}}
\DoxyCodeLine{90       \textcolor{comment}{// number of samples in the signal}}
\DoxyCodeLine{91       std::size\_t N = f.get\_nnodes();}
\DoxyCodeLine{92       \textcolor{comment}{// time step in the signal (has to be constant)}}
\DoxyCodeLine{93       \textcolor{keywordtype}{double} dt = f.coord(1)-\/f.coord(0);}
\DoxyCodeLine{94       \textcolor{comment}{// sample frequency (rad) is related to inverse of "time" step}}
\DoxyCodeLine{95       \textcolor{keywordtype}{double} fs = 2*M\_PI/dt;}
\DoxyCodeLine{96       \textcolor{comment}{// frequency step between frequency nodes}}
\DoxyCodeLine{97       \textcolor{comment}{// -\/ largest frequency is (N-\/1)*df=(N-\/1)*fs/N}}
\DoxyCodeLine{98       \textcolor{keywordtype}{double} df = fs/N;      }
\DoxyCodeLine{99       \textcolor{comment}{// container to return the Fourier spectrum}}
\DoxyCodeLine{100       OneD\_Node\_Mesh<D\_complex> ft( f.nodes(), f.get\_nvars() );}
\DoxyCodeLine{101       \textcolor{comment}{//}}
\DoxyCodeLine{102       \textcolor{keyword}{const} \textcolor{keywordtype}{double} Wn = 2*M\_PI/N;}
\DoxyCodeLine{103       \textcolor{comment}{// slow FT}}
\DoxyCodeLine{104       \textcolor{keywordflow}{for} ( std::size\_t k = 0; k < N; ++k ) \{}
\DoxyCodeLine{105         \textcolor{comment}{// set the frequency}}
\DoxyCodeLine{106         ft.coord(k) = k*df;  \textcolor{comment}{// 0,df,...,(N-\/1)*df}}
\DoxyCodeLine{107         \textcolor{comment}{//}}
\DoxyCodeLine{108         \textcolor{comment}{//}}
\DoxyCodeLine{109         \textcolor{comment}{// t = n*dt}}
\DoxyCodeLine{110         \textcolor{comment}{// omega = k*df}}
\DoxyCodeLine{111         \textcolor{comment}{// df = (2*pi/dt)/N }}
\DoxyCodeLine{112         \textcolor{comment}{//}}
\DoxyCodeLine{113         \textcolor{comment}{// variables are all initialised to zero}}
\DoxyCodeLine{114         DenseVector<D\_complex> vars( f.get\_nvars(), 0.0 );}
\DoxyCodeLine{115         \textcolor{keywordflow}{for} ( std::size\_t n = 0; n < N; ++n ) \{}
\DoxyCodeLine{116             vars += f.get\_nodes\_vars(n)*exp(-\/I*Wn*\textcolor{keywordtype}{double}(k*n));}
\DoxyCodeLine{117         \}}
\DoxyCodeLine{118         \textcolor{comment}{// multiply by "dt" to make this correlate with analytical}}
\DoxyCodeLine{119         \textcolor{comment}{// results from the FT integral }}
\DoxyCodeLine{120         ft.set\_nodes\_vars(k,vars*dt);}
\DoxyCodeLine{121       \}}
\DoxyCodeLine{122       \textcolor{keywordflow}{return} ft;}
\DoxyCodeLine{123     \} }

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), f, and Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::set\+\_\+nodes\+\_\+vars().



Referenced by dft\+\_\+with\+\_\+shift(), and main().

\mbox{\label{namespaceCppNoddy_1_1FT_a5191f208b94bb7a17118695560824709}} 
\index{CppNoddy::FT@{CppNoddy::FT}!dft\_with\_shift@{dft\_with\_shift}}
\index{dft\_with\_shift@{dft\_with\_shift}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{dft\_with\_shift()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::dft\+\_\+with\+\_\+shift (\begin{DoxyParamCaption}\item[{const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{f }\end{DoxyParamCaption})}



A wrapper that calls the \textquotesingle{}dft\textquotesingle{} method above followed by the \textquotesingle{}shift\textquotesingle{} method. 

\begin{DoxyReturn}{Returns}
The Fourier transform in \char`\"{}frequency\char`\"{} space (omega\+\_\+i,F\+\_\+i). The N frequencies are omega\+\_\+i = -\/(N/2)$\ast$domega, ..., -\/domega , 0 , +domega, ... ,+(N/2-\/1)$\ast$domega. 
\end{DoxyReturn}


Definition at line 48 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{48                                                                                    \{}
\DoxyCodeLine{49       \textcolor{keywordflow}{return} shift(dft(f));}
\DoxyCodeLine{50     \}}

\end{DoxyCode}


References dft(), f, and shift().



Referenced by dft\+\_\+with\+\_\+shift(), and main().

\mbox{\label{namespaceCppNoddy_1_1FT_a2381942a8c749eb209f08a80c49220db}} 
\index{CppNoddy::FT@{CppNoddy::FT}!dft\_with\_shift@{dft\_with\_shift}}
\index{dft\_with\_shift@{dft\_with\_shift}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{dft\_with\_shift()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::dft\+\_\+with\+\_\+shift (\begin{DoxyParamCaption}\item[{const \textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{f }\end{DoxyParamCaption})}



Definition at line 52 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{52                                                                                   \{}
\DoxyCodeLine{53       \textcolor{comment}{// assume that we idft each ft(.,node)}}
\DoxyCodeLine{54       \textcolor{keywordtype}{unsigned} ny = f.get\_nnodes().second;}
\DoxyCodeLine{55       \textcolor{keywordtype}{unsigned} nx = f.get\_nnodes().first;      }
\DoxyCodeLine{56       TwoD\_Node\_Mesh<D\_complex> FTsoln( f.xnodes(), f.ynodes(), f.get\_nvars());}
\DoxyCodeLine{57       \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} jy = 0; jy < ny; ++jy ) \{}
\DoxyCodeLine{58         OneD\_Node\_Mesh<D\_complex> mesh = f.get\_xsection\_at\_ynode(jy);}
\DoxyCodeLine{59         OneD\_Node\_Mesh<D\_complex> ftmesh = FT::dft\_with\_shift(mesh);}
\DoxyCodeLine{60         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} jx = 0; jx < nx; ++jx ) \{}
\DoxyCodeLine{61           FTsoln.xcoord(jx)=ftmesh.coord(jx);}
\DoxyCodeLine{62           FTsoln.set\_nodes\_vars( jx, jy, ftmesh.get\_nodes\_vars(jx) );}
\DoxyCodeLine{63         \}}
\DoxyCodeLine{64       \}}
\DoxyCodeLine{65       \textcolor{keywordflow}{return} FTsoln;}
\DoxyCodeLine{66     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), dft\+\_\+with\+\_\+shift(), f, Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nodes\+\_\+vars(), Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::set\+\_\+nodes\+\_\+vars(), and Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::xcoord().

\mbox{\label{namespaceCppNoddy_1_1FT_afb49b36e9418b4bbe4bb92ff3eb332d1}} 
\index{CppNoddy::FT@{CppNoddy::FT}!idft@{idft}}
\index{idft@{idft}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{idft()}
{\footnotesize\ttfamily \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::idft (\begin{DoxyParamCaption}\item[{const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{ft,  }\item[{double}]{origin = {\ttfamily 0} }\end{DoxyParamCaption})}



(Slow) Inverse D\+FT of the complex data (omega\+\_\+i,F\+\_\+i), i = 0,...,N-\/1; N must be E\+V\+EN. 


\begin{DoxyParams}{Parameters}
{\em ft} & The frequency spectrum in the (unshifted) format. \\
\hline
{\em origin} & The position of the first data point returned. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The inversion data (origin+x\+\_\+i, f\+\_\+i). 
\end{DoxyReturn}


Definition at line 153 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{153                                                                                          \{}
\DoxyCodeLine{154       \textcolor{keyword}{const} D\_complex I(0.0,1.0); \textcolor{comment}{// imaginary unit}}
\DoxyCodeLine{155       \textcolor{comment}{// number of "frequencies" in the data}}
\DoxyCodeLine{156       std::size\_t N = ft.get\_nnodes();}
\DoxyCodeLine{157       \textcolor{comment}{// (uniform) frequency step in the data}}
\DoxyCodeLine{158       \textcolor{keywordtype}{double} df = ft.coord(1)-\/ft.coord(0);}
\DoxyCodeLine{159       \textcolor{comment}{// sample frequency}}
\DoxyCodeLine{160       \textcolor{keywordtype}{double} fs = N*df;}
\DoxyCodeLine{161       \textcolor{comment}{// time step in output signal}}
\DoxyCodeLine{162       \textcolor{keywordtype}{double} dt = 2*M\_PI/fs;}
\DoxyCodeLine{163       \textcolor{comment}{// NOTE: dt*df = 2*pi/N}}
\DoxyCodeLine{164       \textcolor{comment}{//}}
\DoxyCodeLine{165       \textcolor{comment}{// containter to return the "time series" in}}
\DoxyCodeLine{166       OneD\_Node\_Mesh<D\_complex> f( ft );}
\DoxyCodeLine{167       \textcolor{comment}{//}}
\DoxyCodeLine{168       \textcolor{keyword}{const} \textcolor{keywordtype}{double} Wn = 2*M\_PI/N;}
\DoxyCodeLine{169       \textcolor{comment}{// number of variables at each time/frequency}}
\DoxyCodeLine{170       \textcolor{keyword}{const} std::size\_t nVars( ft.get\_nvars() );}
\DoxyCodeLine{171       \textcolor{comment}{// slow inverse FT}}
\DoxyCodeLine{172       \textcolor{keywordflow}{for} ( std::size\_t n = 0; n < N; ++n ) \{}
\DoxyCodeLine{173         \textcolor{comment}{// set the coordinate/time using the offset passed to this method}}
\DoxyCodeLine{174         f.coord(n) = origin + n*dt;}
\DoxyCodeLine{175         \textcolor{comment}{// invert for all variables in the mesh at the same time}}
\DoxyCodeLine{176         DenseVector<D\_complex> vars( nVars, 0.0 );}
\DoxyCodeLine{177         \textcolor{keywordflow}{for} (  std::size\_t k = 0; k < N; ++k ) \{}
\DoxyCodeLine{178           vars += ft.get\_nodes\_vars(k)*exp(+I*Wn*\textcolor{keywordtype}{double}(k*n));}
\DoxyCodeLine{179         \}}
\DoxyCodeLine{180         \textcolor{comment}{// the dt factor is for consistency with continuous FT integral}}
\DoxyCodeLine{181         f.set\_nodes\_vars(n,vars/(N*dt));}
\DoxyCodeLine{182       \}}
\DoxyCodeLine{183       \textcolor{keywordflow}{return} f;}
\DoxyCodeLine{184     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), f, Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nnodes(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nodes\+\_\+vars(), and Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nvars().



Referenced by idft\+\_\+with\+\_\+ishift(), and main().

\mbox{\label{namespaceCppNoddy_1_1FT_a70ed1dc4e6645cad4909ed270142e497}} 
\index{CppNoddy::FT@{CppNoddy::FT}!idft\_with\_ishift@{idft\_with\_ishift}}
\index{idft\_with\_ishift@{idft\_with\_ishift}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{idft\_with\_ishift()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::idft\+\_\+with\+\_\+ishift (\begin{DoxyParamCaption}\item[{const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{ft,  }\item[{double}]{origin = {\ttfamily 0} }\end{DoxyParamCaption})}



A wrapper that calls the \textquotesingle{}ishift\textquotesingle{} method above followed by the \textquotesingle{}idft\textquotesingle{} method. 


\begin{DoxyParams}{Parameters}
{\em ft} & The frequency spectrum in the (unshifted) format. \\
\hline
{\em origin} & The position of the first data point returned. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The inversion data (origin+x\+\_\+i, f\+\_\+i). 
\end{DoxyReturn}


Definition at line 68 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{68                                                                                                      \{}
\DoxyCodeLine{69       \textcolor{keywordflow}{return} idft(ishift(ft),origin);}
\DoxyCodeLine{70     \}}

\end{DoxyCode}


References idft(), and ishift().



Referenced by idft\+\_\+with\+\_\+ishift(), and main().

\mbox{\label{namespaceCppNoddy_1_1FT_ab43c0d7ffd891c6f20a4b6623f163ec0}} 
\index{CppNoddy::FT@{CppNoddy::FT}!idft\_with\_ishift@{idft\_with\_ishift}}
\index{idft\_with\_ishift@{idft\_with\_ishift}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{idft\_with\_ishift()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::idft\+\_\+with\+\_\+ishift (\begin{DoxyParamCaption}\item[{const \textbf{ Two\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{ft,  }\item[{double}]{origin = {\ttfamily 0} }\end{DoxyParamCaption})}



Definition at line 72 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{72                                                                                                     \{}
\DoxyCodeLine{73       \textcolor{comment}{// assume that we idft each ft(.,node)}}
\DoxyCodeLine{74       \textcolor{keywordtype}{unsigned} ny = ft.get\_nnodes().second;}
\DoxyCodeLine{75       \textcolor{keywordtype}{unsigned} nx = ft.get\_nnodes().first;      }
\DoxyCodeLine{76       TwoD\_Node\_Mesh<D\_complex> soln( ft.xnodes(), ft.ynodes(), ft.get\_nvars());}
\DoxyCodeLine{77       \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} jy = 0; jy < ny; ++jy ) \{}
\DoxyCodeLine{78         OneD\_Node\_Mesh<D\_complex> ftmesh = ft.get\_xsection\_at\_ynode(jy);}
\DoxyCodeLine{79         OneD\_Node\_Mesh<D\_complex> mesh = FT::idft\_with\_ishift(ftmesh,origin);}
\DoxyCodeLine{80         \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} jx = 0; jx < nx; ++jx ) \{}
\DoxyCodeLine{81           soln.xcoord(jx)=mesh.coord(jx);}
\DoxyCodeLine{82           soln.set\_nodes\_vars( jx, jy, mesh.get\_nodes\_vars(jx) );}
\DoxyCodeLine{83         \}}
\DoxyCodeLine{84       \}}
\DoxyCodeLine{85       \textcolor{keywordflow}{return} soln;}
\DoxyCodeLine{86     \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::get\+\_\+nnodes(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nodes\+\_\+vars(), Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::get\+\_\+nvars(), Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::get\+\_\+xsection\+\_\+at\+\_\+ynode(), idft\+\_\+with\+\_\+ishift(), Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::set\+\_\+nodes\+\_\+vars(), Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::xcoord(), Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::xnodes(), and Cpp\+Noddy\+::\+Two\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type $>$\+::ynodes().

\mbox{\label{namespaceCppNoddy_1_1FT_a7fe2acec908cd5d3f2a6532464eb3d1f}} 
\index{CppNoddy::FT@{CppNoddy::FT}!ishift@{ishift}}
\index{ishift@{ishift}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{ishift()}
{\footnotesize\ttfamily \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::ishift (\begin{DoxyParamCaption}\item[{const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{ft }\end{DoxyParamCaption})}



Invert the shif operation to recover a spectrum in the form that is expected by the idft routine. 


\begin{DoxyParams}{Parameters}
{\em ft} & A previously shifted frequency spectrum. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The frequency spectrum in the (unshifted) format. 0,domega,...,(N/2)$\ast$domega, (N/2+1)$\ast$domega,...,(N-\/1)$\ast$domega. 
\end{DoxyReturn}


Definition at line 31 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{31                                                                             \{}
\DoxyCodeLine{32       OneD\_Node\_Mesh<D\_complex> ft\_ishifted( ft );}
\DoxyCodeLine{33       \textcolor{keywordtype}{double} df = ft.coord(1)-\/ft.coord(0);}
\DoxyCodeLine{34       std::size\_t N = ft.get\_nnodes();}
\DoxyCodeLine{35       \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < N/2; ++i ) \{}
\DoxyCodeLine{36         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < ft.get\_nvars(); ++var ) \{}
\DoxyCodeLine{37           \textcolor{comment}{// first half of shifted output}}
\DoxyCodeLine{38           ft\_ishifted( i, var ) = ft( N/2 + i, var );}
\DoxyCodeLine{39           \textcolor{comment}{// second half of shifted output}}
\DoxyCodeLine{40           ft\_ishifted( N/2 + i, var ) = ft( i, var );}
\DoxyCodeLine{41         \}}
\DoxyCodeLine{42         ft\_ishifted.coord( i ) = ft.coord( N/2 + i );}
\DoxyCodeLine{43         ft\_ishifted.coord( N/2 + i ) = ft.coord(N-\/1) + i*df;}
\DoxyCodeLine{44       \}}
\DoxyCodeLine{45       \textcolor{keywordflow}{return} ft\_ishifted;}
\DoxyCodeLine{46     \}        }

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nnodes(), and Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nvars().



Referenced by idft\+\_\+with\+\_\+ishift().

\mbox{\label{namespaceCppNoddy_1_1FT_a770b287041441afb75e690f9f9ff029f}} 
\index{CppNoddy::FT@{CppNoddy::FT}!shift@{shift}}
\index{shift@{shift}!CppNoddy::FT@{CppNoddy::FT}}
\doxyparagraph{shift()}
{\footnotesize\ttfamily \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ Cpp\+Noddy\+::\+F\+T\+::shift (\begin{DoxyParamCaption}\item[{const \textbf{ One\+D\+\_\+\+Node\+\_\+\+Mesh}$<$ \textbf{ D\+\_\+complex} $>$ \&}]{ft }\end{DoxyParamCaption})}



Shift the frequency spectrum obtained from dft to give positive and negative freq. 

Note\+: input should have an even number of nodes. 
\begin{DoxyParams}{Parameters}
{\em ft} & The frequency spectrum in the (unshifted) format. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The frequency spectrum in the (shifted) format. -\/(N/2)domega,...,-\/domega,0,domega,...,(N/2-\/1)$\ast$domega 
\end{DoxyReturn}


Definition at line 15 of file F\+T.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{15                                                                            \{}
\DoxyCodeLine{16       OneD\_Node\_Mesh<D\_complex> ft\_shifted( ft );}
\DoxyCodeLine{17       std::size\_t N = ft.get\_nnodes();}
\DoxyCodeLine{18       \textcolor{keywordflow}{for} ( std::size\_t i = 0; i < N/2; ++i ) \{}
\DoxyCodeLine{19         \textcolor{keywordflow}{for} ( std::size\_t var = 0; var < ft.get\_nvars(); ++var ) \{}
\DoxyCodeLine{20           \textcolor{comment}{// first half of shifted output}}
\DoxyCodeLine{21           ft\_shifted( i, var ) = ft( N/2+i, var );}
\DoxyCodeLine{22           \textcolor{comment}{// second half of shifted output}}
\DoxyCodeLine{23           ft\_shifted( N/2 + i, var ) = ft( i, var );}
\DoxyCodeLine{24         \}}
\DoxyCodeLine{25         ft\_shifted.coord( i ) = -\/ft.coord( N/2 -\/ i );}
\DoxyCodeLine{26         ft\_shifted.coord( N/2 + i ) = ft.coord( i );}
\DoxyCodeLine{27       \}}
\DoxyCodeLine{28       \textcolor{keywordflow}{return} ft\_shifted;}
\DoxyCodeLine{29     \}    }

\end{DoxyCode}


References Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::coord(), Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nnodes(), and Cpp\+Noddy\+::\+One\+D\+\_\+\+Node\+\_\+\+Mesh$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+nvars().



Referenced by dft\+\_\+with\+\_\+shift(), and main().

