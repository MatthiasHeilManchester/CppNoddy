\doxysubsection{Tests/double\+\_\+\+I\+B\+V\+P/\+I\+B\+V\+P\+Nonlinear\+Slower.cpp File Reference}
\label{IBVPNonlinearSlower_8cpp}\index{Tests/double\_IBVP/IBVPNonlinearSlower.cpp@{Tests/double\_IBVP/IBVPNonlinearSlower.cpp}}
{\ttfamily \#include $<$I\+B\+V\+P\+\_\+double\+\_\+bundle.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../\+Utils\+\_\+\+Fill.\+h\char`\"{}}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::nonlinear}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+B\+C\+\_\+lower}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+B\+C\+\_\+upper}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ U}, 
\textbf{ Ud}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::source} (const double \&x, const double \&y, const double \&t)
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solving the nonlinear problem \[ -u u_x - u_t + u_{yy} = y^2 t^2 e^{-2x} - y e^{-x}\,, \] subject to $ u(x=0,y,t) = ty $, $ u(x,t=0,y) = 0 $ and $ f(x, y = 0,t ) = 0 $, $ f(x, y = 1,t ) = t $. The solution is computed over a range of $ t $ for $ (x,y) \in [0,10]\times [0,1] $ and the maximum deviation away from the exact solution $ u = yte^{-x} $ is found. The test fails if this deviation is larger than a set tolerance $ \tau $. The example is solved using the P\+D\+E\+\_\+double\+\_\+\+I\+B\+VP for problems that are parabolic in 2 coordinates $ (x,t) $ with a B\+VP in $ y $. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{IBVPNonlinearSlower_8cpp_ac36f475ca5b446f4fde4c9b90bec77c8}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{U@{U}!IBVPNonlinearSlower.cpp@{IBVPNonlinearSlower.cpp}}\index{IBVPNonlinearSlower.cpp@{IBVPNonlinearSlower.cpp}!U@{U}}}\mbox{\label{IBVPNonlinearSlower_8cpp_ac36f475ca5b446f4fde4c9b90bec77c8ac461e84f27bbb236874e1011cd66031f}} 
U&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Ud@{Ud}!IBVPNonlinearSlower.cpp@{IBVPNonlinearSlower.cpp}}\index{IBVPNonlinearSlower.cpp@{IBVPNonlinearSlower.cpp}!Ud@{Ud}}}\mbox{\label{IBVPNonlinearSlower_8cpp_ac36f475ca5b446f4fde4c9b90bec77c8ae3fe7b6f745ea6be7e92f8c854abfb4f}} 
Ud&\\
\hline

\end{DoxyEnumFields}


Definition at line 18 of file I\+B\+V\+P\+Nonlinear\+Slower.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{18 \{ U, Ud \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{IBVPNonlinearSlower_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{IBVPNonlinearSlower.cpp@{IBVPNonlinearSlower.cpp}!main@{main}}
\index{main@{main}!IBVPNonlinearSlower.cpp@{IBVPNonlinearSlower.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 100 of file I\+B\+V\+P\+Nonlinear\+Slower.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{101 \{}
\DoxyCodeLine{102   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{103   cout << \textcolor{stringliteral}{"=== double\_IBVP: non-\/constant mass matrix example ===\(\backslash\)n"};}
\DoxyCodeLine{104   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{105 }
\DoxyCodeLine{106   \textcolor{comment}{// instantiate the problem}}
\DoxyCodeLine{107   Example::nonlinear problem;}
\DoxyCodeLine{108   Example::BC\_lower BC\_bottom;}
\DoxyCodeLine{109   Example::BC\_upper BC\_top;}
\DoxyCodeLine{110 }
\DoxyCodeLine{111   \textcolor{comment}{// domain definition}}
\DoxyCodeLine{112   \textcolor{keywordtype}{double} top = 1.0;}
\DoxyCodeLine{113   \textcolor{keywordtype}{double} bottom = 0.0;}
\DoxyCodeLine{114   \textcolor{keywordtype}{double} left = 0.0;}
\DoxyCodeLine{115   \textcolor{keywordtype}{double} right = 10.0;}
\DoxyCodeLine{116   \textcolor{comment}{// number of (spatial) nodal points}}
\DoxyCodeLine{117   \textcolor{keywordtype}{unsigned} ny = 11;}
\DoxyCodeLine{118   \textcolor{keywordtype}{unsigned} nx = 1001;}
\DoxyCodeLine{119   \textcolor{comment}{// time and time step}}
\DoxyCodeLine{120   \textcolor{keywordtype}{double} t\_end = 1.;}
\DoxyCodeLine{121   \textcolor{keywordtype}{double} dt = 0.01;}
\DoxyCodeLine{122 }
\DoxyCodeLine{123   \textcolor{comment}{// construct our IBVP}}
\DoxyCodeLine{124   PDE\_double\_IBVP<double> nlin( \&problem,}
\DoxyCodeLine{125                                 Utility::uniform\_node\_vector( left, right, nx ),}
\DoxyCodeLine{126                                 Utility::uniform\_node\_vector( bottom, top, ny ),}
\DoxyCodeLine{127                                 \&BC\_bottom, \&BC\_top );}
\DoxyCodeLine{128 }
\DoxyCodeLine{129   \textcolor{comment}{// initial conditions}}
\DoxyCodeLine{130   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < nx; ++i )}
\DoxyCodeLine{131   \{}
\DoxyCodeLine{132     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} j = 0; j < ny; ++j )}
\DoxyCodeLine{133     \{}
\DoxyCodeLine{134       nlin.solution()( i, j, U ) = 0.0;}
\DoxyCodeLine{135       nlin.solution()( i, j, Ud ) = 0.0;}
\DoxyCodeLine{136     \}}
\DoxyCodeLine{137   \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139   \textcolor{keywordtype}{double} max\_error( 0.0 );}
\DoxyCodeLine{140   \textcolor{keywordtype}{int} counter( 0 );}
\DoxyCodeLine{141   \textcolor{keywordflow}{do}}
\DoxyCodeLine{142   \{}
\DoxyCodeLine{143     \textcolor{comment}{// inlet profile is time dependent, so we set it here for the next time level}}
\DoxyCodeLine{144     nlin.update\_previous\_solution();}
\DoxyCodeLine{145     \textcolor{comment}{// now we can alter the solution stored in the double\_IBVP class to define}}
\DoxyCodeLine{146     \textcolor{comment}{// the desired x=0 'initial' conditions at the next time step}}
\DoxyCodeLine{147     \textcolor{keywordtype}{double} t\_next = nlin.t() + dt;}
\DoxyCodeLine{148     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} j = 0; j < ny; ++j )}
\DoxyCodeLine{149     \{}
\DoxyCodeLine{150       \textcolor{keywordtype}{double} y = nlin.solution().coord( 0, j ).second;}
\DoxyCodeLine{151       nlin.solution()( 0, j, U ) = t\_next * y;}
\DoxyCodeLine{152       nlin.solution()( 0, j, Ud ) = t\_next;}
\DoxyCodeLine{153     \}}
\DoxyCodeLine{154     nlin.step2( dt );}
\DoxyCodeLine{155     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < nx; ++i )}
\DoxyCodeLine{156     \{}
\DoxyCodeLine{157       \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} j = 0; j < ny; ++j )}
\DoxyCodeLine{158       \{}
\DoxyCodeLine{159         \textcolor{keywordtype}{double} x = nlin.solution().coord( i, j ).first;}
\DoxyCodeLine{160         \textcolor{keywordtype}{double} y = nlin.solution().coord( i, j ).second;}
\DoxyCodeLine{161         \textcolor{keywordtype}{double} exact\_u = y * nlin.t() * exp( -\/ x );}
\DoxyCodeLine{162         max\_error = max( max\_error, abs( exact\_u -\/ nlin.solution()( i, j, U ) ) );}
\DoxyCodeLine{163       \}}
\DoxyCodeLine{164     \}}
\DoxyCodeLine{165     ++counter;}
\DoxyCodeLine{166   \}}
\DoxyCodeLine{167   \textcolor{keywordflow}{while} ( nlin.t() < t\_end );}
\DoxyCodeLine{168 }
\DoxyCodeLine{169   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol( 1.e-\/4 );}
\DoxyCodeLine{170   \textcolor{comment}{// check the error from the exact solution}}
\DoxyCodeLine{171   \textcolor{keywordflow}{if} ( max\_error > tol )}
\DoxyCodeLine{172   \{}
\DoxyCodeLine{173     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{174     cout << \textcolor{stringliteral}{" Difference = "} << max\_error << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{175     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{176   \}}
\DoxyCodeLine{177   \textcolor{keywordflow}{else}}
\DoxyCodeLine{178   \{}
\DoxyCodeLine{179     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{180     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{181   \}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::solution(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::step2(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::t(), U, Ud, Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector(), and Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::update\+\_\+previous\+\_\+solution().

