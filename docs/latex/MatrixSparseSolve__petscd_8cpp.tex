\doxysubsection{Tests/\+Matrix/\+Matrix\+Sparse\+Solve\+\_\+petscd.cpp File Reference}
\label{MatrixSparseSolve__petscd_8cpp}\index{Tests/Matrix/MatrixSparseSolve\_petscd.cpp@{Tests/Matrix/MatrixSparseSolve\_petscd.cpp}}
{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$Timer.\+h$>$}\newline
{\ttfamily \#include $<$Types.\+h$>$}\newline
{\ttfamily \#include $<$Utility.\+h$>$}\newline
{\ttfamily \#include $<$Sparse\+Linear\+System.\+h$>$}\newline
{\ttfamily \#include $<$Petsc\+Session.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} (int argc, char $\ast$argv[$\,$])
\end{DoxyCompactItemize}


\doxysubsubsection{Function Documentation}
\mbox{\label{MatrixSparseSolve__petscd_8cpp_a0ddf1224851353fc92bfbff6f499fa97}} 
\index{MatrixSparseSolve\_petscd.cpp@{MatrixSparseSolve\_petscd.cpp}!main@{main}}
\index{main@{main}!MatrixSparseSolve\_petscd.cpp@{MatrixSparseSolve\_petscd.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$}]{argv[$\,$] }\end{DoxyParamCaption})}



Definition at line 21 of file Matrix\+Sparse\+Solve\+\_\+petscd.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \{}
\DoxyCodeLine{23   PetscSession::getInstance(argc,argv);}
\DoxyCodeLine{24 }
\DoxyCodeLine{25   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{26   cout << \textcolor{stringliteral}{"=== Matrix: Example linear (double) sparse solver  ===\(\backslash\)n"};}
\DoxyCodeLine{27   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{28 }
\DoxyCodeLine{29   \textcolor{keywordtype}{bool} failed = \textcolor{keyword}{false};}
\DoxyCodeLine{30   \textcolor{comment}{// tolerance for the test}}
\DoxyCodeLine{31   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/10;}
\DoxyCodeLine{32 }
\DoxyCodeLine{33   \textcolor{comment}{//}}
\DoxyCodeLine{34   \textcolor{comment}{// SOLVE A SMALL "Sparse"(!) 2X2 REAL SYSTEM}}
\DoxyCodeLine{35   cout << \textcolor{stringliteral}{"=== Matrix: double  ===============================\(\backslash\)n"};}
\DoxyCodeLine{36   \textcolor{comment}{//}}
\DoxyCodeLine{37   SparseMatrix<double> A( 2, 2 );}
\DoxyCodeLine{38   DenseVector<double> B( 2, 0.0 );}
\DoxyCodeLine{39   A( 0, 0 ) = 1.;}
\DoxyCodeLine{40   A( 0, 1 ) = 2.;}
\DoxyCodeLine{41   A( 1, 0 ) = 3.;}
\DoxyCodeLine{42   A( 1, 1 ) = 4.;}
\DoxyCodeLine{43   B[ 0 ] = 5.;}
\DoxyCodeLine{44   B[ 1 ] = 11.;}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   SparseLinearSystem<double> small\_system( \&A, \&B, \textcolor{stringliteral}{"petsc"} );}
\DoxyCodeLine{47 }
\DoxyCodeLine{48   \textcolor{keywordflow}{try}}
\DoxyCodeLine{49   \{}
\DoxyCodeLine{50     small\_system.factorise();}
\DoxyCodeLine{51     small\_system.solve\_using\_factorisation();}
\DoxyCodeLine{52   \}}
\DoxyCodeLine{53   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{54   \{}
\DoxyCodeLine{55     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{56     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{57   \}}
\DoxyCodeLine{58   DenseVector<double> answer( 2, 0.0 );}
\DoxyCodeLine{59   answer[ 0 ] = 1.0;}
\DoxyCodeLine{60   answer[ 1 ] = 2.0;}
\DoxyCodeLine{61   B.sub( answer );}
\DoxyCodeLine{62   \textcolor{keywordflow}{if} ( B.inf\_norm() > tol )}
\DoxyCodeLine{63   \{}
\DoxyCodeLine{64     std::cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m Simple 2x2 double sparse system was not solved correctly\(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{65     std::cout << \textcolor{stringliteral}{" residual vector's inf\_norm = "} << B.inf\_norm() << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{66     failed = \textcolor{keyword}{true};}
\DoxyCodeLine{67   \}}
\DoxyCodeLine{68   \textcolor{keywordflow}{else}}
\DoxyCodeLine{69   \{}
\DoxyCodeLine{70     std::cout << \textcolor{stringliteral}{" Simple 2x2 double sparse solve works.\(\backslash\)n"};}
\DoxyCodeLine{71   \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73   \textcolor{comment}{// reset B to be double the previous case}}
\DoxyCodeLine{74   B[ 0 ] = 10.;}
\DoxyCodeLine{75   B[ 1 ] = 22.;}
\DoxyCodeLine{76   \textcolor{keywordflow}{try}}
\DoxyCodeLine{77   \{}
\DoxyCodeLine{78     small\_system.solve\_using\_factorisation();}
\DoxyCodeLine{79   \}}
\DoxyCodeLine{80   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{81   \{}
\DoxyCodeLine{82     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{83     assert( \textcolor{keyword}{false} );}
\DoxyCodeLine{84   \}}
\DoxyCodeLine{85   \textcolor{comment}{// double the RHS and double the solution}}
\DoxyCodeLine{86   answer[ 0 ] = 2.0;}
\DoxyCodeLine{87   answer[ 1 ] = 4.0;}
\DoxyCodeLine{88   B.sub( answer );}
\DoxyCodeLine{89   \textcolor{keywordflow}{if} ( B.inf\_norm() > tol )}
\DoxyCodeLine{90   \{}
\DoxyCodeLine{91     std::cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m Simple 2x2 double sparse system was not solved correctly\(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{92     std::cout << \textcolor{stringliteral}{" residual vector's inf\_norm = "} << B.inf\_norm() << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{93     failed = \textcolor{keyword}{true};}
\DoxyCodeLine{94   \}}
\DoxyCodeLine{95   \textcolor{keywordflow}{else}}
\DoxyCodeLine{96   \{}
\DoxyCodeLine{97     std::cout << \textcolor{stringliteral}{" Simple 2x2 double sparse solve\_using\_factorisation works.\(\backslash\)n"};}
\DoxyCodeLine{98   \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100   \textcolor{comment}{//PetscFinalize();}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102   \textcolor{comment}{// CONCLUDING PASS/FAIL}}
\DoxyCodeLine{103   \textcolor{comment}{//}}
\DoxyCodeLine{104   \textcolor{keywordflow}{if} ( failed )}
\DoxyCodeLine{105   \{}
\DoxyCodeLine{106     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{107     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{108   \}}
\DoxyCodeLine{109   \textcolor{keywordflow}{else}}
\DoxyCodeLine{110   \{}
\DoxyCodeLine{111     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{112     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{113   \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::\+A(), Cpp\+Noddy\+::\+Sparse\+Linear\+System$<$ \+\_\+\+Type $>$\+::factorise(), Cpp\+Noddy\+::\+Example\+::failed, Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::inf\+\_\+norm(), Cpp\+Noddy\+::\+Sparse\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve\+\_\+using\+\_\+factorisation(), and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::sub().

