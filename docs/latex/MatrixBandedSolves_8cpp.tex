\doxysubsection{Tests/\+Matrix/\+Matrix\+Banded\+Solves.cpp File Reference}
\label{MatrixBandedSolves_8cpp}\index{Tests/Matrix/MatrixBandedSolves.cpp@{Tests/Matrix/MatrixBandedSolves.cpp}}
{\ttfamily \#include $<$cassert$>$}\newline
{\ttfamily \#include $<$Timer.\+h$>$}\newline
{\ttfamily \#include $<$Types.\+h$>$}\newline
{\ttfamily \#include $<$Utility.\+h$>$}\newline
{\ttfamily \#include $<$Dense\+Linear\+System.\+h$>$}\newline
{\ttfamily \#include $<$Banded\+Linear\+System.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../\+Utils\+\_\+\+Fill.\+h\char`\"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
\doxyref{Example}{p.}{namespaceExample} of a simple \char`\"{}banded\char`\"{} inear solver using $ 2 \times 2 $ matrix problem is solved. Then a penta-\/diagonal problem is solved using the dense, banded and sparse containers. The native linear Gaussian elimination solvers are used unless the P\+E\+T\+S\+C\+\_\+\+D/Z compiler options are used, in which case the linear solver phase calls the P\+E\+T\+Sc library as appropriate. 

\doxysubsubsection{Function Documentation}
\mbox{\label{MatrixBandedSolves_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{MatrixBandedSolves.cpp@{MatrixBandedSolves.cpp}!main@{main}}
\index{main@{main}!MatrixBandedSolves.cpp@{MatrixBandedSolves.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 24 of file Matrix\+Banded\+Solves.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26 }
\DoxyCodeLine{27   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{28   cout << \textcolor{stringliteral}{"=== Matrix: Example linear banded solver  ============\(\backslash\)n"};}
\DoxyCodeLine{29   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   \textcolor{keywordtype}{bool} failed = \textcolor{keyword}{false};}
\DoxyCodeLine{32   \textcolor{comment}{// tolerance for the test}}
\DoxyCodeLine{33   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/10;}
\DoxyCodeLine{34 }
\DoxyCodeLine{35   \textcolor{comment}{//}}
\DoxyCodeLine{36   \textcolor{comment}{// SOLVE A BANDED REAL SYSTEM using LAPACK or native}}
\DoxyCodeLine{37   \textcolor{comment}{//}}
\DoxyCodeLine{38   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} offdiag = 2;}
\DoxyCodeLine{39   \textcolor{comment}{// N = size of some of the larger tests}}
\DoxyCodeLine{40   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} N = 511;}
\DoxyCodeLine{41   \textcolor{keyword}{const} \textcolor{keywordtype}{double} D = 12 * ( 1. / ( N -\/ 1 ) ) * ( 1. / ( N -\/ 1 ) );}
\DoxyCodeLine{42   \textcolor{comment}{//}}
\DoxyCodeLine{43   BandedMatrix<double> AB( N, offdiag, 0.0 );}
\DoxyCodeLine{44   DenseVector<double> BB( N, D );}
\DoxyCodeLine{45   \textcolor{comment}{//}}
\DoxyCodeLine{46   Utils\_Fill::fill\_band( AB, 0, -\/30.0 );}
\DoxyCodeLine{47   Utils\_Fill::fill\_band( AB, -\/1, 16.0 );}
\DoxyCodeLine{48   Utils\_Fill::fill\_band( AB, 1, 16.0 );}
\DoxyCodeLine{49   Utils\_Fill::fill\_band( AB, -\/2, -\/1.0 );}
\DoxyCodeLine{50   Utils\_Fill::fill\_band( AB, 2, -\/1.0 );}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   DenseMatrix<double> AD( AB );}
\DoxyCodeLine{53   DenseVector<double> BD( BB );}
\DoxyCodeLine{54   }
\DoxyCodeLine{55   cout << \textcolor{stringliteral}{"     Using dense matrix solver : "} << N << \textcolor{stringliteral}{"x"} << N << \textcolor{stringliteral}{" system \(\backslash\)n"};}
\DoxyCodeLine{56   cout << \textcolor{stringliteral}{"     Using the native dense routine\(\backslash\)n"};}
\DoxyCodeLine{57   DenseLinearSystem<double> dense\_system( \&AD, \&BD, \textcolor{stringliteral}{"native"} );}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   \textcolor{keywordflow}{try}}
\DoxyCodeLine{60   \{}
\DoxyCodeLine{61     dense\_system.solve();}
\DoxyCodeLine{62   \}}
\DoxyCodeLine{63   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{64   \{}
\DoxyCodeLine{65     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{66     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{67   \}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69   cout << \textcolor{stringliteral}{"  * Not checking.\(\backslash\)n"};}
\DoxyCodeLine{70   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{71   cout << \textcolor{stringliteral}{"     Comparing the banded matrix solver solution : "};}
\DoxyCodeLine{72   cout << N << \textcolor{stringliteral}{"x"} << 2 * AB.noffdiag() + 1 << \textcolor{stringliteral}{" system \(\backslash\)n"};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   cout << \textcolor{stringliteral}{"     Using the native banded routine\(\backslash\)n"};}
\DoxyCodeLine{75   BandedLinearSystem<double> banded\_system( \&AB, \&BB, \textcolor{stringliteral}{"native"} );}
\DoxyCodeLine{76 }
\DoxyCodeLine{77   \textcolor{keywordflow}{try}}
\DoxyCodeLine{78   \{}
\DoxyCodeLine{79     banded\_system.solve();}
\DoxyCodeLine{80   \}}
\DoxyCodeLine{81   \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} std::runtime\_error \&error )}
\DoxyCodeLine{82   \{}
\DoxyCodeLine{83     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{84     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{85   \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87   BB.sub( BD );}
\DoxyCodeLine{88   \textcolor{keywordflow}{if} ( std::abs( BB.two\_norm() ) > tol )}
\DoxyCodeLine{89   \{}
\DoxyCodeLine{90     failed = \textcolor{keyword}{true};}
\DoxyCodeLine{91     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m * Banded solver does not give same result as dense solver \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{92   \}}
\DoxyCodeLine{93   \textcolor{keywordflow}{else}}
\DoxyCodeLine{94   \{}
\DoxyCodeLine{95     cout << \textcolor{stringliteral}{"     Banded solver agrees with the dense solver.\(\backslash\)n"};}
\DoxyCodeLine{96   \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 }
\DoxyCodeLine{99   \textcolor{comment}{//}}
\DoxyCodeLine{100   \textcolor{comment}{// CONCLUDING PASS/FAIL}}
\DoxyCodeLine{101   \textcolor{comment}{//}}
\DoxyCodeLine{102   \textcolor{keywordflow}{if} ( failed )}
\DoxyCodeLine{103   \{}
\DoxyCodeLine{104     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{105     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{106   \}}
\DoxyCodeLine{107   \textcolor{keywordflow}{else}}
\DoxyCodeLine{108   \{}
\DoxyCodeLine{109     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{110     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{111   \}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+Example\+::failed, Utils\+\_\+\+Fill\+::fill\+\_\+band(), Cpp\+Noddy\+::\+Banded\+Matrix$<$ \+\_\+\+Type $>$\+::noffdiag(), Cpp\+Noddy\+::\+Banded\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve(), Cpp\+Noddy\+::\+Dense\+Linear\+System$<$ \+\_\+\+Type $>$\+::solve(), Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::sub(), and Cpp\+Noddy\+::\+Dense\+Vector$<$ \+\_\+\+Type $>$\+::two\+\_\+norm().

