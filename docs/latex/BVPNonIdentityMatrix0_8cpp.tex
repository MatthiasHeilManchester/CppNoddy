\doxysubsection{Tests/\+B\+V\+P/\+B\+V\+P\+Non\+Identity\+Matrix0.cpp File Reference}
\label{BVPNonIdentityMatrix0_8cpp}\index{Tests/BVP/BVPNonIdentityMatrix0.cpp@{Tests/BVP/BVPNonIdentityMatrix0.cpp}}
{\ttfamily \#include $<$B\+V\+P\+\_\+bundle.\+h$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Nonidentity\+\_\+equation$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$}
\begin{DoxyCompactList}\small\item\em Define the harmonic equation by inheriting the \doxyref{Equation}{p.}{classCppNoddy_1_1Equation} base class. \end{DoxyCompactList}\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Nonidentity\+\_\+left\+\_\+\+B\+C$<$ \+\_\+\+Type $>$}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::\+Nonidentity\+\_\+right\+\_\+\+B\+C$<$ \+\_\+\+Type $>$}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ f}, 
\textbf{ fd}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solving the equation \[ f(y) f\textnormal{\textquotesingle}\textnormal{\textquotesingle}(y) + f\textnormal{\textquotesingle}(y)^2 = 1+\gamma y \] subject to $ f(0) = 1 $ and $ f(1) = 2 $. We don\textquotesingle{}t divide by the $ f(y) $ that multiplies the highest derivative, rather we define a non-\/identity matrix0. The solution is compared at all nodes to the exact solution \[ f(y)=\left ( y^2 + \frac{\gamma}{3}y^3 + (2-\frac{\gamma}{3}) y + 1 \right )^{1/2}\,.\] 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{BVPNonIdentityMatrix0_8cpp_abed82baf7f470b522273a3e37c24c600}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{f@{f}!BVPNonIdentityMatrix0.cpp@{BVPNonIdentityMatrix0.cpp}}\index{BVPNonIdentityMatrix0.cpp@{BVPNonIdentityMatrix0.cpp}!f@{f}}}\mbox{\label{BVPNonIdentityMatrix0_8cpp_abed82baf7f470b522273a3e37c24c600a7ce756344023b99e5ab27b804feb765c}} 
f&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{fd@{fd}!BVPNonIdentityMatrix0.cpp@{BVPNonIdentityMatrix0.cpp}}\index{BVPNonIdentityMatrix0.cpp@{BVPNonIdentityMatrix0.cpp}!fd@{fd}}}\mbox{\label{BVPNonIdentityMatrix0_8cpp_abed82baf7f470b522273a3e37c24c600a1e4d60e5b05464d07a30096747025a42}} 
fd&\\
\hline

\end{DoxyEnumFields}


Definition at line 15 of file B\+V\+P\+Non\+Identity\+Matrix0.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{15 \{f, fd \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{BVPNonIdentityMatrix0_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{BVPNonIdentityMatrix0.cpp@{BVPNonIdentityMatrix0.cpp}!main@{main}}
\index{main@{main}!BVPNonIdentityMatrix0.cpp@{BVPNonIdentityMatrix0.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 80 of file B\+V\+P\+Non\+Identity\+Matrix0.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{81 \{}
\DoxyCodeLine{82   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{83   cout << \textcolor{stringliteral}{"=== BVP: finite-\/difference, non-\/identity matrix0 ====\(\backslash\)n"};}
\DoxyCodeLine{84   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{85 }
\DoxyCodeLine{86   Example::Nonidentity\_equation<double, double> problem;}
\DoxyCodeLine{87   Example::Nonidentity\_left\_BC <double> BC\_left;}
\DoxyCodeLine{88   Example::Nonidentity\_right\_BC<double> BC\_right;}
\DoxyCodeLine{89 }
\DoxyCodeLine{90   \textcolor{keywordtype}{double} left =  0.0;}
\DoxyCodeLine{91   \textcolor{keywordtype}{double} right = 1.0;}
\DoxyCodeLine{92   \textcolor{comment}{// number of nodal points}}
\DoxyCodeLine{93   \textcolor{keywordtype}{unsigned} N = 151;}
\DoxyCodeLine{94   \textcolor{comment}{// a real mesh -\/-\/ along real axis}}
\DoxyCodeLine{95   DenseVector<double> nodes( Utility::uniform\_node\_vector( left, right, N ) );}
\DoxyCodeLine{96   \textcolor{comment}{// Example tolerance}}
\DoxyCodeLine{97   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol = 1.e-\/4;}
\DoxyCodeLine{98 }
\DoxyCodeLine{99   \textcolor{comment}{// a real ODE BVP}}
\DoxyCodeLine{100   problem.gamma = 5.0;}
\DoxyCodeLine{101   ODE\_BVP<double> ode( \&problem, nodes, \&BC\_left, \&BC\_right );}
\DoxyCodeLine{102 }
\DoxyCodeLine{103   \textcolor{comment}{// our initial guess}}
\DoxyCodeLine{104   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < N; ++i )}
\DoxyCodeLine{105   \{}
\DoxyCodeLine{106     \textcolor{keywordtype}{double} y = ode.solution().coord( i );}
\DoxyCodeLine{107     \textcolor{comment}{// set f(y)}}
\DoxyCodeLine{108     ode.solution()( i, f ) = 1+y;}
\DoxyCodeLine{109     \textcolor{comment}{// set f'(y)}}
\DoxyCodeLine{110     ode.solution()( i, fd ) = 1;}
\DoxyCodeLine{111   \}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113   \textcolor{comment}{// solve the problem using 2nd order finite-\/difference}}
\DoxyCodeLine{114   \textcolor{keywordflow}{try}}
\DoxyCodeLine{115   \{}
\DoxyCodeLine{116     ode.solve2();}
\DoxyCodeLine{117   \}}
\DoxyCodeLine{118   \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::runtime\_error\& error )}
\DoxyCodeLine{119   \{}
\DoxyCodeLine{120     cout << \textcolor{stringliteral}{" \(\backslash\)033[1;31;48m  * FAILED THROUGH EXCEPTION BEING RAISED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{121     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{122   \}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 }
\DoxyCodeLine{125   \textcolor{comment}{// find deviation from exact solution}}
\DoxyCodeLine{126   \textcolor{keywordtype}{double} diff = 0;}
\DoxyCodeLine{127   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < N; ++i )}
\DoxyCodeLine{128   \{}
\DoxyCodeLine{129     \textcolor{keyword}{const} \textcolor{keywordtype}{double} y( ode.solution().coord(i) );}
\DoxyCodeLine{130     \textcolor{keyword}{const} \textcolor{keywordtype}{double} exact( sqrt(y*y + problem.gamma*y*y*y/3 + (2-\/problem.gamma/3)*y + 1) );}
\DoxyCodeLine{131     diff = std::max( std::abs( ode.solution().get\_interpolated\_vars(y)[f] -\/ exact ), diff );}
\DoxyCodeLine{132   \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134   \textcolor{comment}{// validation test}}
\DoxyCodeLine{135   \textcolor{keywordflow}{if} ( diff > tol )}
\DoxyCodeLine{136   \{}
\DoxyCodeLine{137     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{138     cout << \textcolor{stringliteral}{"Real problem error "} << diff << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{139     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{140   \}}
\DoxyCodeLine{141   \textcolor{keywordflow}{else}}
\DoxyCodeLine{142   \{}
\DoxyCodeLine{143     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{144     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{145   \}}
\DoxyCodeLine{146 \}}

\end{DoxyCode}


References f, fd, Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::solution(), Cpp\+Noddy\+::\+O\+D\+E\+\_\+\+B\+V\+P$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::solve2(), and Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector().

