\doxysubsection{Tests/double\+\_\+\+I\+B\+V\+P/\+I\+B\+V\+P\+Linear.cpp File Reference}
\label{IBVPLinear_8cpp}\index{Tests/double\_IBVP/IBVPLinear.cpp@{Tests/double\_IBVP/IBVPLinear.cpp}}
{\ttfamily \#include $<$I\+B\+V\+P\+\_\+double\+\_\+bundle.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../\+Utils\+\_\+\+Fill.\+h\char`\"{}}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::diffusion\+\_\+double}
\item 
class \textbf{ Cpp\+Noddy\+::\+Example\+::dd\+\_\+\+BC}
\end{DoxyCompactItemize}
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \textbf{ Cpp\+Noddy}
\begin{DoxyCompactList}\small\item\em A collection of OO numerical routines aimed at simple (typical) applied problems in continuum mechanics. \end{DoxyCompactList}\item 
 \textbf{ Cpp\+Noddy\+::\+Example}
\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \textbf{ U}, 
\textbf{ Ud}
 \}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \textbf{ Cpp\+Noddy\+::\+Example\+::source} (const double \&x, const double \&y, const double \&t)
\item 
int \textbf{ main} ()
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Solving the linear equation \[ - u_x - u_t + u_{yy} = ( ( 1 - y^2 )( x + t ) - 2 ) e^{-xt}\,, \] subject to $ u(x=0,y,t) = 1-y^2 $ $ u(x,t=0,y) = 1 - y^2 $ and $ f(x, y = \pm 1,t ) = 0 $. The solution is computed over a range of $ t $ for $ (x,y) \in [0,10]\times [-1,1] $ and the maximum deviation away from the exact solution $ u = (1-y^2) e^{-xt} $ is found. The test fails if this deviation is larger than a set tolerance $ \tau $. The example is solved using the P\+D\+E\+\_\+double\+\_\+\+I\+B\+VP for problems that are parabolic in 2 coordinates $ (x,t) $ with a B\+VP in $ y $. 

\doxysubsubsection{Enumeration Type Documentation}
\mbox{\label{IBVPLinear_8cpp_a385c44f6fb256e5716a2302a5b940388}} 
\doxyparagraph{anonymous enum}
{\footnotesize\ttfamily anonymous enum}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{U@{U}!IBVPLinear.cpp@{IBVPLinear.cpp}}\index{IBVPLinear.cpp@{IBVPLinear.cpp}!U@{U}}}\mbox{\label{IBVPLinear_8cpp_a385c44f6fb256e5716a2302a5b940388ac461e84f27bbb236874e1011cd66031f}} 
U&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{Ud@{Ud}!IBVPLinear.cpp@{IBVPLinear.cpp}}\index{IBVPLinear.cpp@{IBVPLinear.cpp}!Ud@{Ud}}}\mbox{\label{IBVPLinear_8cpp_a385c44f6fb256e5716a2302a5b940388ae3fe7b6f745ea6be7e92f8c854abfb4f}} 
Ud&\\
\hline

\end{DoxyEnumFields}


Definition at line 18 of file I\+B\+V\+P\+Linear.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{18 \{ U, Ud \};}

\end{DoxyCode}


\doxysubsubsection{Function Documentation}
\mbox{\label{IBVPLinear_8cpp_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{IBVPLinear.cpp@{IBVPLinear.cpp}!main@{main}}
\index{main@{main}!IBVPLinear.cpp@{IBVPLinear.cpp}}
\doxyparagraph{main()}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 104 of file I\+B\+V\+P\+Linear.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{105 \{}
\DoxyCodeLine{106   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{107   cout << \textcolor{stringliteral}{"=== double\_IBVP: linear diffusive problem ===========\(\backslash\)n"};}
\DoxyCodeLine{108   cout << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{109 }
\DoxyCodeLine{110   \textcolor{comment}{// instantiate the problem}}
\DoxyCodeLine{111   Example::diffusion\_double problem;}
\DoxyCodeLine{112   Example::dd\_BC BC\_bottom;}
\DoxyCodeLine{113   Example::dd\_BC BC\_top;}
\DoxyCodeLine{114 }
\DoxyCodeLine{115   \textcolor{comment}{// domain definition}}
\DoxyCodeLine{116   \textcolor{keywordtype}{double} top = 1.0;}
\DoxyCodeLine{117   \textcolor{keywordtype}{double} bottom = -\/1.0;}
\DoxyCodeLine{118   \textcolor{keywordtype}{double} left = 0.0;}
\DoxyCodeLine{119   \textcolor{keywordtype}{double} right = 10.0;}
\DoxyCodeLine{120   \textcolor{comment}{// number of (spatial) nodal points}}
\DoxyCodeLine{121   \textcolor{keywordtype}{unsigned} ny = 301;}
\DoxyCodeLine{122   \textcolor{keywordtype}{unsigned} nx = 301;}
\DoxyCodeLine{123   \textcolor{comment}{// time and time step}}
\DoxyCodeLine{124   \textcolor{keywordtype}{double} t\_end = 1.0;}
\DoxyCodeLine{125   \textcolor{keywordtype}{double} dt = 0.01;}
\DoxyCodeLine{126 }
\DoxyCodeLine{127   \textcolor{comment}{// construct our IBVP}}
\DoxyCodeLine{128   PDE\_double\_IBVP<double> diffusion( \&problem,}
\DoxyCodeLine{129                                      Utility::uniform\_node\_vector( left, right, nx ),}
\DoxyCodeLine{130                                      Utility::uniform\_node\_vector( bottom, top, ny ),}
\DoxyCodeLine{131                                      \&BC\_bottom, \&BC\_top );}
\DoxyCodeLine{132 }
\DoxyCodeLine{133   \textcolor{comment}{// initial conditions}}
\DoxyCodeLine{134   \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < nx; ++i )}
\DoxyCodeLine{135   \{}
\DoxyCodeLine{136     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} j = 0; j < ny; ++j )}
\DoxyCodeLine{137     \{}
\DoxyCodeLine{138       \textcolor{keywordtype}{double} y = diffusion.solution().coord( i, j ).second;}
\DoxyCodeLine{139       diffusion.solution()( i, j, U ) = ( 1.0 -\/ y * y );}
\DoxyCodeLine{140       diffusion.solution()( i, j, Ud ) = -\/ 2 * y ;}
\DoxyCodeLine{141     \}}
\DoxyCodeLine{142   \}}
\DoxyCodeLine{143 }
\DoxyCodeLine{144   \textcolor{keywordtype}{double} max\_error( 0.0 );}
\DoxyCodeLine{145   \textcolor{keywordflow}{do}}
\DoxyCodeLine{146   \{}
\DoxyCodeLine{147     diffusion.update\_previous\_solution();}
\DoxyCodeLine{148     diffusion.step2( dt );}
\DoxyCodeLine{149     \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} i = 0; i < nx; ++i )}
\DoxyCodeLine{150     \{}
\DoxyCodeLine{151       \textcolor{keywordflow}{for} ( \textcolor{keywordtype}{unsigned} j = 0; j < ny; ++j )}
\DoxyCodeLine{152       \{}
\DoxyCodeLine{153         \textcolor{keywordtype}{double} x = diffusion.solution().coord( i, j ).first;}
\DoxyCodeLine{154         \textcolor{keywordtype}{double} y = diffusion.solution().coord( i, j ).second;}
\DoxyCodeLine{155         \textcolor{keywordtype}{double} exact\_u = ( 1 -\/ y * y ) * exp( -\/ x * diffusion.t() );}
\DoxyCodeLine{156         max\_error = max( max\_error, abs( exact\_u -\/ diffusion.solution()( i, j, U ) ) );}
\DoxyCodeLine{157       \}}
\DoxyCodeLine{158     \}}
\DoxyCodeLine{159   \}}
\DoxyCodeLine{160   \textcolor{keywordflow}{while} ( diffusion.t() < t\_end );}
\DoxyCodeLine{161 }
\DoxyCodeLine{162   \textcolor{keyword}{const} \textcolor{keywordtype}{double} tol( 1.e-\/4 );}
\DoxyCodeLine{163   \textcolor{comment}{// check the BL transpiration vs the known solution}}
\DoxyCodeLine{164   \textcolor{keywordflow}{if} ( max\_error > tol )}
\DoxyCodeLine{165   \{}
\DoxyCodeLine{166     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;31;48m  * FAILED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{167     cout << \textcolor{stringliteral}{" Difference = "} << max\_error << \textcolor{stringliteral}{"\(\backslash\)n"};}
\DoxyCodeLine{168     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{169   \}}
\DoxyCodeLine{170   \textcolor{keywordflow}{else}}
\DoxyCodeLine{171   \{}
\DoxyCodeLine{172     cout << \textcolor{stringliteral}{"\(\backslash\)033[1;32;48m  * PASSED \(\backslash\)033[0m\(\backslash\)n"};}
\DoxyCodeLine{173     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{174   \}}
\DoxyCodeLine{175 }
\DoxyCodeLine{176 \}}

\end{DoxyCode}


References Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::solution(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::step2(), Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::t(), U, Ud, Cpp\+Noddy\+::\+Utility\+::uniform\+\_\+node\+\_\+vector(), and Cpp\+Noddy\+::\+P\+D\+E\+\_\+double\+\_\+\+I\+B\+V\+P$<$ \+\_\+\+Type $>$\+::update\+\_\+previous\+\_\+solution().

