\doxysubsection{Cpp\+Noddy\+::Equation\+\_\+3matrix$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$ Class Template Reference}
\label{classCppNoddy_1_1Equation__3matrix}\index{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}}


An equation object base class used in the \doxyref{P\+D\+E\+\_\+double\+\_\+\+I\+B\+VP}{p.}{classCppNoddy_1_1PDE__double__IBVP} class.  




{\ttfamily \#include $<$Equation\+\_\+3matrix.\+h$>$}

Inheritance diagram for Cpp\+Noddy\+::Equation\+\_\+3matrix$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=5.000000cm]{classCppNoddy_1_1Equation__3matrix}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\textbf{ Equation\+\_\+3matrix} (const unsigned \&order)
\begin{DoxyCompactList}\small\item\em Constructor for equation class. \end{DoxyCompactList}\item 
virtual \textbf{ $\sim$\+Equation\+\_\+3matrix} ()
\begin{DoxyCompactList}\small\item\em An empty destructor, virtual since we have virtual methods. \end{DoxyCompactList}\item 
void \textbf{ update} (const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&state)
\begin{DoxyCompactList}\small\item\em Update the \doxyref{Equation}{p.}{classCppNoddy_1_1Equation} object for the current set of state variables. \end{DoxyCompactList}\item 
const \textbf{ Dense\+Matrix}$<$ \+\_\+\+Type $>$ \& \textbf{ matrix2} () const
\begin{DoxyCompactList}\small\item\em Return a handle to the matrix member data. \end{DoxyCompactList}\item 
virtual void \textbf{ get\+\_\+jacobian\+\_\+of\+\_\+matrix2\+\_\+mult\+\_\+vector} (const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&state, const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&vec, \textbf{ Dense\+Matrix}$<$ \+\_\+\+Type $>$ \&\textbf{ h}) const
\begin{DoxyCompactList}\small\item\em Return the product of the Jacobian-\/of-\/the-\/matrix and a vector \textquotesingle{}vec\textquotesingle{} when the equation has a given \textquotesingle{}state\textquotesingle{}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \textbf{ matrix2} (const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&state, \textbf{ Dense\+Matrix}$<$ \+\_\+\+Type $>$ \&\textbf{ m}) const
\begin{DoxyCompactList}\small\item\em Define the matrix for the current state vector. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}


\doxysubsubsection{Detailed Description}
\subsubsection*{template$<$typename \+\_\+\+Type, typename \+\_\+\+Xtype = double$>$\newline
class Cpp\+Noddy\+::\+Equation\+\_\+3matrix$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$}

An equation object base class used in the \doxyref{P\+D\+E\+\_\+double\+\_\+\+I\+B\+VP}{p.}{classCppNoddy_1_1PDE__double__IBVP} class. 

An equation object is essentially a (\textquotesingle{}square\textquotesingle{}) residual object (although it doesn\textquotesingle{}t currently inherit) with some independent variable data members and access methods. By \textquotesingle{}square\textquotesingle{} we mean that it defines N residuals and N state variables. In this case the equation also defines 2 matrices (amongst other data). This inherits from the \doxyref{Equation\+\_\+1matrix}{p.}{classCppNoddy_1_1Equation__1matrix} and adds the functionality for the additional matrix. 

Definition at line 21 of file Equation\+\_\+3matrix.\+h.



\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\label{classCppNoddy_1_1Equation__3matrix_ab2b6d9cee8c02e48e6d65872fe095dce}} 
\index{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}!Equation\_3matrix@{Equation\_3matrix}}
\index{Equation\_3matrix@{Equation\_3matrix}!CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}}
\doxyparagraph{Equation\_3matrix()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type , typename \+\_\+\+Xtype $>$ \\
\textbf{ Cpp\+Noddy\+::\+Equation\+\_\+3matrix}$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::\textbf{ Equation\+\_\+3matrix} (\begin{DoxyParamCaption}\item[{const unsigned \&}]{order }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [explicit]}}



Constructor for equation class. 


\begin{DoxyParams}{Parameters}
{\em order} & The order of the system \\
\hline
\end{DoxyParams}


Definition at line 12 of file Equation\+\_\+3matrix.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{12                                                                           :}
\DoxyCodeLine{13     Equation\_2matrix<\_Type, \_Xtype>(order) \{}
\DoxyCodeLine{14     \textcolor{comment}{// initialise the container for the extra matrix}}
\DoxyCodeLine{15     MATRIX2\_AT\_LAST\_STATE = DenseMatrix<\_Type>(order, order, 0.0);}
\DoxyCodeLine{16     \textcolor{comment}{// add an extra coordinate to the vector stored in the residual\_with\_coords baseclass}}
\DoxyCodeLine{17     Residual\_with\_coords<\_Type,\_Xtype>::coords.resize(3, 0.0);}
\DoxyCodeLine{18   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1Equation__3matrix_a27750cd84cc7484d98b9062063515d53}} 
\index{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}!````~Equation\_3matrix@{$\sim$Equation\_3matrix}}
\index{````~Equation\_3matrix@{$\sim$Equation\_3matrix}!CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}}
\doxyparagraph{$\sim$Equation\_3matrix()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type , typename \+\_\+\+Xtype $>$ \\
\textbf{ Cpp\+Noddy\+::\+Equation\+\_\+3matrix}$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::$\sim$\textbf{ Equation\+\_\+3matrix}\hspace{0.3cm}{\ttfamily [virtual]}}



An empty destructor, virtual since we have virtual methods. 



Definition at line 21 of file Equation\+\_\+3matrix.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{21                                                       \{}
\DoxyCodeLine{22     \textcolor{comment}{// timer reporting is done via the Equation (base) class}}
\DoxyCodeLine{23   \}}

\end{DoxyCode}


\doxysubsubsection{Member Function Documentation}
\mbox{\label{classCppNoddy_1_1Equation__3matrix_af5f3eddaa1cbdb8901d6abf313fa2ceb}} 
\index{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}!get\_jacobian\_of\_matrix2\_mult\_vector@{get\_jacobian\_of\_matrix2\_mult\_vector}}
\index{get\_jacobian\_of\_matrix2\_mult\_vector@{get\_jacobian\_of\_matrix2\_mult\_vector}!CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}}
\doxyparagraph{get\_jacobian\_of\_matrix2\_mult\_vector()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type , typename \+\_\+\+Xtype $>$ \\
void \textbf{ Cpp\+Noddy\+::\+Equation\+\_\+3matrix}$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::get\+\_\+jacobian\+\_\+of\+\_\+matrix2\+\_\+mult\+\_\+vector (\begin{DoxyParamCaption}\item[{const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&}]{state,  }\item[{const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&}]{vec,  }\item[{\textbf{ Dense\+Matrix}$<$ \+\_\+\+Type $>$ \&}]{h }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Return the product of the Jacobian-\/of-\/the-\/matrix and a vector \textquotesingle{}vec\textquotesingle{} when the equation has a given \textquotesingle{}state\textquotesingle{}. 

The user should overload this if concerned about performance of the solver. If not overloaded, the default is to finite difference the Jacobian-\/of-\/the-\/matrix. 
\begin{DoxyParams}{Parameters}
{\em state} & The current state variables -- used for clarity when overloaded by the user instead of expecting the user to access the member data. \\
\hline
{\em vec} & The vector that will be multiplied by the Jacobian-\/of-\/the-\/matrix \\
\hline
{\em h} & The resulting 2D matrix \\
\hline
\end{DoxyParams}


Reimplemented in \textbf{ Cpp\+Noddy\+::\+Example\+::nonlinear} \doxyref{}{p.}{classCppNoddy_1_1Example_1_1nonlinear_a45a9e533677ac9f34ddc4d5c2afa3277}, and \textbf{ Cpp\+Noddy\+::\+Example\+::diffusion\+\_\+double} \doxyref{}{p.}{classCppNoddy_1_1Example_1_1diffusion__double_a03dfcd13480734fed9bc5c11129233a9}.



Definition at line 42 of file Equation\+\_\+3matrix.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{42                                                                                                                                                                        \{}
\DoxyCodeLine{43     \textcolor{comment}{// we dont need state in the default implementation as its already been set by the update method. You do need it for the user}}
\DoxyCodeLine{44     \textcolor{comment}{// to overload this method with an explicit analytical version however.}}
\DoxyCodeLine{45     \textcolor{comment}{//}}
\DoxyCodeLine{46     \textcolor{comment}{// copy some items for FD computation of Jacobian of mass matrix}}
\DoxyCodeLine{47     DenseVector<\_Type> copy\_of\_state(\textcolor{keyword}{this} -\/> LAST\_STATE);}
\DoxyCodeLine{48     DenseMatrix<\_Type> copy\_of\_matrix(MATRIX2\_AT\_LAST\_STATE);}
\DoxyCodeLine{49     std::vector< DenseMatrix<\_Type> > jacmatrix;}
\DoxyCodeLine{50     \textcolor{comment}{// update the Jacobian of the mass matrix}}
\DoxyCodeLine{51     \textcolor{keywordflow}{for}(std::size\_t i = 0; i < \textcolor{keyword}{this} -\/> ORDER\_OF\_SYSTEM; ++i) \{}
\DoxyCodeLine{52       copy\_of\_state[ i ] += \textcolor{keyword}{this} -\/> DELTA;}
\DoxyCodeLine{53       matrix2(copy\_of\_state, copy\_of\_matrix);}
\DoxyCodeLine{54       copy\_of\_state[ i ] -\/= \textcolor{keyword}{this} -\/> DELTA;}
\DoxyCodeLine{55       copy\_of\_matrix.sub(MATRIX2\_AT\_LAST\_STATE);}
\DoxyCodeLine{56       copy\_of\_matrix.scale(1. / \textcolor{keyword}{this} -\/> DELTA);}
\DoxyCodeLine{57       \textcolor{comment}{// the 3D object that represents the Jacobian of the mass matrix}}
\DoxyCodeLine{58       jacmatrix.push\_back(copy\_of\_matrix);}
\DoxyCodeLine{59     \}}
\DoxyCodeLine{60     \textcolor{comment}{// evaluate the jacabian of mass contribution}}
\DoxyCodeLine{61     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i = 0; i < \textcolor{keyword}{this} -\/> ORDER\_OF\_SYSTEM; ++i) \{}
\DoxyCodeLine{62       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} j = 0; j < \textcolor{keyword}{this} -\/> ORDER\_OF\_SYSTEM; ++j) \{}
\DoxyCodeLine{63         h(i, j) = Utility::dot(jacmatrix[ j ][ i ], vec);}
\DoxyCodeLine{64       \}}
\DoxyCodeLine{65     \}}
\DoxyCodeLine{66   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1Equation__3matrix_a177c087b61d6468ccd0088bc904618e8}} 
\index{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}!matrix2@{matrix2}}
\index{matrix2@{matrix2}!CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}}
\doxyparagraph{matrix2()\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type , typename \+\_\+\+Xtype $>$ \\
const \textbf{ Dense\+Matrix}$<$ \+\_\+\+Type $>$ \& \textbf{ Cpp\+Noddy\+::\+Equation\+\_\+3matrix}$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::matrix2\hspace{0.3cm}{\ttfamily [inline]}}



Return a handle to the matrix member data. 



Definition at line 69 of file Equation\+\_\+3matrix.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{69                                                                                   \{}
\DoxyCodeLine{70     \textcolor{keywordflow}{return} MATRIX2\_AT\_LAST\_STATE;}
\DoxyCodeLine{71   \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1Equation__3matrix_a4bba4557bf702e028c4bd7deb09df688}} 
\index{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}!matrix2@{matrix2}}
\index{matrix2@{matrix2}!CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}}
\doxyparagraph{matrix2()\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type , typename \+\_\+\+Xtype  = double$>$ \\
virtual void \textbf{ Cpp\+Noddy\+::\+Equation\+\_\+3matrix}$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::matrix2 (\begin{DoxyParamCaption}\item[{const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&}]{state,  }\item[{\textbf{ Dense\+Matrix}$<$ \+\_\+\+Type $>$ \&}]{m }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Define the matrix for the current state vector. 


\begin{DoxyParams}{Parameters}
{\em state} & The current state vector. \\
\hline
{\em m} & The matrix. \\
\hline
\end{DoxyParams}


Reimplemented in \textbf{ Cpp\+Noddy\+::\+Example\+::diffusion\+\_\+double} \doxyref{}{p.}{classCppNoddy_1_1Example_1_1diffusion__double_a8e96bb00b79fd0424dac3605f8acfe9d}, \textbf{ Cpp\+Noddy\+::\+Example\+::nonlinear} \doxyref{}{p.}{classCppNoddy_1_1Example_1_1nonlinear_a1f72f687507ed39733591fcd5ab094b2}, and \textbf{ Cpp\+Noddy\+::\+Example\+::nonlinear} \doxyref{}{p.}{classCppNoddy_1_1Example_1_1nonlinear_a1f72f687507ed39733591fcd5ab094b2}.



Definition at line 53 of file Equation\+\_\+3matrix.\+h.


\begin{DoxyCode}{0}
\DoxyCodeLine{53                                                                                        \{}
\DoxyCodeLine{54       std::string problem;}
\DoxyCodeLine{55       problem = \textcolor{stringliteral}{"The equation::matrix1 method has not been implemented.\(\backslash\)n"};}
\DoxyCodeLine{56       problem += \textcolor{stringliteral}{"You have to implement this method to define the equation.\(\backslash\)n"};}
\DoxyCodeLine{57       \textcolor{keywordflow}{throw} ExceptionRuntime(problem);}
\DoxyCodeLine{58     \}}

\end{DoxyCode}
\mbox{\label{classCppNoddy_1_1Equation__3matrix_aa220c018bd06c4570caff90765919003}} 
\index{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}!update@{update}}
\index{update@{update}!CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$@{CppNoddy::Equation\_3matrix$<$ \_Type, \_Xtype $>$}}
\doxyparagraph{update()}
{\footnotesize\ttfamily template$<$typename \+\_\+\+Type , typename \+\_\+\+Xtype $>$ \\
void \textbf{ Cpp\+Noddy\+::\+Equation\+\_\+3matrix}$<$ \+\_\+\+Type, \+\_\+\+Xtype $>$\+::update (\begin{DoxyParamCaption}\item[{const \textbf{ Dense\+Vector}$<$ \+\_\+\+Type $>$ \&}]{state }\end{DoxyParamCaption})}



Update the \doxyref{Equation}{p.}{classCppNoddy_1_1Equation} object for the current set of state variables. 


\begin{DoxyParams}{Parameters}
{\em state} & The state vector at which to set the equation object \\
\hline
\end{DoxyParams}


Definition at line 26 of file Equation\+\_\+3matrix.\+cpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{26                                                                                \{}
\DoxyCodeLine{27     \textcolor{comment}{// call the base class's update method}}
\DoxyCodeLine{28     Equation\_2matrix<\_Type, \_Xtype>::update(state);}
\DoxyCodeLine{29     \textcolor{comment}{// this has to go after the base class update -\/ otherwise we'll be}}
\DoxyCodeLine{30     \textcolor{comment}{// resuming the timer twice in a row}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{32     \textcolor{keyword}{this} -\/> T\_UPDATER.start();}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{34     \textcolor{comment}{// now deal with the additional matrix separately}}
\DoxyCodeLine{35     matrix2(state, MATRIX2\_AT\_LAST\_STATE);}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#ifdef TIME}}
\DoxyCodeLine{37     \textcolor{keyword}{this} -\/> T\_UPDATER.stop();}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{39   \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/\textbf{ Equation\+\_\+3matrix.\+h}\item 
src/\textbf{ Equation\+\_\+3matrix.\+cpp}\end{DoxyCompactItemize}
